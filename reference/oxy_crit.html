<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate critical oxygen values, such as PCrit — oxy_crit • respR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate critical oxygen values, such as PCrit — oxy_crit"><meta property="og:description" content="Identifies critical oxygen values, the oxygen tension or concentration below
which an uptake rate transitions from independent to dependent on the oxygen
supply, typically known as PCrit."><meta property="og:image" content="https://januarharianto.github.io/respR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR in Use</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul></li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate critical oxygen values, such as PCrit</h1>
    <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/R/oxy_crit.R" class="external-link"><code>R/oxy_crit.R</code></a></small>
    <div class="hidden name"><code>oxy_crit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identifies critical oxygen values, the oxygen tension or concentration below
which an uptake rate transitions from independent to dependent on the oxygen
supply, typically known as <em>PCrit</em>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">oxy_crit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"bsr"</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oxygen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>object of class <code>inspect</code> or a <code>data.frame</code> containing either paired
oxygen~time values, or paired rate~oxygen values. See Details.</p></dd>


<dt>method</dt>
<dd><p>string. Defaults to <code>"bsr"</code>. Critical oxygen value analysis
method. Either <code>"bsr"</code> or <code>"segmented"</code>. See Details.</p></dd>


<dt>time</dt>
<dd><p>integer or string. Defaults to 1. Specifies column number or
column name of the time data.</p></dd>


<dt>oxygen</dt>
<dd><p>integer or string. Defaults to 2. Specifies column number or
column name of the oxygen data.</p></dd>


<dt>rate</dt>
<dd><p>integer or string. Defaults to NULL. Specifies column number or
column name of the rate data.</p></dd>


<dt>width</dt>
<dd><p>numeric value between 0 and 1 representing proportion of the
total data length. Determines the width of the rolling regression used to
determine the rolling rate and the rolling mean of oxygen values the rate
is paired with. Defaults to 0.1, representing 10% of total rows.</p></dd>


<dt>parallel</dt>
<dd><p>logical. Defaults to FALSE. Enables parallel processing for
computationally intensive analyses of large datasets.</p></dd>


<dt>thin</dt>
<dd><p>integer. Defaults to 5000. Number of rows to subsample <code>x</code> data
to before running <code>"bsr"</code> analysis. No effect on datasets smaller than this
value or with <code>"segmented"</code> method. To perform no subsampling enter as
<code>NULL</code>. See Details.</p></dd>


<dt>plot</dt>
<dd><p>logical. Defaults to TRUE.</p></dd>


<dt>...</dt>
<dd><p>Allows additional plotting controls to be passed, such as <code>legend = FALSE</code>, <code>quiet = TRUE</code>, <code>rate.rev = FALSE</code>, and <code>panel</code>. See Plotting
section.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Output is a <code>list</code> object of class <code>oxy_crit</code> containing input
parameters and data, various summary data, metadata, and the primary output
of interest <code>$crit</code>, which is the critical oxygen value in the units of the
oxygen data as entered. This can be converted to additional units using
<code><a href="convert_DO.html">convert_DO()</a></code>. Note, if the Broken-Stick analysis (<code>method == "bsr"</code>)
has been used, <code>$crit</code> will contain two results; <code>$crit.intercept</code> and
<code>$crit.midpoint</code>. For full explanation of the difference between these see
Yeager &amp; Ultsch (1989), however they are generally very close in value.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>In earlier versions of <code>respR</code>, this function was known as <code>pcrit</code> or
<code>calc_pcrit</code>. It was renamed to avoid conflicts with functions of the same
name in another package, and also because technically the <em>P</em> in  <em>PCrit</em>
stands for the partial <em>pressure</em> of oxygen. Since the function returns the
value in the units of the data as entered, whether they are concentration or
pressure units, this terminology can be technically in error. Instead, for
the purposes of the documentation we refer to this as the <em>Critical Oxygen
Value</em>, or "<em>COV</em>". If the units of oxygen are partial pressure units (e.g.
kPa), this is equivalent to PCrit, otherwise they should be reported with
this in mind.</p><div class="section">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h3>


<p>The <code>oxy_crit()</code> function provides two methods (one of which outputs two
results) to calculate the <em>COV</em>. These are selected using the <code>method</code> input.</p><div class="section">
<h4 id="broken-stick-regression-method-bsr-">Broken Stick Regression:    <code>method = "bsr"</code><a class="anchor" aria-label="anchor" href="#broken-stick-regression-method-bsr-"></a></h4>


<p>This is the default method, adapted from the “Broken-Stick” regression
(<em>BSR</em>) approach, of Yeager &amp; Ultsch (1989), in which two segments of the
data are iteratively fitted and the intersection with the smallest sum of the
residual sum of squares between the two linear models is the estimated <em>COV</em>.
Two slightly different ways of reporting this breakpoint are detailed by
Yeager &amp; Ultsch (1989); the <em>intercept</em> and <em>midpoint</em>. These are usually
very close in value, and the function returns both.</p>
<p>The <code>thin</code> input influences the <em>BSR</em> analysis. The method is very
computationally intensive, so to speed up analyses the <code>thin</code> input will
subsample datasets longer than this input to this number or rows before
analysis. The default value of 5000 has in testing provided a good balance
between speed and results accuracy and repeatability. However, results may
vary with different datasets, so users should experiment with varying the
value. To perform no subsampling and use the entire dataset enter <code>thin = NULL</code>. It has no effect on datasets shorter than the <code>thin</code> input.</p>
</div>

<div class="section">
<h4 id="segmented-regression-method-segmented-">Segmented Regression:    <code>method = "segmented"</code><a class="anchor" aria-label="anchor" href="#segmented-regression-method-segmented-"></a></h4>


<p>The second method is a wrapper for the "Segmented" regression approach,
available as part of the <code>segmented</code> R package (Muggeo 2008), which estimates
the <em>COV</em> by iteratively fitting two intersecting models and selecting the
value that minimises the “gap” between the fitted lines.</p>
</div>


</div>

<div class="section">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a></h3>


<p>The data input <code>x</code> should be an <code>inspect</code> object or <code>data.frame</code> containing
oxygen~time data, or a <code>data.frame</code> containing rate~oxygen data.</p><div class="section">
<h4 id="oxygen-time-data">Oxygen ~ Time data<a class="anchor" aria-label="anchor" href="#oxygen-time-data"></a></h4>


<p>This is the typical input, where a timeseries of oxygen concentrations or
partial pressures against time has been recorded, generally down to a very
low value of oxygen. A column of <code>time</code> and a column of <code>oxygen</code> should be
specified. The function defaults to <code>time = 1</code> and <code>oxygen = 2</code> if no other
inputs are entered. These can also be specified using the column names.</p>
<p>If an <code>inspect</code> object is entered as the <code>x</code> input, the data frame is
extracted automatically and column identifiers are not required since these
were already entered in <code>inspect</code>. Note, if multiple <code>oxygen</code> columns were
entered in <code>inspect</code> only the first entered one will be used in <code>oxy_crit</code>.</p>
<p>To calculate the <em>COV</em>, the function requires data in the form of oxygen
uptake rate against oxygen value. Therefore, the function performs a rolling
regression on the oxygen~time data to determine rates, and pairs these
against a rolling mean of the oxygen data. The function then performs the
selected analysis <code>method</code> on these data. The width of the rolling regression
and rolling mean is determined by the <code>width</code> input. The default is 0.1,
representing 10% of the length of the data. This performs well in testing,
however performance may vary with data that has abrupt changes in rate, or is
particularly noisy. Users should experiment with different <code>width</code> values to
see how it affects results, and report this with their results and analysis
parameters.</p>
</div>

<div class="section">
<h4 id="rate-oxygen-data">Rate ~ Oxygen data<a class="anchor" aria-label="anchor" href="#rate-oxygen-data"></a></h4>


<p>Alternatively, if existing rolling oxygen uptake rates have been calculated,
and have appropriate paired oxygen concentration or partial pressure values,
these can be entered with the <code>rate</code> and <code>oxygen</code> inputs specifying the
respective columns as either numbers or the column names. In this case the
function performs the selected analysis <code>method</code> on these data directly
without any processing. The <code>width</code> input in this case is not relevant and is
ignored.</p>
<p>This option can only be used with data frame <code>x</code> inputs. Note, other columns
such as time data may be present in the input, but are not required so need
not be specified.</p>
</div>


</div>

<div class="section">
<h3 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a></h3>


<p>A plot is produced (provided <code>plot = TRUE</code>) of the input data and results.
The top panel is the input data, either the oxygen~time timeseries, or the
rate~oxygen series, depending on what was entered in <code>x</code>. If the former, the
critical oxygen value is indicated by a horizontal line, or two lines in the
case of the Broken-Stick analysis. Note, since the two <em>BSR</em> results are
usually close in value these may overlay each other.</p>
<p>The bottom plot is the rate~oxygen series upon which the analysis was
conducted, either as input or as calculated. Critical oxygen values are
indicated by vertical lines, and regression fits upon which the analysis was
based by black dashed lines.</p>
<p>Note, that in <code>respR</code> oxygen uptake rates are negative since they represent a
negative slope of oxygen against time, therefore by default rates are plotted
on a reverse y-axis so higher rates appear higher on the plot. If analysing
already calculated rates which are positive values this behaviour can be
reversed by passing <code>rate.rev = FALSE</code> in either the main function call or
when calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the output object. There is no issue with using
positive rate values; they will give identical critical value results in the
analysis.</p><div class="section">
<h4 id="additional-plotting-options">Additional plotting options<a class="anchor" aria-label="anchor" href="#additional-plotting-options"></a></h4>


<p>If the legend obscures parts of the plot they can be suppressed using <code>legend = FALSE</code>. Suppress console output messages with <code>quiet = TRUE</code>. Each panel
can be plotted on its own using <code>panel = 1</code> or <code>panel = 2</code>. If using
already-calculated, positive rate values to identify critical oxygen values,
the y-axis of the rolling rate plot can be plotted <em>not</em> reversed by passing
<code>rate.rev = FALSE</code> These inputs can be passed in either the main <code>oxy_crit</code>
call or when calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the output object. If axis labels
(particularly y-axis) are difficult to read, <code>las = 2</code> can be passed to make
axis labels horizontal, and <code>oma</code> (outer margins, default <code>oma = c(0.4, 1, 1.5, 0.4)</code>), and <code>mai</code> (inner margins, default <code>mai = c(0.3, 0.15, 0.35, 0.15)</code>) used to adjust plot margins.</p>
</div>


</div>

<div class="section">
<h3 id="s-generic-functions">S3 Generic Functions<a class="anchor" aria-label="anchor" href="#s-generic-functions"></a></h3>


<p>Saved output objects can be used in the generic S3 functions <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p><ul><li><p><code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>: prints the critical oxygen value for the particular <code>method</code>
used.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>: prints critical oxygen value, plus additional coefficients and
metadata for the particular <code>method</code> used. See Yeager &amp; Ultsch (1989) and
Muggeo (2008) for what these represent. The summary can be exported as a
separate data frame by passing <code>export = TRUE</code>.</p></li>
</ul></div>

<div class="section">
<h3 id="more">More<a class="anchor" aria-label="anchor" href="#more"></a></h3>


<p>For additional help, documentation, vignettes, and more visit the <code>respR</code>
website at <a href="https://januarharianto.github.io/respR/">https://januarharianto.github.io/respR/</a></p>
</div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>Yeager DP, Ultsch GR (1989) Physiological regulation and
conformation: A BASIC program for the determination of critical points.
Physiological Zoology 62:888–907. doi: 10.1086/physzool.62.4.30157935</p>
<p>Muggeo V (2008) Segmented: an R package to fit regression models with
broken-line relationships. R News 8:20–25.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Run on oxygen~time data.frame with default inputs</span></span></span>
<span class="r-in"><span><span class="fu">oxy_crit</span><span class="op">(</span><span class="va">squid.rd</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Applying column defaults of 'time = 1' and 'oxygen = 2'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing Broken-Stick analysis (Yeager and Ultsch 1989)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Broken-Stick analysis completed in 7.3 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plot.oxy_crit: Plotting Oxygen ~ Time derived critical oxygen results.</span>
<span class="r-plt img"><img src="oxy_crit-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.oxy_crit # ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Broken-Stick (Yeager &amp; Ultsch 1989):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum RSS      0.0000006404122 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept    2.610095 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Midpoint     2.609737 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Try a lower 'thin' input to speed up analysis</span></span></span>
<span class="r-in"><span><span class="fu">oxy_crit</span><span class="op">(</span><span class="va">squid.rd</span>, thin <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Applying column defaults of 'time = 1' and 'oxygen = 2'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing Broken-Stick analysis (Yeager and Ultsch 1989)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Broken-Stick analysis completed in 1.5 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plot.oxy_crit: Plotting Oxygen ~ Time derived critical oxygen results.</span>
<span class="r-plt img"><img src="oxy_crit-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.oxy_crit # ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Broken-Stick (Yeager &amp; Ultsch 1989):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum RSS      0.0000001280328 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept    2.612272 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Midpoint     2.614072 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use the Segmented method instead</span></span></span>
<span class="r-in"><span><span class="fu">oxy_crit</span><span class="op">(</span><span class="va">squid.rd</span>, method <span class="op">=</span> <span class="st">"segmented"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Applying column defaults of 'time = 1' and 'oxygen = 2'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing Segmented breakpoint analysis (Muggeo 2003)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Segmented analysis convergence attained in 1 iterations.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plot.oxy_crit: Plotting Oxygen ~ Time derived critical oxygen results.</span>
<span class="r-plt img"><img src="oxy_crit-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.oxy_crit # ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Segmented (Muggeo 2003):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Err.    0.001785513 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Breakpoint   2.610202 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Experiment with different 'width' input</span></span></span>
<span class="r-in"><span><span class="co"># Higher widths tend to oversmooth data</span></span></span>
<span class="r-in"><span><span class="fu">oxy_crit</span><span class="op">(</span><span class="va">squid.rd</span>, method <span class="op">=</span> <span class="st">"segmented"</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Applying column defaults of 'time = 1' and 'oxygen = 2'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing Segmented breakpoint analysis (Muggeo 2003)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Segmented analysis convergence attained in 1 iterations.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plot.oxy_crit: Plotting Oxygen ~ Time derived critical oxygen results.</span>
<span class="r-plt img"><img src="oxy_crit-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.oxy_crit # ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Segmented (Muggeo 2003):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Err.    0.001828214 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Breakpoint   2.700794 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span><span class="co"># Lower width in this case gives very similar result to default 0.1</span></span></span>
<span class="r-in"><span><span class="fu">oxy_crit</span><span class="op">(</span><span class="va">squid.rd</span>, method <span class="op">=</span> <span class="st">"segmented"</span>, width <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Applying column defaults of 'time = 1' and 'oxygen = 2'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing Segmented breakpoint analysis (Muggeo 2003)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Segmented analysis convergence attained in 1 iterations.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plot.oxy_crit: Plotting Oxygen ~ Time derived critical oxygen results.</span>
<span class="r-plt img"><img src="oxy_crit-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.oxy_crit # ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Segmented (Muggeo 2003):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Err.    0.00190483 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Breakpoint   2.609672 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run on oxygen~time data in 'inspect' object</span></span></span>
<span class="r-in"><span><span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="inspect.html">inspect</a></span><span class="op">(</span><span class="va">squid.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect # -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Time Oxygen</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-plt img"><img src="oxy_crit-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">oxy_crit</span><span class="op">(</span><span class="va">insp</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Applying column defaults of 'time = 1' and 'oxygen = 2'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing Broken-Stick analysis (Yeager and Ultsch 1989)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Broken-Stick analysis completed in 6.8 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plot.oxy_crit: Plotting Oxygen ~ Time derived critical oxygen results.</span>
<span class="r-plt img"><img src="oxy_crit-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.oxy_crit # ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Broken-Stick (Yeager &amp; Ultsch 1989):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum RSS      0.0000006404122 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept    2.610095 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Midpoint     2.609737 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run on already calculated rate~oxygen data</span></span></span>
<span class="r-in"><span><span class="co"># Calculate a rolling rate</span></span></span>
<span class="r-in"><span><span class="va">rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">squid.rd</span>,</span></span>
<span class="r-in"><span>                  method <span class="op">=</span> <span class="st">"rolling"</span>,</span></span>
<span class="r-in"><span>                  width <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                  plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">rate</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate a rolling mean oxygen</span></span></span>
<span class="r-in"><span><span class="va">oxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu">roll</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/roll/man/roll_mean.html" class="external-link">roll_mean</a></span><span class="op">(</span><span class="va">squid.rd</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                               width <span class="op">=</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">squid.rd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Combine to data.frame</span></span></span>
<span class="r-in"><span><span class="va">squid_rate_oxy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">oxy</span>, <span class="va">rate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Perform COV analysis</span></span></span>
<span class="r-in"><span><span class="fu">oxy_crit</span><span class="op">(</span><span class="va">squid_rate_oxy</span>, oxygen <span class="op">=</span> <span class="fl">1</span>, rate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing analysis using Rate ~ Oxygen data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Performing Broken-Stick analysis (Yeager and Ultsch 1989)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> oxy_crit: Broken-Stick analysis completed in 7.1 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> plot.oxy_crit: Plotting Rate ~ Oxygen derived critical oxygen results.</span>
<span class="r-plt img"><img src="oxy_crit-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.oxy_crit # ----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Broken-Stick (Yeager &amp; Ultsch 1989):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum RSS      0.0000006404122 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept    2.610095 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Midpoint     2.609737 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

