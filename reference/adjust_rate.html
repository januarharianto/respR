<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Adjust rates to account for background respiration or oxygen flux. — adjust_rate • respR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Adjust rates to account for background respiration or oxygen flux. — adjust_rate"><meta property="og:description" content="The adjust_rate function adjusts oxygen uptake or production rates (for
example, as determined in calc_rate() or auto_rate()) for background
oxygen use by microbial organisms, or for other removal or input of oxygen
during a respirometry experiment. The function accepts numeric values, as
well as regular respR objects, and data frames. See calc_rate.bg() for
determining background rates, which is the recommended way of passing
background rates to adjust_rate. Rates determined in calc_rate are also
accepted as background rates."><meta property="og:image" content="https://januarharianto.github.io/respR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul></li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Adjust rates to account for background respiration or oxygen flux.</h1>
    <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/R/adjust_rate.R" class="external-link"><code>R/adjust_rate.R</code></a></small>
    <div class="hidden name"><code>adjust_rate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>adjust_rate</code> function adjusts oxygen uptake or production rates (for
example, as determined in <code><a href="calc_rate.html">calc_rate()</a></code> or <code><a href="auto_rate.html">auto_rate()</a></code>) for background
oxygen use by microbial organisms, or for other removal or input of oxygen
during a respirometry experiment. The function accepts numeric values, as
well as regular <code>respR</code> objects, and data frames. See <code><a href="calc_rate.bg.html">calc_rate.bg()</a></code> for
determining background rates, which is the recommended way of passing
background rates to <code>adjust_rate</code>. Rates determined in <code>calc_rate</code> are also
accepted as background rates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">adjust_rate</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">by</span>,</span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_by2 <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>numeric. A single numeric value, numeric vector, or object of class
<code>calc_rate</code>, <code>calc_rate.int</code>, <code>auto_rate</code>, or <code>auto_rate.int</code>. This
contains the experimental rate value(s) to be adjusted.</p></dd>


<dt>by</dt>
<dd><p>numeric. A single numeric value, numeric vector, or object of class
<code>calc_rate.bg</code> or <code>calc_rate</code>. This is the background rate(s) used to
perform the adjustment to <code>x</code>. Can also be a <code>data.frame</code> or <code>inspect</code>
object for <code>"concurrent"</code>, <code>"linear"</code> or <code>"exponential"</code> adjustments. See
Details.</p></dd>


<dt>method</dt>
<dd><p>string. Method of background adjustment. Defaults to <code>"mean"</code>.
Other inputs are: <code>"value"</code>, <code>"paired"</code>, <code>"concurrent"</code>, <code>"linear"</code>,
<code>"exponential"</code>. See Details.</p></dd>


<dt>by2</dt>
<dd><p>numeric. Either a single numeric value, a <code>calc_rate.bg</code> or
<code>calc_rate</code> object, a <code>data.frame</code>, or <code>inspect</code> object. This is the source
of the second background adjustment rate, and used only for dynamic
adjustments (<code>"linear"</code> or <code>"exponential"</code>). See Details.</p></dd>


<dt>time_x</dt>
<dd><p>numeric. The timestamp(s) for the rate(s) in <code>x</code>, if it was
entered as a numeric (otherwise it is extracted from the <code>x</code> input object).
Generally this is the midpoint of the time range over which each <code>x</code> rate
was calculated. Used only in dynamic adjustments (<code>"linear"</code> or
<code>"exponential"</code>). See Details.</p></dd>


<dt>time_by</dt>
<dd><p>numeric. The timestamp of the background correction rate in
<code>by</code>, if it was entered as a numeric (otherwise it is extracted from the
<code>by</code> input object). Generally the midpoint of the time range over which it
was calculated. Used only in dynamic adjustments (<code>"linear"</code> or
<code>"exponential"</code>). See Details.</p></dd>


<dt>time_by2</dt>
<dd><p>numeric. The timestamp of the background correction rate in
<code>by2</code>, if it was entered as a numeric (otherwise it is extracted from the
<code>by2</code> input object). Generally the midpoint of the time range over which it
was calculated. Used only in dynamic adjustments (<code>"linear"</code> or
<code>"exponential"</code>). See Details.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Output is a list object of class <code>adjust_rate</code> containing all inputs,
input rates, adjustment values, adjustment method and model (if relevant),
and the primary output of interest <code>$rate.adjusted</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>adjust_rate</code> allows the rate, or multiple rates, in <code>x</code> to be adjusted in a
number of ways, as detailed below. Note that for those methods which accept
them, <code>by</code> and <code>by2</code> inputs of class <code>calc_rate</code>, <code>calc_rate.bg</code>,
<code>data.frame</code> or <code>inspect</code> can contain multiple columns of background oxygen
data, as long as they share the same numeric time data in column 1. In this
case, the mean of all rates calculated for all oxygen columns is used to
perform adjustments (see <code><a href="inspect.html">inspect()</a></code> and <code><a href="calc_rate.bg.html">calc_rate.bg()</a></code> to coerce data
to this form). The exception to this is the <code>"paired"</code> method, where each
rate in <code>by</code> (i.e. rate in each oxygen column) is paired with the rate at the
same position in <code>x</code> and used to adjust it.</p>
<p><em><strong>Note:</strong></em> take special care with the <em>sign</em> of the rate used for
adjustments. In <code>respR</code> oxygen uptake rates are negative, as they represent a
negative slope of oxygen against time. Background rates will normally also be
a negative value, while any input of oxygen would be positive. See Examples.</p>
<p><em><strong>Methods</strong></em></p>
<p>There are six methods of adjustment, briefly summarised here, with more
detail below:</p>
<p><code>"value"</code> - All experimental rates in <code>x</code> are adjusted by a single background
rate value in <code>by</code>.</p>
<p><code>"mean"</code> - This is the default method. All experimental rates in <code>x</code> are
adjusted by the mean of all background rate values in <code>by</code>.</p>
<p><code>"paired"</code> - Experimental rates in <code>x</code> are adjusted by the background rate
value at the same position in <code>by</code>. Therefore requires <code>x</code> and <code>by</code> to have
the same number of rates.</p>
<p><code>"concurrent"</code> - Experimental rates in <code>x</code> are adjusted by a background rate
calculated over the same time window in the data in <code>by</code>. Therefore requires
<code>x</code> and <code>by</code> to share the same time data and length (broadly speaking).</p>
<p><code>"linear"</code> - The time values for experimental rates in <code>x</code> are used to
calculate an adjustment value based on a background rate that changes
<em>linearly</em> with respect to time over the course of an experiment. Requires
two background recordings or values (<code>by</code>, <code>by2</code>), and that all data share
the same time data or scale.</p>
<p><code>"exponential"</code> - The time values for experimental rates in <code>x</code> are used to
calculate an adjustment value based on a background rate that changes
<em>exponentially</em> with respect to time over the course of an experiment.
Requires two background recordings or values (<code>by</code>, <code>by2</code>), and that all data
share the same time data or scale.</p>
<p><em><strong>More Detail</strong></em></p>
<p><code>"value"</code> - For experiments in which the rate from a single background
experiment (or any single background value) is being used to adjust one or
more specimen rates. Each rate in <code>x</code> is adjusted by the subtracting the
single value in <code>by</code>. <code>x</code> can be a numeric value, numeric vector,
<code>calc_rate</code>, <code>calc_rate.int</code>, <code>auto_rate</code>, or <code>auto_rate.int</code> object. <code>by</code>
can be a single numeric value, a <code>calc_rate.bg</code> object containing a single
<code>$rate.bg</code> (i.e. calculated from a 2-column data frame of time~oxygen), or a
<code>calc_rate</code> object containing a single <code>$rate</code>. All other inputs should be
<code>NULL</code>.</p>
<p><code>"mean"</code> - For experiments in which the mean rate from multiple background
experiments is being used to adjust one or more specimen rates. Each rate in
<code>x</code> is adjusted by subtracting the <em>mean</em> of all background rates in <code>by</code>.
<code>x</code> can be a numeric value, numeric vector, <code>calc_rate</code>, <code>calc_rate.int</code>,
<code>auto_rate</code>, or <code>auto_rate.int</code> object. <code>by</code> can be a numeric value, numeric
vector, <code>calc_rate.bg</code> object containing multiple <code>$rate.bg</code>, or a
<code>calc_rate</code> object containing multiple <code>$rate</code>. All other inputs should be
<code>NULL</code>. If <code>by</code> is a single value, this will obviously have the same output
as the <code>"value"</code> method.</p>
<p><code>"paired"</code> - For experiments where multiple specimen experiments are being
adjusted by multiple different background rates. This is a vectorised
adjustment operation: rates in <code>x</code> are adjusted by the background rates at
the same position in <code>by</code>. That is, the first <code>x</code> adjusted by the first <code>by</code>,
second <code>x</code> by second <code>by</code>, etc. <code>x</code> can be a numeric value, numeric vector,
<code>calc_rate</code>, <code>calc_rate.int</code>, <code>auto_rate</code>, or <code>auto_rate.int</code> object. <code>by</code>
can be a numeric vector <em>of the same length</em>, a <code>calc_rate.bg</code> or <code>calc_rate</code>
object where the <code>$rate.bg</code> or <code>$rate</code> element is the <em>same length</em> as the
rates in <code>x</code> to be adjusted. All other inputs should be <code>NULL</code>.</p>
<p><code>"concurrent"</code> - For experiments in which one or more concurrent "blanks" or
background experiments are run alongside specimen experiments. Rates in <code>x</code>
are adjusted by a background rate calculated over the same time window in the
data in <code>by</code>. That is, the start and end time of each <code>x</code> rate is used to fit
a linear regression and calculate a background rate in the <code>$dataframe</code> in
<code>by</code>. <code>x</code> must be an <code>calc_rate</code>, <code>calc_rate.int</code>, <code>auto_rate</code>, or
<code>auto_rate.int</code> object. <code>by</code> must be a <code>data.frame</code>, <code>inspect</code>,
<code>calc_rate.bg</code>, or <code>calc_rate</code> object containing time~oxygen data. If there
are multiple columns of background oxygen the mean rate across the same time
window in all columns is used. In <code>calc_rate.bg</code> and <code>calc_rate</code> objects the
<code>$rate.bg</code> or <code>$rate</code> element is not used, only the <code>$dataframe</code>. The <code>x</code> and
<code>by</code> data must share (broadly) the <em>same time data or scale in the same
units</em>. If the <code>x</code> and <code>by</code> data differ in length by more than 5% or some
time values are not shared between the two datasets, a warning is given, but
the adjustment is nevertheless performed using the available data, by using
the closest matching time window in the background data.</p>
<p><code>"linear"</code> - This is a dynamic adjustment, intended for experiments in which
the background oxygen rate <em>changes</em> over the course of the experiment
<em>linearly</em> with respect to time. This is typical of long duration
respirometry experiments in high temperatures, where a "blank" is conducted
at the start of the experiment before the specimen is put in, and again at
the end after it is taken out. It requires therefore two background
recordings sharing the same numeric <em>time data</em> or <em>time scale</em>, in the same
units as the experiment to be adjusted. These can also be entered as two rate
<em>values</em> with associated <em>timestamps</em>, which again must share the same time
scale and units as the rate to be adjusted. This method can also be used in
experiments in which a concurrent blank experiment is conducted alongside
specimen experiments (as described in the <code>concurrent</code> method above), but in
which the background data is deemed too noisy to fit reliable regressions
over the short timescales specimen rates are determined. In this case, <em>any</em>
two reliable segments of the background data of any duration can be used to
determine how the background rate changes over the course of the experiment,
and then this used to adjust specimen rates using the appropriate rate
timestamps. The <em>time~background rate</em> linear relationship is calculated
using the midpoint of the time range of the <code>by</code> and <code>by2</code> rate regressions
(or values plus timestamps). The adjustments to <code>x</code> rates are calculated by
taking the midpoint of the time range over which it was determined and
applying it to the <code>by~by2</code> linear relationship. The <code>x</code> input can be a
numeric value, numeric vector, or a <code>calc_rate</code>, <code>calc_rate.int</code>,
<code>auto_rate</code>, or <code>auto_rate.int</code> object containing single or multiple rates.
The <code>by</code> input is the first background recording or rate value, and <code>by2</code> the
second background recording or rate value.</p>
<p>While it is typical, the <code>x</code> rates do not necessarily need to be at
intermediate timepoints to the <code>by/by2</code> times. these are used only to
establish a <em>time~background rate</em> linear relationship, which can be
extrapolated before or after the time values used to calculate it. The <code>by</code>
and <code>by2</code> inputs can be a <code>data.frame</code>, <code>inspect</code> or <code>calc_rate.bg</code> object
containing background time~oxygen data. Alternatively, the rate <code>x</code>, and
background rates <code>by</code> and <code>by2</code> can be entered as values, in which case the
associated timepoints at which these were determined (generally the midpoint
of the time range over which the linear regression was fit) must be entered
as <code>time_x</code>, <code>time_by</code>, and <code>time_by2</code> (these timepoints are otherwise
automatically extracted from the input objects). Multiple <code>x</code> rates with
multiple <code>time_x</code> timepoints can be entered and adjusted, but only one linear
background rate relationship applied, that is <code>by</code>, <code>by2</code>, <code>time_by</code>, and
<code>time_by2</code> must be single numeric values in the correct units.</p>
<p><code>"exponential"</code> - This is a dynamic adjustment, intended for experiments in
which the background oxygen rate <em>changes</em> over the course of the experiment
<em>exponentially</em> with respect to time. This is typical of long duration
respirometry experiments in high temperatures, where a "blank" is conducted
at the start of the experiment before the specimen is put in, and again at
the end after it is taken out, and the background rate is found to increase
exponentially. This is identical to the <code>"linear"</code> method (see above for
requirements), except the adjustment is calculated as an exponential
relationship of the form - <code>lm(log(c(by, by2)) ~ c(time_by, time_by2))</code>.</p><div class="section">
<h3 id="s-generic-functions">S3 Generic Functions<a class="anchor" aria-label="anchor" href="#s-generic-functions"></a></h3>


<p>Saved output objects can be used in the generic S3 functions <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>,
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, and <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>.</p><ul><li><p><code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>: prints a single result, by default the first adjusted rate.
Others can be printed by passing the <code>pos</code> input. e.g. <code>print(x, pos = 2)</code></p></li>
<li><p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>: prints summary table of all results and metadata, or those
specified by the <code>pos</code> input. e.g. <code>summary(x, pos = 1:5)</code>. The summary can
be exported as a separate dataframe by passing <code>export = TRUE</code>.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>: calculates the mean of all adjusted rates, or those specified by
the <code>pos</code> input. e.g. <code>mean(x, pos = 1:5)</code> The mean can be exported as a
separate value by passing <code>export = TRUE</code>.</p></li>
</ul></div>

<div class="section">
<h3 id="more">More<a class="anchor" aria-label="anchor" href="#more"></a></h3>


<p>For additional help, documentation, vignettes, and more visit the <code>respR</code>
website at <a href="https://januarharianto.github.io/respR/">https://januarharianto.github.io/respR/</a></p>
</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Note that oxygen uptake rates are negative in respR since they represent a</span></span></span>
<span class="r-in"><span><span class="co"># decrease in dissolved oxygen and negative slope. Typically both</span></span></span>
<span class="r-in"><span><span class="co"># specimen rate and background rate values are negative.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simple background adjustment to a single rate</span></span></span>
<span class="r-in"><span><span class="co"># This is (-7.44) - (-0.04) = -7.40</span></span></span>
<span class="r-in"><span><span class="fu">adjust_rate</span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">7.44</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.04</span>, method <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "value" method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.adjust_rate # -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: Consider the sign of the adjustment value when adjusting the rate.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using the 'value' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rank 1 of 1 adjusted rate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rate          : -7.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment    : -0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted Rate : -7.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> To see full results use summary().</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Oxygen input adjustment</span></span></span>
<span class="r-in"><span><span class="co"># This is (-7.44) - (0.1) = -7.54</span></span></span>
<span class="r-in"><span><span class="fu">adjust_rate</span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">7.44</span>, by <span class="op">=</span> <span class="fl">0.1</span>, method <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "value" method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.adjust_rate # -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: Consider the sign of the adjustment value when adjusting the rate.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using the 'value' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rank 1 of 1 adjusted rate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rate          : -7.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment    : 0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted Rate : -7.54 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> To see full results use summary().</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mean background respiration correction to a single rate.</span></span></span>
<span class="r-in"><span><span class="fu">adjust_rate</span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">7.44</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.04</span>, <span class="op">-</span><span class="fl">0.05</span>, <span class="op">-</span><span class="fl">0.06</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: The 'by' input contains multiple background rates. The mean value will be used to perform adjustments.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "mean" method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.adjust_rate # -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: Consider the sign of the adjustment value when adjusting the rate.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using the 'mean' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rank 1 of 1 adjusted rate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rate          : -7.44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment    : -0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted Rate : -7.39 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> To see full results use summary().</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mean background respiration correction to multiple rates.</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">adjust_rate</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7.44</span>, <span class="op">-</span><span class="fl">7.20</span>, <span class="op">-</span><span class="fl">7.67</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.04</span>, <span class="op">-</span><span class="fl">0.05</span>, <span class="op">-</span><span class="fl">0.06</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: The 'by' input contains multiple background rates. The mean value will be used to perform adjustments.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "mean" method.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # summary.adjust_rate # -----------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using 'mean' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of all rate results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    rank  rate adjustment rate.adjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:    1 -7.44      -0.05         -7.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:    2 -7.20      -0.05         -7.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    3 -7.67      -0.05         -7.62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Paired background respiration correction to multiple rates.</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">adjust_rate</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7.44</span>, <span class="op">-</span><span class="fl">7.20</span>, <span class="op">-</span><span class="fl">7.67</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.04</span>, <span class="op">-</span><span class="fl">0.05</span>, <span class="op">-</span><span class="fl">0.06</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"paired"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "paired" method.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # summary.adjust_rate # -----------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using 'paired' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of all rate results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    rank  rate adjustment rate.adjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:    1 -7.44      -0.04         -7.40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:    2 -7.20      -0.05         -7.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    3 -7.67      -0.06         -7.61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Dynamic linear adjustment</span></span></span>
<span class="r-in"><span><span class="co"># With a linear relationship between the 'by' and 'by2' rates,</span></span></span>
<span class="r-in"><span><span class="co"># at the midpoint time value the adjustment to 'x' should be -0.5</span></span></span>
<span class="r-in"><span><span class="fu">adjust_rate</span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>,</span></span>
<span class="r-in"><span>            time_x <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>            by <span class="op">=</span> <span class="fl">0</span>, by2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>            time_by <span class="op">=</span> <span class="fl">0</span>, time_by2 <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>            method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "linear" method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.adjust_rate # -------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: Consider the sign of the adjustment value when adjusting the rate.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using the 'linear' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rank 1 of 1 adjusted rate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rate          : -10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment    : -0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted Rate : -9.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> To see full results use summary().</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same operation to multiple rates</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">adjust_rate</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">11</span>, <span class="op">-</span><span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   time_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">600</span>, <span class="fl">700</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   by <span class="op">=</span> <span class="fl">0</span>, by2 <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   time_by <span class="op">=</span> <span class="fl">0</span>, time_by2 <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>                   method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "linear" method.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # summary.adjust_rate # -----------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using 'linear' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of all rate results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    rank rate adjustment rate.adjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:    1  -10       -0.5          -9.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:    2  -11       -0.6         -10.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    3  -12       -0.7         -11.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A complete workflow using objects instead of values.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract a single replicate from the middle of the zebrafish data</span></span></span>
<span class="r-in"><span><span class="co"># and calculate rates</span></span></span>
<span class="r-in"><span><span class="va">zeb_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span>,</span></span>
<span class="r-in"><span>                        from <span class="op">=</span> <span class="fl">38300</span>,</span></span>
<span class="r-in"><span>                        to <span class="op">=</span> <span class="fl">38720</span>,</span></span>
<span class="r-in"><span>                        by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: Applying column default of 'time = 1'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: Applying column default of 'oxygen = 2'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect # -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Time Oxygen</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> auto_rate: Applying default 'width' of 0.2</span>
<span class="r-plt img"><img src="adjust_rate-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="adjust_rate-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate background rate at start of experiment</span></span></span>
<span class="r-in"><span><span class="va">bg_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span>, <span class="fl">1</span>, <span class="fl">4999</span>, <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: Applying column default of 'time = 1'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: Applying column default of 'oxygen = 2'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect # -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Time Oxygen</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> calc_rate.bg: Applying column default of 'time = 1'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> calc_rate.bg: Applying column default of all non-time column(s) as 'oxygen'</span>
<span class="r-plt img"><img src="adjust_rate-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # plot.calc_rate.bg # -------------------</span>
<span class="r-plt img"><img src="adjust_rate-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.calc_rate.bg: Plotting all 1 background rates ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.calc_rate.bg # ------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Background rate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.00007417108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean background rate:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.00007417108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate background rate at end of experiment</span></span></span>
<span class="r-in"><span><span class="va">bg_end</span> <span class="op">&lt;-</span> <span class="fu"><a href="subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span>, <span class="fl">75140</span>, <span class="fl">79251</span>, <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: Applying column default of 'time = 1'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: Applying column default of 'oxygen = 2'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect # -----------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Time Oxygen</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> calc_rate.bg: Applying column default of 'time = 1'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> calc_rate.bg: Applying column default of all non-time column(s) as 'oxygen'</span>
<span class="r-plt img"><img src="adjust_rate-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # plot.calc_rate.bg # -------------------</span>
<span class="r-plt img"><img src="adjust_rate-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.calc_rate.bg: Plotting all 1 background rates ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.calc_rate.bg # ------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Background rate(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.0001216593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean background rate:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.0001216593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform a dynamic linear adjustment</span></span></span>
<span class="r-in"><span><span class="fu">adjust_rate</span><span class="op">(</span><span class="va">zeb_rate</span>, by <span class="op">=</span> <span class="va">bg_start</span>, by2 <span class="op">=</span> <span class="va">bg_end</span>,</span></span>
<span class="r-in"><span>            method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> adjust_rate: Rate adjustments applied using "linear" method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # summary.adjust_rate # -----------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjustment was applied using 'linear' method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of all rate results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    rep rank intercept_b0     slope_b1   rsq   density row endrow  time endtime      oxy   endoxy         rate     adjustment rate.adjusted</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  NA    1     80.99546 -0.001914038 0.909 1263.6742 218    398 38517   38697 7.276907 6.981903 -0.001914038 -0.00009712636  -0.001816912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  NA    2     90.75258 -0.002166859 0.978  967.3665   4    375 38303   38674 7.799663 6.968113 -0.002166859 -0.00009705102  -0.002069808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  NA    3    119.55548 -0.002917213 0.823  420.6539  47    132 38346   38431 7.691533 7.461897 -0.002917213 -0.00009698745  -0.002820226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note the adjustment values applied are somewhere between the</span></span></span>
<span class="r-in"><span><span class="co"># start and end background rate values</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

