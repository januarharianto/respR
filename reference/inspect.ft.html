<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Explore and visualise flowthrough respirometry data and check for errors — inspect.ft • respR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Explore and visualise flowthrough respirometry data and check for errors — inspect.ft"><meta property="og:description" content="inspect.ft is a data exploration and preparation function that visualises
flowthrough respirometry data, checks it for common issues, and prepares it
for use in later functions in respR, such as calc_rate.ft()."><meta property="og:image" content="https://januarharianto.github.io/respR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu"><li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul></li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Explore and visualise flowthrough respirometry data and check for errors</h1>
    <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/R/inspect.ft.R" class="external-link"><code>R/inspect.ft.R</code></a></small>
    <div class="hidden name"><code>inspect.ft.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>inspect.ft</code> is a data exploration and preparation function that visualises
flowthrough respirometry data, checks it for common issues, and prepares it
for use in later functions in <code>respR</code>, such as <code><a href="calc_rate.ft.html">calc_rate.ft()</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">inspect.ft</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  out.oxy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in.oxy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  in.oxy.value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delta.oxy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code>data.frame</code> containing columns of <code>time</code> and <code>out.oxy</code> or
<code>delta.oxy</code> concentrations, and optionally <code>in.oxy</code>.</p></dd>


<dt>time</dt>
<dd><p>integer or string. Defaults to <code>1</code>. Specifies the column of the
Time data as either a column number or the name.</p></dd>


<dt>out.oxy</dt>
<dd><p>integer(s) or string(s). Defaults to <code>NULL</code>. Specifies the
column(s) of the outflow oxygen data as either column numbers or names.</p></dd>


<dt>in.oxy</dt>
<dd><p>integer(s) or string(s). Defaults to <code>NULL</code>. Specifies the
column(s) of the inflow oxygen data as either column numbers or names.</p></dd>


<dt>in.oxy.value</dt>
<dd><p>numeric value. Defaults to <code>NULL</code>. If there is no
continuous <code>in.oxy</code> data, this specifies a fixed value of oxygen
concentration for inflowing water in same units as <code>out.oxy</code>, and is used
with <code>out.oxy</code> to calculate a <code>delta.oxy</code>.</p></dd>


<dt>delta.oxy</dt>
<dd><p>integer(s) or string(s). Defaults to all non-time columns if
no other inputs given. Specifies the column number(s) or name(s) of delta
oxygen data, for when the user has already calculated the difference
between outflow and inflow oxygen (should be negative values for oxygen
uptake). If this is used, <code>out.oxy</code> and <code>in.oxy</code> should be NULL.</p></dd>


<dt>plot</dt>
<dd><p>logical. Defaults to TRUE. Plots the data. See Details.</p></dd>


<dt>add.data</dt>
<dd><p>integer or string. Defaults to <code>NULL</code>. Specifies the column
number or name of an optional additional data source that will be plotted
in blue alongside the full oxygen timeseries.</p></dd>


<dt>...</dt>
<dd><p>Allows additional plotting controls to be passed, such as <code>legend = FALSE</code>, <code>quiet = TRUE</code>, <code>rate.rev = FALSE</code> and <code>pos</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Output is a <code>list</code> object of class <code>inspect.ft</code> containing input
parameters and data, data check summaries, and metadata, which can be
passed to <code><a href="calc_rate.ft.html">calc_rate.ft()</a></code> to determine rates. If there are failed checks
or warnings, the row locations of the potentially problematic data can be
found in <code>$locs</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>inspect.ft</code> is intended to be specific to <em>flowthrough</em> respirometry data.
In flowthrough respirometry (also known as 'open flow' or 'continuous flow'
respirometry) rather than calculating a rate from a changing oxygen
concentration recording in a sealed chamber, instead the difference (i.e.
'oxygen delta') between the inflowing and outflowing oxygen concentrations of
a respirometer receiving water at a constant flow rate is used to calculate
an oxygen consumption or production rate, typically after it has reached a
steady state. Therefore, in general, regions of stable oxygen delta values
(difference between outflow and inflow oxygen) are of interest. <code>inspect.ft</code>
visualises and prepares the data for use in <code><a href="calc_rate.ft.html">calc_rate.ft()</a></code>. By specifying
data types in this function and saving the output, they do not need to be
specified in later functions.</p><div class="section">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a></h3>


<p>Given an input data frame <code>x</code>, the function scans the columns specified via
the <code>time</code>, <code>out.oxy</code>, <code>in.oxy</code> or <code>delta.oxy</code> inputs. Columns are specified
by using the column number (e.g. <code>time = 1</code>), or by name (e.g. <code>time = "Time.Hrs"</code>). If no columns are specified, by default the function assumes
the first column is <code>time</code>, and all others are <code>delta.oxy</code> oxygen data.
However, best practice is to use the inputs to specify particular columns.</p>
<p>The <code>x</code> input must contain at least two data types; a single column of
numeric <code>time</code> data, with <em>either</em> a column of paired <code>out.oxy</code>
concentrations (i.e. the exhalent or 'downstream' concentrations), <em>or</em> a
column of already calculated <code>delta.oxy</code> values, that is the difference
between outflow and inflow concentrations, or the outflow concentration
corrected by a background recording from a 'blank' or empty chamber.</p>
<p><strong>out.oxy input option</strong>: If an <code>out.oxy</code> column has been specified, in order
to calculate the oxygen delta (and therefore a rate in <code><a href="calc_rate.ft.html">calc_rate.ft()</a></code>)
there must also be an inflow oxygen concentration input (i.e. the inhalent or
'upstream' concentration). This will generally be a column of paired <code>in.oxy</code>
concentrations, in which case the paired values of <code>out.oxy</code> and <code>in.oxy</code> are
used to calculate the oxygen <code>delta.oxy</code>, which is saved in the output and
used to determine a rate in <code><a href="calc_rate.ft.html">calc_rate.ft()</a></code>. Alternatively, if the inflow
oxygen concentration is a known, generally unvarying value (such as fully
air-saturated water from a header tank) this can be entered as a single value
via <code>in.oxy.value</code> and this is used to calculate the <code>delta.oxy</code>.</p>
<p><strong>delta.oxy input option</strong>: If delta oxygen values have already been
calculated, these can be entered via the <code>delta.oxy</code> input, and these are
prepared and saved for rate calculations in <code>calc_rate.ft</code>.</p>
</div>

<div class="section">
<h3 id="check-for-numeric-data">Check for numeric data<a class="anchor" aria-label="anchor" href="#check-for-numeric-data"></a></h3>


<p><code>respR</code> requires data be in the form of paired values of numeric time and
oxygen. All columns are checked that they contain numeric data before any
other checks are performed. If any of the inspected columns do not contain
numeric data the remaining checks for that column are skipped, and the
function exits returning <code>NULL</code>, printing the summary of the checks. No plot
is produced. Only when all inspected columns pass this numeric check can the
resulting output object be saved and passed to other <code>respR</code> functions.</p>
</div>

<div class="section">
<h3 id="other-checks">Other checks<a class="anchor" aria-label="anchor" href="#other-checks"></a></h3>


<p>The <code>time</code> column is checked for missing (<code>NA/NaN</code>) values, infinite values
both positive and negative (<code>Inf/-Inf</code>), that values are sequential, that
there are no duplicate times, and that it is numerically evenly-spaced.
Oxygen columns are checked for missing (<code>NA/NaN</code>) and infinite values
(<code>Inf/-Inf</code>). See <strong>Failed Checks</strong> section for what it means for analyses if
these checks result in warnings. If the output is assigned, the specified
columns are saved to a <code>list</code> object for use in later functions such as
<code><a href="calc_rate.ft.html">calc_rate.ft()</a></code>. A plot is also produced.</p>
</div>

<div class="section">
<h3 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a></h3>


<p>If <code>plot = TRUE</code>, entered data is plotted against both time (bottom, blue
axis) and row index (top, red axis), depending on the inputs:</p><ul><li><p>a single <code>out.oxy</code> column with either a paired <code>in.oxy</code> column or
<code>in.oxy.value</code>: a two panel plot. The top plot is both outflow (green points)
and inflow (turquoise points) oxygen. The bottom plot is the oxygen delta
(black points) between outflow and inflow oxygen, essentially a unitless
oxygen uptake or production rate.</p></li>
<li><p>a single <code>delta.oxy</code> column: a one panel plot of oxygen delta values.</p></li>
<li><p>multiple <code>out.oxy</code> or <code>delta.oxy</code> columns: a grid plot of all <code>delta.oxy</code>
data (either as entered or calculated from <code>out.oxy</code> and <code>in.oxy</code>). Specific
delta plots can be examined individually by using the <code>pos</code> input (e.g.
<code>plot(x, pos = 2)</code>). Y-axes are not equal.</p></li>
<li><p>unspecified columns: all columns are plotted assuming <code>time</code> is in column
1, and all others are oxygen <code>delta.oxy</code> data. Y-axes are not equal.</p></li>
</ul><p>In delta plots, that is those plotting <code>delta.oxy</code> values, either directly
entered or calculated, consistent oxygen uptake or production rates will be
represented by flat or level regions. The <code>width</code> input may help with
selecting regions from which to extract rates, and can be passed in the main
function call or using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the output object. This smooths delta
oxygen values by calculating a rolling mean across the data. See <strong>Additional
plotting options</strong> below.</p>
<p><em><strong>Note:</strong></em> Since <code>respR</code> is primarily used to examine oxygen consumption,
the delta oxygen and rate plots are by default plotted on a reverse y-axis.
In <code>respR</code> oxygen uptake rates are negative since they represent a negative
slope of oxygen against time. In these plots the axis is reversed so that
higher uptake rates (i.e. more negative) will be higher on these plots. If
you are interested instead in oxygen production rates, which are positive,
the <code>rate.rev = FALSE</code> input can be passed in either the <code>inspect.ft</code> call,
or when using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the output object. In this case, the delta and rate
values will be plotted numerically, and higher oxygen <em>production</em> rates will
be higher on the plot.</p>
</div>

<div class="section">
<h3 id="plot-an-additional-data-source">Plot an additional data source<a class="anchor" aria-label="anchor" href="#plot-an-additional-data-source"></a></h3>


<p>Using the <code>add.data</code> input an additional data source, for example
temperature, can be plotted alongside the oxygen timeseries. This should be
either a column number (e.g. <code>add.data = 3</code>) or name (e.g. <code>add.data = "Temperature"</code>) indicating a column in the input <code>x</code> data frame sharing the
same time data. None of the data checks are performed on this column; it is
simply to give a basic visual aid in the plot to, for example, help decide if
regions of the data should be used or not used because this parameter was
variable. Values are saved in the output as a vector under <code>$add.data</code>. It is
plotted in blue on a separate y-axis on the main timeseries plot. It is <em>not</em>
plotted if multiple oxygen columns are inspected. See examples.</p>
</div>

<div class="section">
<h3 id="additional-plotting-options">Additional plotting options<a class="anchor" aria-label="anchor" href="#additional-plotting-options"></a></h3>


<p>The <code>width</code> input may help with selecting regions from which to extract
rates. This smooths delta oxygen values by calculating a rolling mean across
the data, and should be a value between 0 and 1 representing a proportion of
the total data width. If left as the default <code>NULL</code> no smoothing is
performed. This is a visual aid which only affects plotted values and does
not alter output delta oxygen values.</p>
<p>If the legend or labels obscure part of the plot, they can be suppressed via
<code>legend = FALSE</code> in either the <code>inspect.ft</code> call, or when using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on
the output object. Suppress console output messages with <code>quiet = TRUE</code>. If
multiple columns have been inspected, the <code>pos</code> input can be used to examine
each <code>out.oxy</code>~<code>in.oxy</code>~<code>del.oxy</code> dataset. If axis labels (particularly
y-axis) are difficult to read, <code>las = 2</code> can be passed to make axis labels
horizontal. In addition, <code>oma</code> (outer margins, default <code>oma = c(0.4, 1, 1.5, 0.4)</code>), and <code>mai</code> (inner margins, default <code>mai = c(0.3, 0.15, 0.35, 0.15)</code>)
can be used to adjust plot margins.</p>
</div>

<div class="section">
<h3 id="multiple-data-columns">Multiple data columns<a class="anchor" aria-label="anchor" href="#multiple-data-columns"></a></h3>


<p>For a quick overview of larger experiments, multiple columns of <code>out.oxy</code>,
<code>in.oxy</code> and <code>delta.oxy</code> can be inspected, but must share the same numeric
time data column specified by the <code>time</code> input. Note, multiple column
inspection is chiefly intended to be exploratory functionality to provide a
quick overview of larger datasets. While the output will contain all data
columns in <code>$dataframe</code> and <code>$data</code>, subsequent functions such as
<code><a href="calc_rate.ft.html">calc_rate.ft()</a></code> will use only the first <code>delta.oxy</code> column for calculating
rates. Best practice is to inspect and assign each individual experiment or
column pair as separate <code>inspect.ft</code> objects. See Examples.</p>
<p>If multiple <code>out.oxy</code> columns are specified, <code>in.oxy</code> can be a single column
(if for example all chambers are supplied from the same header tank), in
which case it is used to calculate an oxygen delta for all <code>out.oxy</code> columns.
A single <code>in.oxy.value</code> in the same units as <code>out.oxy</code> can also be specified.
There can also be multiple <code>in.oxy</code> columns, in which case it is assumed each
<code>out.oxy</code> column is paired with each <code>in.oxy</code> at the same position, and used
to calculate the oxygen <code>delta.oxy</code>. In this case, <code>out.oxy</code> and <code>in.oxy</code>
must have equal numbers of columns.</p>
</div>

<div class="section">
<h3 id="failed-checks">Failed Checks<a class="anchor" aria-label="anchor" href="#failed-checks"></a></h3>


<p>The most important data check in <code>inspect.ft</code> is that all data columns are
numeric. If any column fails this check, the function skips the remaining
checks for that column, the function exits returning <code>NULL</code>, and no output
object or plot is produced.</p>
<p>The other failed check that requires action is the check for infinite values
(<code>Inf/-Inf</code>). Some oxygen sensing systems add these in error when
interference or data dropouts occur. Infinite values will cause problems when
it comes to calculating rates, so need to be removed. If found, locations of
these are printed and can be found in the output object under <code>$locs</code>. Note,
these values are not plotted, so special note should be taken of the warnings
and console printout.</p>
<p>The remaining data checks in <code>inspect.ft</code> are mainly exploratory and help
diagnose and flag potential issues with the data that might affect rate
calculations. For instance, long experiments may have had sensor dropouts the
user is unaware of. Some might not be major issues. For instance, an uneven
time warning can result from using decimalised minutes, which is a completely
valid time metric, but happens to be numerically unevenly spaced. As an
additional check, if uneven time is found, the minimum and maximum intervals
in the time data are in the console output, so a user can see immediately if
there are large gaps in the data.</p>
<p>If some of these checks produce warnings, it should <em>generally</em> not hinder
analysis of the data. <code>respR</code> has been coded to rely on linear regressions on
exact data values, and not make assumptions about data spacing or order.
Therefore issues such as missing or NA/NaN values, duplicate or
non-sequential time values, or uneven time spacing should not cause any
erroneous results, as long as they do not occur over large regions of the
data. <code>inspect.ft</code> however outputs locations (row numbers) of where these
issues occur (located in the <code>$locs</code> element of the output), allowing users
to amend them before analysis. We would recommend that to be completely
confident in any results from analysis of such data, and avoid obscure
errors, these issues be addressed before proceeding.</p>
</div>

<div class="section">
<h3 id="background-control-or-blank-experiments">Background control or "blank" experiments<a class="anchor" aria-label="anchor" href="#background-control-or-blank-experiments"></a></h3>


<p>For experiments in which the specimen data is to be background corrected by a
concurrently-run control experiment, <code>inspect.ft</code> can be used by specifying
the specimen experiment as <code>out.oxy</code>, and the "blank" as the <code>in.oxy</code> input.
In this way, any variations in oxygen in the specimen data due to background
microbial activity, or for any other reason such as fluctuations in inflow
oxygen, are accounted for in the delta oxygen calculations, and therefore in
the rate calculated in <code><a href="calc_rate.ft.html">calc_rate.ft()</a></code>. See the vignettes on the website
for examples.</p>
<p>If the background recordings are experiments with their own outflow and
inflow recordings, which show a generally consistent oxygen delta due to
microbial activity, this can be saved as a separate <code>inspect.ft</code> object, a
background rate calculated in <code><a href="calc_rate.ft.html">calc_rate.ft()</a></code>, and this used in
<code><a href="adjust_rate.ft.html">adjust_rate.ft()</a></code> as the <code>by</code> input to perform background adjustments to
specimen rates.</p>
<p><strong>Note</strong>: All background calculations should be from experiments done at the
<em>same flow rate</em> as the specimen experiments to be corrected.</p>
</div>

<div class="section">
<h3 id="s-generic-functions">S3 Generic Functions<a class="anchor" aria-label="anchor" href="#s-generic-functions"></a></h3>


<p>Saved output objects can be used in the generic S3 functions <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>,
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p><ul><li><p><code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>: plots the result.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>: prints a summary of the checks performed on the data. If issues
are found, locations (row numbers) are printed (up to first 20 occurrences).</p></li>
<li><p><code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>: simple wrapper for <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> function. See above.</p></li>
</ul></div>

<div class="section">
<h3 id="more">More<a class="anchor" aria-label="anchor" href="#more"></a></h3>


<p>For additional help, documentation, vignettes, and more visit the <code>respR</code>
website at <a href="https://januarharianto.github.io/respR/">https://januarharianto.github.io/respR/</a></p>
</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect outflow and inflow oxygen data</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">inspect.ft</span><span class="op">(</span><span class="va">flowthrough.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                in.oxy <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect.ft: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect.ft # --------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 time oxy.out oxy.in</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass    pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass    pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass    pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass       -      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass       -      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass       -      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect.ft # --------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 time oxy.out oxy.in</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass    pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass    pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass    pass   pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass       -      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass       -      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass       -      -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # plot.inspect.ft # ---------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> plot.inspect.ft: Plotting inspect.ft dataset from position 1 of 1 ... </span>
<span class="r-plt img"><img src="inspect.ft-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect outflow oxygen data with inflow oxygen as a known value in</span></span></span>
<span class="r-in"><span><span class="co"># the same units</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">inspect.ft</span><span class="op">(</span><span class="va">flowthrough.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                in.oxy.value <span class="op">=</span> <span class="fl">8.90</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect.ft: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect.ft # --------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 time oxy.out</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass    pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass    pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass    pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass       -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass       -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass       -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-plt img"><img src="inspect.ft-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect already calculated delta oxygen data</span></span></span>
<span class="r-in"><span><span class="fu">inspect.ft</span><span class="op">(</span><span class="va">flowthrough.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, delta.oxy <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect.ft: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect.ft # --------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 time oxy.delta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric         pass      pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf        pass      pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN          pass      pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential      pass         -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated      pass         -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced   pass         -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-plt img"><img src="inspect.ft-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inspect multiple columns for a quick overview</span></span></span>
<span class="r-in"><span><span class="fu">inspect.ft</span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, delta.oxy <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>inspect.ft: Time values are not evenly-spaced (numerically).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect.ft: Data issues detected. For more information use print().</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect.ft # --------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 num.time oxy.delta.1 oxy.delta.2 oxy.delta.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric             pass        pass        pass        pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf            pass        pass        pass        pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN              pass        pass        pass        pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential          pass           -           -           -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated          pass           -           -           -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced       WARN           -           -           -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Uneven Time data locations (first 20 shown) in column: num.time </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum and Maximum intervals in uneven Time data: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01 0.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-plt img"><img src="inspect.ft-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Inspect outflow and use a blank control chamber as background</span></span></span>
<span class="r-in"><span><span class="co"># correction</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># This experiment has increasing background respiration over time.</span></span></span>
<span class="r-in"><span><span class="co"># Inspecting outflow oxygen with inflow header tank concentrations</span></span></span>
<span class="r-in"><span><span class="co"># suggests specimen rates (bottom delta.oxy plot) are increasing.</span></span></span>
<span class="r-in"><span><span class="fu">inspect.ft</span><span class="op">(</span><span class="va">flowthrough_sim.rd</span>, time <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>           out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect.ft: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect.ft # --------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 num_time oxy.out.spec oxy.header</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric             pass         pass       pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf            pass         pass       pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN              pass         pass       pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential          pass            -          -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated          pass            -          -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced       pass            -          -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-plt img"><img src="inspect.ft-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># However, inspecting with recordings from a concurrent blank</span></span></span>
<span class="r-in"><span><span class="co"># control accounts for this and shows specimen rates are level</span></span></span>
<span class="r-in"><span><span class="co"># when background is taken into account.</span></span></span>
<span class="r-in"><span><span class="fu">inspect.ft</span><span class="op">(</span><span class="va">flowthrough_sim.rd</span>, time <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>           out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> inspect.ft: No issues detected while inspecting data frame.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # print.inspect.ft # --------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 num_time oxy.out.spec oxy.out.blank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric             pass         pass          pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Inf/-Inf            pass         pass          pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NA/NaN              pass         pass          pass</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sequential          pass            -             -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> duplicated          pass            -             -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> evenly-spaced       pass            -             -</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-plt img"><img src="inspect.ft-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

