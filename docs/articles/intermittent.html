<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysis of intermittent-flow data â€¢ respR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">respR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent.html">Analysis of intermittent-flow data</a>
    </li>
    <li>
      <a href="../articles/pcrit.html">Determining Pcrit</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Analysis of intermittent-flow data</h1>
            
          </div>

    
    
<div class="contents">
<div id="intermittent-flow-respirometry" class="section level3">
<h3 class="hasAnchor">
<a href="#intermittent-flow-respirometry" class="anchor"></a>Intermittent-flow respirometry</h3>
<p>Intermittent-flow respirometry involves obtaining multiple replicates in an experiment by periodically flushing the respirometer with fresh treatment water or air after a set period of time or <span class="math inline">\(O_2\)</span> decrease. Typically, the oxygen sensing system is left recording during flushes. If the dataset is not split into the separate replicates, this results in an dataset with oscillating levels of oxygen, which may be tricky to analyse.</p>
<p>The example data, <code>intermittent.rd</code>, contains intermittent-flow measurements of oxygen consumption in the sea urchin <em>Heliocidaris erythrogramma</em>. Detailed information about the data, including its source and methods, can be obtained with the command <code><a href="../reference/intermittent.rd.html">?intermittent.rd</a></code>.</p>
<p>We can use <code><a href="../reference/inspect_data.html">inspect_data()</a></code> to scan for errors in the data frame and preview the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urchin_int &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_data.html">inspect_data</a></span>(intermittent.rd)
<span class="co">#&gt; O2 :  num [1:4831] 7.17 7.17 7.18 7.16 7.2 7.2 7.16 7.16 7.19 7.18 ...</span>
<span class="co">#&gt; Time :  int [1:4831] 0 1 2 3 4 5 6 7 8 9 ...</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt;                     Score</span>
<span class="co">#&gt; No NA/NaN in time   PASS </span>
<span class="co">#&gt; No NA/NaN in Oxygen PASS </span>
<span class="co">#&gt; Sequential Time     PASS </span>
<span class="co">#&gt; Non-duplicated Time PASS </span>
<span class="co">#&gt; Evenly-spaced Time  PASS</span>
<span class="co">#&gt; New dataframe generated.</span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-2-1.png" width="576"></p>
<p>We can see from the top plot that this dataset has three replicates. The flush periods obviously skew the bottom rate plot, however uptake rates appear to be consistent within each experimental replicate.</p>
</div>
<div id="using-calc_rate-on-intermittent-flow-data" class="section level3">
<h3 class="hasAnchor">
<a href="#using-calc_rate-on-intermittent-flow-data" class="anchor"></a>Using <code>calc_rate</code> on intermittent-flow data</h3>
<p>While we intend in the future to support intermittent data directly with a dedicated function to automatically identify and subset replicates, intermittent data can be analysed quite easily via the main <code>calc_rate</code> function with a little organisation.</p>
<div id="subsetting-by-row-and-time" class="section level4">
<h4 class="hasAnchor">
<a href="#subsetting-by-row-and-time" class="anchor"></a>Subsetting by row and time</h4>
<p>The <code>calc_rate</code> function supports input of multiple subset regions by <code>row</code> or <code>time</code>. The <code>from</code> and <code>to</code> operators can be vectors with paired values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urchin_int_rates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int, <span class="dt">from =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">2300</span>, <span class="dv">4100</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="dv">1800</span>, 
    <span class="dv">3200</span>, <span class="dv">4600</span>), <span class="dt">by =</span> <span class="st">"time"</span>)</code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(urchin_int_rates)
<span class="co">#&gt; Rate(s):</span>
<span class="co">#&gt; [1] -0.0005734109 -0.0006097325 -0.0006539752</span></code></pre></div>
<p>Calling <code>summary()</code> will show the coefficients and locations of each subset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(urchin_int_rates)
<span class="co">#&gt; Summary:</span>
<span class="co">#&gt;    intercept_b0       rate_b1   rsq  row endrow time endtime  oxy endoxy</span>
<span class="co">#&gt; 1:     7.127202 -0.0005734109 0.995  201   1801  200    1800 7.05   6.11</span>
<span class="co">#&gt; 2:     8.528274 -0.0006097325 0.990 2301   3201 2300    3200 7.12   6.58</span>
<span class="co">#&gt; 3:     9.731918 -0.0006539752 0.967 4101   4601 4100    4600 7.08   6.73</span>
<span class="co">#&gt;    rowlength timelength rate_twopoint</span>
<span class="co">#&gt; 1:      1600       1600    -0.0005875</span>
<span class="co">#&gt; 2:       900        900    -0.0006000</span>
<span class="co">#&gt; 3:       500        500    -0.0007000</span></code></pre></div>
<p>We can also use <code>plot()</code> to view the diagnostic plots of any individual replicate. The argument <code>rep</code> determines which data subset to plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(urchin_int_rates, <span class="dt">rep =</span> <span class="dv">2</span>)
<span class="co">#&gt; Plotting...this may take a while for large datasets.</span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>We can also query multiple regions of each replicate (which could overlap, although this would obscure the output plot):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int, <span class="dt">from =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="dv">900</span>, <span class="dv">2300</span>, <span class="dv">2900</span>, <span class="dv">4000</span>, <span class="dv">4400</span>), <span class="dt">to =</span> <span class="kw">c</span>(<span class="dv">700</span>, 
    <span class="dv">1700</span>, <span class="dv">2700</span>, <span class="dv">3300</span>, <span class="dv">4300</span>, <span class="dv">4700</span>), <span class="dt">by =</span> <span class="st">"time"</span>)</code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<pre><code>#&gt; Rate(s):
#&gt; [1] -0.0006790314 -0.0005463056 -0.0005853780 -0.0005705494 -0.0006845746
#&gt; [6] -0.0006334074</code></pre>
<p>Rates can be easily extracted for further analysis or selection. For instance, we may be interested in the lowest rate, the one most representative of basal metabolic rates. Of course because rates are negative, the minimum <em>value</em> in negative terms would actually represent the highest rate, so we should extract the maximum (least negative) value, or transform the rates first:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urchin_int_rates<span class="op">$</span>rate
<span class="co">#&gt; [1] -0.0005734109 -0.0006097325 -0.0006539752</span>
<span class="kw">min</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>urchin_int_rates<span class="op">$</span>rate)
<span class="co">#&gt; [1] 0.0005734109</span></code></pre></div>
<p>Or we may be more interested in the mean rate:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(urchin_int_rates<span class="op">$</span>rate)
<span class="co">#&gt; [1] -0.0006123729</span></code></pre></div>
</div>
<div id="subsetting-by-oxygen" class="section level4">
<h4 class="hasAnchor">
<a href="#subsetting-by-oxygen" class="anchor"></a>Subsetting by oxygen</h4>
<p>If we are interested in looking at rates over particular oxygen ranges within each replicate, <code>calc_rate</code> will find the first match to the range entered:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int, <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)</code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<pre><code>#&gt; Rate(s):
#&gt; [1] -0.0006191943</code></pre>
<p>To examine the same range in each replicate, we can follow a number of approaches. We can call the data range containing another replicate directly from the original dataset, or <code>inspect_data</code> object element:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(intermittent.rd[<span class="dv">2100</span><span class="op">:</span><span class="dv">3500</span>, ], <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)
<span class="co">#&gt; Rate(s):</span>
<span class="co">#&gt; [1] -0.000615731</span>
<span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int<span class="op">$</span>df[<span class="dv">2100</span><span class="op">:</span><span class="dv">3500</span>, ], <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)
<span class="co">#&gt; Rate(s):</span>
<span class="co">#&gt; [1] -0.000615731</span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>Or we can subset them manually into new dataframes, and process them separately through the entire workflow. This would also be a necessary procedure to examine each replicate in <code>auto_rate</code> to determine minimum, maximum or best fit rates within each.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create separate replicate data frames</span>
u_rep1 &lt;-<span class="st"> </span>intermittent.rd[<span class="dv">1</span><span class="op">:</span><span class="dv">1900</span>, ]
u_rep2 &lt;-<span class="st"> </span>intermittent.rd[<span class="dv">2100</span><span class="op">:</span><span class="dv">3500</span>, ]
u_rep3 &lt;-<span class="st"> </span>intermittent.rd[<span class="dv">3700</span><span class="op">:</span><span class="dv">4831</span>, ]

<span class="co"># Process one in `inspect_data` (output not shown)</span>
u_rep3_c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_data.html">inspect_data</a></span>(u_rep3)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(u_rep3_c, <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)</code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<pre><code>#&gt; Rate(s):
#&gt; [1] -0.0006188192</code></pre>
</div>
</div>
<div id="background-adjustments" class="section level3">
<h3 class="hasAnchor">
<a href="#background-adjustments" class="anchor"></a>Background adjustments</h3>
<p>The <code>adjust_rate</code> function can be used on <code>calc_rate</code> objects containing multiple rate values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urchin_int_rates_adj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/adjust_rate.html">adjust_rate</a></span>(urchin_int_rates, <span class="dt">by =</span> <span class="op">-</span><span class="fl">5e-05</span>)
<span class="kw">print</span>(urchin_int_rates_adj)
<span class="co">#&gt; Note: please consider the sign of the value while correcting the rate.</span>
<span class="co">#&gt; Input rate: -0.0005734109 -0.0006097325 -0.0006539752</span>
<span class="co">#&gt; Adjustment: -5e-05</span>
<span class="co">#&gt;  Adj. rate: -0.0005234109 -0.0005597325 -0.0006039752</span></code></pre></div>
<p>We can see each individual rate has been adjusted, and the new rates can be extracted from the resulting object using <code>$corrected</code>.</p>
</div>
<div id="converting-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#converting-rates" class="anchor"></a>Converting rates</h3>
<p>Once the rates have been determined, they can be converted to volume-corrected or mass-specific rates using <code>convert_rate</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(urchin_int_rates_adj, <span class="dt">o2.unit =</span> <span class="st">"mg/L"</span>, <span class="dt">time.unit =</span> <span class="st">"s"</span>, <span class="dt">output.unit =</span> <span class="st">"mg/h/g"</span>, 
    <span class="dt">volume =</span> <span class="fl">2.379</span>, <span class="dt">mass =</span> <span class="fl">0.006955</span>)
<span class="co">#&gt; Input:</span>
<span class="co">#&gt; [1] -0.0005234109 -0.0005597325 -0.0006039752</span>
<span class="co">#&gt; [1] "mg/L" "sec" </span>
<span class="co">#&gt; Output:</span>
<span class="co">#&gt; [1] -0.6445291 -0.6892556 -0.7437362</span>
<span class="co">#&gt; [1] "mg/hour/g"</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Januar Harianto, Nicholas Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
