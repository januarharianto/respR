<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Open science and reproducibility using respR • respR</title>
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Open science and reproducibility using respR">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/auto_rate.html">auto_rate 1: Automatic detection of metabolic rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate_comp.html">auto_rate 3: Comparative performance of auto_rate and LoLinR</a>
    </li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/importing.html">Importing your data</a>
    </li>
    <li>
      <a href="../articles/intermittent.html">Intermittent-flow respirometry 1: Simple example</a>
    </li>
    <li>
      <a href="../articles/intermittent2.html">Intermittent-flow respirometry 2: Complex example</a>
    </li>
    <li>
      <a href="../articles/packages_comp.html">respR vs. other R packages</a>
    </li>
    <li>
      <a href="../articles/pcrit.html">Pcrit</a>
    </li>
    <li>
      <a href="../articles/performance.html">auto_rate 2: Performance in detecting linear regions</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Open science and reproducibility using respR</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">respR and the Tidyverse</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point analyses</a>
    </li>
    <li>
      <a href="../articles/when_to_use.html">When to use `respR`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Open science and reproducibility using respR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/master/vignettes/reproducibility.Rmd"><code>vignettes/reproducibility.Rmd</code></a></small>
      <div class="hidden name"><code>reproducibility.Rmd</code></div>

    </div>

    
    
<p>One of the main motivations in creating <code>respR</code> was to promote open, reproducible respirometry analyses.</p>
<p>Respirometry is ubiquitous in experimental biology, however there is a lack of standard approaches in analysing respirometry data. Reporting of respirometry analyses is often vague and lacking in detail. This can be understandable given journal word limits, however it hinders attempts to reproduce or scrutinise the data and analyses. In particular, many analysis criteria and parameters are underreported, for example the criteria used to select regions over which rates were determined, or in the case of maximum or minimum rates, the width used when fitting multiple regressions.</p>
<p>In the era of cheap data storage, and easy sharing of files online, there is little reason why all stages of analyses and raw data cannot be made available to reviewers, readers and other investigators as supplementary material or in specialised online repositories. We have designed <code>respR</code> to help make this process straightforward.</p>
<div id="readable-concise-code" class="section level2">
<h2 class="hasAnchor">
<a href="#readable-concise-code" class="anchor"></a>Readable, concise code</h2>
<p>The functions in <code>respR</code> have clear, unambiguous arguments describing the operators and the parameters used in analysis. Therefore, given some familiarity with the package functions, the code is very human-readable, and it is usually clear under what parameters an analysis was conducted. We have minimised the number of function operators where possible, mainly to streamline and simplify analyses, but this also has the side benefit of making input code less verbose and more readable. This, along with the fact that an end-to-end workflow could potentially consist of processing raw data through as few as three functions, means the entire script for a <code>respR</code> workflow for a single experiment could consist of only a few lines of code.</p>
</div>
<div id="transparent-and-portable-analyses" class="section level2">
<h2 class="hasAnchor">
<a href="#transparent-and-portable-analyses" class="anchor"></a>Transparent and portable analyses</h2>
<p>While there is commercial software which can analyse respirometry data (e.g. AutoResp by Loligo), these are often poorly designed, complex, inefficient, and often prohibitively expensive and locked to single platforms, if not single computers. The main drawback of these is that they are not open-source or allow for transparent analyses. Alternatively, many investigators have their own analysis workflows in Excel and R. These are perfectly fine and work well on an individual basis or within a lab, but even if the spreadsheet or code is shared, their custom nature means that reproducibility is difficult for an independent user or require a significant time commitment. <code>respR</code> seeks to solve these problems.</p>
<p>We have designed respR to avoid it being a “black box”, into which data is fed and a result spit out with the user having little understanding or oversight into what is happening. We feel it important a user understands their data, which is why we include exploratory functions to visualise the data, look for common errors, and prepare it for analysis. We designed the functions to allow straightforward natural-language querying of different parts of the data in terms the user can understand, so they should always be aware of what they are doing. All the analytical functions also provide visualisations of the analysis and results. All output objects support the base R <code>plot()</code>, <code>print()</code> and <code>summary()</code> commands, which allow quick assessment of the most important outputs. As with all R packages and functions, the code underlying the analysis is easily viewable, so advanced users can investigate how it works for themselves.</p>
</div>
<div id="documenting-reproducible-workflows" class="section level2">
<h2 class="hasAnchor">
<a href="#documenting-reproducible-workflows" class="anchor"></a>Documenting reproducible workflows</h2>
<div id="simple-sharing-of-scripts" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-sharing-of-scripts" class="anchor"></a>Simple sharing of scripts</h3>
<p>The easiest way of providing a reproducible workflow using <code>respR</code> is to include the raw data as a <code>.csv</code> or <code>.rda</code> file , and include a <code>.R</code> script containing all the code used to import and process that data file. Because <code>respR</code> has been designed as an end-to-end workflow covering every step in the analysis of respirometry data, code for all stages from raw data input, data preparation and exploration, determining rates, and converting the rates to specific units can be included in a single file, and usually this will comprise only a few lines of code. There may be additional data inputs (experiment specific parameters such as volumes, masses, temperatures, etc.). These can be entered as values in code, but typically would be included as an additional data file, and most R users should be familiar with how to format these in good database-style formatting, and how to reference relevant values in code.</p>
<p>To demonstrate how brief an entire end-to-end <code>respR</code> workflow can be, here’s an example of a typical script which uses the <code>sardine.rd</code> dataset included in the package. We inspect the data, determine the most linear rate, and the maximum rate over a 10 minute period, and finally convert rates to mass-specific units.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Load the package
<span class="kw">library</span>(respR)

## Import data
## Here we would typically use import_file() to import an data file, but sardine.rd is already loaded

## Experiment parameters (typically this would be an existing database-style object containing data for many experiments)
exp_param &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">volume =</span> <span class="fl">12.3</span>, <span class="dt">mass =</span> <span class="fl">21.41</span>, <span class="dt">DO.unit =</span> <span class="st">"mg/l"</span>, <span class="dt">time.unit =</span> <span class="st">"s"</span>)

## Inspect the data, and save it as an object
exp_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect.html">inspect</a></span>(sardine.rd)

## Determine rates
exp_1_linear_rate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/auto_rate.html">auto_rate</a></span>(exp_<span class="dv">1</span>)
exp_1_max_rate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/auto_rate.html">auto_rate</a></span>(exp_<span class="dv">1</span>, <span class="dt">method =</span> <span class="st">"max"</span>, <span class="dt">width =</span> <span class="dv">600</span>)

## Convert rates to mass-specific units using the experimental parameters
exp_1_linear_rate_conv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(exp_1_linear_rate, 
                                       <span class="dt">output.unit =</span> <span class="st">"mg/h/kg"</span>,
                                       <span class="dt">o2.unit =</span> exp_param<span class="op">$</span>DO.unit,
                                       <span class="dt">time.unit =</span> exp_param<span class="op">$</span>time.unit,
                                       <span class="dt">volume =</span> exp_param<span class="op">$</span>volume,
                                       <span class="dt">mass =</span> exp_param<span class="op">$</span>mass)

exp_1_max_rate_conv &lt;-<span class="st"> </span><span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(exp_1_max_rate, 
                                    <span class="dt">output.unit =</span> <span class="st">"mg/h/kg"</span>,
                                    <span class="dt">o2.unit =</span> exp_param<span class="op">$</span>DO.unit,
                                    <span class="dt">time.unit =</span> exp_param<span class="op">$</span>time.unit,
                                    <span class="dt">volume =</span> exp_param<span class="op">$</span>volume,
                                    <span class="dt">mass =</span> exp_param<span class="op">$</span>mass)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Results
exp_1_linear_rate_conv
<span class="co">#&gt; </span>
<span class="co">#&gt; # convert_rate # ------------------------</span>
<span class="co">#&gt; Rank/position 1 result shown. To see all results use summary().</span>
<span class="co">#&gt; Input:</span>
<span class="co">#&gt; [1] -0.00066147</span>
<span class="co">#&gt; [1] "mg/L" "sec" </span>
<span class="co">#&gt; Converted:</span>
<span class="co">#&gt; [1] -1.368047</span>
<span class="co">#&gt; [1] "mg/hour/kg"</span>

exp_1_max_rate_conv
<span class="co">#&gt; </span>
<span class="co">#&gt; # convert_rate # ------------------------</span>
<span class="co">#&gt; Rank/position 1 result shown. To see all results use summary().</span>
<span class="co">#&gt; Input:</span>
<span class="co">#&gt; [1] -0.001193478</span>
<span class="co">#&gt; [1] "mg/L" "sec" </span>
<span class="co">#&gt; Converted:</span>
<span class="co">#&gt; [1] -2.468343</span>
<span class="co">#&gt; [1] "mg/hour/kg"</span></code></pre></div>
<p>This shows an entire analysis workflow can be conducted in only a few lines of code.</p>
</div>
<div id="saving-single-respr-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#saving-single-respr-objects" class="anchor"></a>Saving single respR objects</h3>
<p>For more documented analyses, for documenting parts of a workflow, or for saving the outputs of specific functions, we can use the base R <code>saveRDS</code> function. The main functions in <code>respR</code> output R objects which include raw data, results and also metadata in the form of subsetting criteria, models and input parameters. Thus, each of these objects contains all the information saved from the previous function that created it, and so all the information required to continue through the <code>respR</code> workflow from any intermediate stage. These objects can be saved using <code>saveRDS</code> and distributed like any other file. This can allow each stage of the analysis to be saved, and shared or archived. An advantage of using one of these objects is that an analysis can be continued from a certain point without having to re-run the entire workflow. For example, data can be imported, inspected, a rate determined through the <code>auto_rate</code> function, and the resulting output object exported via <code>saveRDS</code>. This could be shared with a colleague who can then import it into their own R project using <code>readRDS</code>, and feed it into <code>convert_rate</code> to convert it to whatever units they wish without having to run any other parts of the workflow.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Running this code will show how saveRDS and readRDS preserves values
## correctly, and gives the exact same results when used in further stages of
## the workflow

## Inspect
urch_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect.html">inspect</a></span>(urchins.rd, <span class="dt">time =</span> <span class="dv">1</span>, <span class="dt">oxygen =</span> <span class="dv">15</span>)

## Export resulting object to working directory
<span class="kw">saveRDS</span>(urch_data, <span class="dt">file =</span> <span class="st">"urch_data.rds"</span>)

## Re-import it to new object
urch_data_in &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="dt">file =</span> <span class="st">"urch_data.rds"</span>)

## Check values are preserved - should be TRUE
<span class="kw">all.equal</span>(urch_data, urch_data_in)

## Determine rate using original and imported objects
urch_rate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/auto_rate.html">auto_rate</a></span>(urch_data)
urch_rate_in &lt;-<span class="st"> </span><span class="kw"><a href="../reference/auto_rate.html">auto_rate</a></span>(urch_data_in)

## Check results are the same - should be TRUE
<span class="kw">all.equal</span>(urch_rate, urch_rate_in)</code></pre></div>
<p>One example of using this method to document a reproducible workflow, would be to save the object created by <code>inpect_data</code> and include that along with the script for the rest of the analysis rather than including original data files. This object includes the raw data, but using it tells the next user the data has already been checked for common errors such as missing data, and if so these errors fixed, and so that step is unnecessary.</p>
</div>
<div id="saving-all-respr-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#saving-all-respr-objects" class="anchor"></a>Saving all respR objects</h3>
<p>To document or archive an entire working environment we can use the <code>save.image()</code> command. This function saves to the working directory every object and value in the current R environment (though not scripts, i.e. <code>.R</code> files.). This way, all objects from the analysis of a single experiment, or multiple experiments, can be saved to a single file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Will save entire environment to current working directory
<span class="kw">save.image</span>(<span class="dt">file =</span> <span class="st">"experiment_1.rda"</span>)</code></pre></div>
<p>The environment can be reimported by double clicking on the file (usually RStudio will ask if you want to import it to the current project), or <code>load()</code> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Will load entire environment to current working project. Path to the file
## must be specified, or it must be in current working directory.
<span class="kw">load</span>(<span class="dt">file =</span> <span class="st">"experiment_1.rda"</span>)</code></pre></div>
<p>This avoids having to save every object individually.</p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>We hope this brief vignette has helped you understand how <code>respR</code> may be used to produce open and reproducible science from your respirometry data. As scientists, we have probably all wished we could get the raw data from a publication, or struggled to extract data from old plots and tables. So we encourage you to use our package, and when you come to submit your paper consider including supplementary material as described above to allow others to scrutinise and reproduce your results, and in the future utilise your data for new analyses. This benefits the science community as a whole.</p>
<p>If you do use <code>respR</code> in your analyses, please do let us know. We would love to keep a running list of projects where it has proven useful.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#readable-concise-code">Readable, concise code</a></li>
      <li><a href="#transparent-and-portable-analyses">Transparent and portable analyses</a></li>
      <li><a href="#documenting-reproducible-workflows">Documenting reproducible workflows</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Januar Harianto, Nicholas Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
