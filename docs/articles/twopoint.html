<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Two-point analyses • respR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">respR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent.html">Analysis of intermittent-flow data</a>
    </li>
    <li>
      <a href="../articles/pcrit.html">Determining Critical Oxygen Tension, Pcrit</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Two-point analyses</h1>
            
          </div>

    
    
<div class="contents">
<p>In some analyses we may want to use only two datapoints of oxygen concentration separated by a known time period to calculate a rate. This could result from <strong>closed-bottle respirometry</strong>, where only the initial and final oxygen concentrations are recorded, in situations of periodic and irregular oxygen monitoring or sampling, or because experimental problems caused erroneous or suspect data to be recorded during an experiment. This approach of course comes with the assumption that rates are relatively constant over the relevant time period, or alternatively the investigator is not particularly interested in how rate may have fluctuated in the intervening time, but rather the total flux and therefore total rate.</p>
<p>While the linear regression approach of <code>respR</code> may still provide valid rate estimates, this may not work in the case of irregular data recordings, and the two-point output of <code>calc_rate</code> allows useable rates to be determined from sparse or partially erroneous data via this approach.</p>
<div id="two-point-data" class="section level3">
<h3 class="hasAnchor">
<a href="#two-point-data" class="anchor"></a>Two-point data</h3>
<p>Simple two-point data can be entered into <code>calc.rate</code> in a 2x2 data frame (here created via typical R syntax):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">two_pt_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">o2 =</span> <span class="kw">c</span>(<span class="fl">8.5</span>, <span class="fl">6.3</span>))
two_pt_data
<span class="co">#&gt;   time  o2</span>
<span class="co">#&gt; 1    0 8.5</span>
<span class="co">#&gt; 2   10 6.3</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">two_pt_result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(two_pt_data)
<span class="kw">summary</span>(two_pt_result)
<span class="co">#&gt; Summary:</span>
<span class="co">#&gt;    intercept_b0 rate_b1 rsq row endrow time endtime oxy endoxy rowlength</span>
<span class="co">#&gt; 1:          8.5   -0.22   1   1      2    0      10 8.5    6.3         1</span>
<span class="co">#&gt;    timelength rate_twopoint</span>
<span class="co">#&gt; 1:         10         -0.22</span></code></pre></div>
<p>The two-point rate can be seen at the end of the summary object. With only two datapoints, it will obviously be equal to the rate in the linear regression method. However, it can be extracted directly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">two_pt_result<span class="op">$</span>rate_2pt
<span class="co">#&gt; [1] -0.22</span></code></pre></div>
</div>
<div id="working-around-erroneous-data" class="section level3">
<h3 class="hasAnchor">
<a href="#working-around-erroneous-data" class="anchor"></a>Working around erroneous data</h3>
<p>More useful is using two-point calculations to work around cases of partially erroneous data. Often we can still extract perfectly valid rates as long as the investigator knows <em>some</em> of the data contains the true oxygen values. In the following example we will use the <code>urchin.rd</code> data to simulate a dataset where interference has caused regions of erroneous data, but where the intitial and end conditions are known to be reliable recordings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## extract some rows of time and one O2 column
urchin_mod &lt;-<span class="st"> </span>urchins.rd[<span class="dv">1</span><span class="op">:</span><span class="dv">150</span>, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">15</span>)]

## simulate sensor dropout
urchin_mod[<span class="dv">30</span><span class="op">:</span><span class="dv">49</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>urchin_mod[<span class="dv">30</span><span class="op">:</span><span class="dv">49</span>, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.02</span>, <span class="fl">0.46</span>, <span class="fl">0.046</span>), <span class="kw">rev</span>(<span class="kw">seq</span>(<span class="fl">0.02</span>, 
    <span class="fl">0.46</span>, <span class="fl">0.046</span>)))
urchin_mod[<span class="dv">70</span><span class="op">:</span><span class="dv">89</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>urchin_mod[<span class="dv">70</span><span class="op">:</span><span class="dv">89</span>, <span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="fl">0.02</span>, <span class="fl">0.36</span>, <span class="fl">0.036</span>), <span class="kw">rev</span>(<span class="kw">seq</span>(<span class="fl">0.02</span>, 
    <span class="fl">0.36</span>, <span class="fl">0.036</span>)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/inspect_data.html">inspect_data</a></span>(urchin_mod)</code></pre></div>
<p><img src="twopoint_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>Here we can see our two erroneous regions. We could remove these sections, or only use the lower section of the data, but we can also use the subsetting operators of <code>calc_rate</code> to select data that starts and ends where we know valid O₂ recordings were made:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">two_pt_result &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_mod, <span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">23</span>, <span class="dt">by =</span> <span class="st">"time"</span>)</code></pre></div>
<p><img src="twopoint_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(two_pt_result)
<span class="co">#&gt; Summary:</span>
<span class="co">#&gt;    intercept_b0     rate_b1   rsq row endrow time endtime  oxy endoxy</span>
<span class="co">#&gt; 1:     7.510606 -0.01689257 0.448  13    139    2      23 7.61   7.14</span>
<span class="co">#&gt;    rowlength timelength rate_twopoint</span>
<span class="co">#&gt; 1:       126         21   -0.02238095</span></code></pre></div>
<p>We can clearly see the linear regression method substantially underestimates the rate because it is skewed downwards. In this case, the two-point output will clearly be a better estimate of the rate of this specimen.</p>
</div>
<div id="processing-two-point-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-two-point-rates" class="anchor"></a>Processing two-point rates</h3>
<p>Two-point rates can be passed to <code>adjust_rate</code> for background corrections, and <code>convert_rate</code> for conversion to the desired output units. However, if using an object of class <code>calc_rate</code> they must be specifically called using <code>$rate_2pt</code> or, by default, the adjustment or conversion will operate on the linear regression derived rate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/adjust_rate.html">adjust_rate</a></span>(two_pt_result<span class="op">$</span>rate_2pt, <span class="dt">by =</span> <span class="op">-</span><span class="fl">0.001</span>)
<span class="co">#&gt; Note: please consider the sign of the value while correcting the rate.</span>
<span class="co">#&gt; Input rate: -0.02238095</span>
<span class="co">#&gt; Adjustment: -0.001</span>
<span class="co">#&gt;  Adj. rate: -0.02138095</span>

<span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(two_pt_result<span class="op">$</span>rate_2pt, <span class="dt">o2.unit =</span> <span class="st">"mg/L"</span>, <span class="dt">time.unit =</span> <span class="st">"h"</span>, <span class="dt">output.unit =</span> <span class="st">"mg/h/g"</span>, 
    <span class="dt">volume =</span> <span class="dv">25</span>, <span class="dt">mass =</span> <span class="fl">0.2</span>)
<span class="co">#&gt; Input:</span>
<span class="co">#&gt; [1] -0.02238095</span>
<span class="co">#&gt; [1] "mg/L" "hour"</span>
<span class="co">#&gt; Output:</span>
<span class="co">#&gt; [1] -0.002797619</span>
<span class="co">#&gt; [1] "mg/hour/g"</span></code></pre></div>
<p>They can alternatively be entered manually:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(<span class="op">-</span><span class="fl">0.0224</span>, <span class="dt">o2.unit =</span> <span class="st">"mg/L"</span>, <span class="dt">time.unit =</span> <span class="st">"h"</span>, <span class="dt">output.unit =</span> <span class="st">"mg/h/g"</span>, 
    <span class="dt">volume =</span> <span class="dv">25</span>, <span class="dt">mass =</span> <span class="fl">0.2</span>)
<span class="co">#&gt; Input:</span>
<span class="co">#&gt; [1] -0.0224</span>
<span class="co">#&gt; [1] "mg/L" "hour"</span>
<span class="co">#&gt; Output:</span>
<span class="co">#&gt; [1] -0.0028</span>
<span class="co">#&gt; [1] "mg/hour/g"</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Januar Harianto, Nicholas Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
