<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>inspect: Inspecting data • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="inspect: Inspecting data">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR in Use</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>inspect: Inspecting data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/inspecting.Rmd" class="external-link"><code>vignettes/inspecting.Rmd</code></a></small>
      <div class="hidden name"><code>inspecting.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The first step in any data analysis should be to visualise the data
and check it for errors.</p>
<p><code><a href="../reference/inspect.html">inspect()</a></code> is a data exploration and preparation function
that visualises respirometry data and inspects it for common issues that
may affect the use of further functions in <code>respR</code>. Columns
of a dataframe are designated as <code>time</code> and
<code>oxygen</code>, and these are subset into a new object that can be
passed to subsequent functions, reducing the need for additional
inputs.</p>
<p>Note, use of <code>inspect</code> to prepare data for the subsequent
functions is optional. Most functions in <code>respR</code> can accept
regular <code>R</code> data objects including data frames, data tables,
tibbles, vectors, etc. It is a quality control and exploration step to
help users explore and prepare their data prior to analysis.</p>
<p>Depending on the data type, the function will perform a series of
checks. These were informed by experiences working with real
respirometry data from a variety of systems, and the data issues that
were most frequently encountered.</p>
<div class="section level3">
<h3 id="flowthrough-respirometry-data">Flowthrough respirometry data<a class="anchor" aria-label="anchor" href="#flowthrough-respirometry-data"></a>
</h3>
<p>Most of the following is also relevant to <code><a href="../reference/inspect.ft.html">inspect.ft()</a></code>
which is a special function for inspecting flowthrough respirometry
data. See <code><a href="../articles/flowthrough.html">vignette("flowthrough")</a></code> for specific
examples.</p>
</div>
</div>
<div class="section level2">
<h2 id="successful-check">Successful check<a class="anchor" aria-label="anchor" href="#successful-check"></a>
</h2>
<p>This is what a successful <code>inspect</code> check looks like; all
columns are numeric and without missing values, and the time data are
sequential, unique values and with even spacing. See <a href="#plot">plot</a> section below for details about the plot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">sardine.rd</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time Oxygen</span></span>
<span><span class="co">#&gt; numeric         pass   pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass   pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass   pass</span></span>
<span><span class="co">#&gt; sequential      pass      -</span></span>
<span><span class="co">#&gt; duplicated      pass      -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This dataset is therefore ready to be passed to further
<code>respR</code> functions. While we have in general designed
<code>respR</code> to be robust to data which might contain these
issues, we have not been able to test every eventuality. Therefore, to
be fully confident in results and avoid obscure errors we strongly
recommend data be amended to pass the following tests wherever
possible.</p>
</div>
<div class="section level2">
<h2 id="numeric">Numeric<a class="anchor" aria-label="anchor" href="#numeric"></a>
</h2>
<p>Many datasets on being imported to <code>R</code> can have column
data types misclassified. A stray character or even space may cause an
entire column of numeric data to be classed as a non-numeric format such
as <code>character</code>. For example, some versions of the Pyro and
Firesting systems software replace missing data with <code>"---"</code>,
which causes the entire column to be classed as <code>character</code>
when imported to R. Often this is a single entry in a random location
where a data recording has been missed, or at the very end of a column,
so not obvious when the data is given a quick look.</p>
<p>The first and most important check <code>inspect</code> performs is
that the specified <code>time</code> and <code>oxygen</code> columns are
numeric. If this check fails, the rest of the checks for that column are
skipped, and the function exits returning a <code>NULL</code> value. No
plot is produced. <code>respR</code> functions cannot process
non-numeric data, so only when all inspected columns pass this check
will the function output an <code>inspect</code> object that can be
passed to subsequent functions.</p>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>This dataset has a single time value missing and replaced with
<code>"---"</code>, which causes the entire column to be classed as
<code>character</code>. This is not at all obvious if you view a portion
of the data not containing the missing value.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time  oxy</span></span>
<span><span class="co">#&gt; 1    1 7.86</span></span>
<span><span class="co">#&gt; 2    2 7.87</span></span>
<span><span class="co">#&gt; 3    3 7.89</span></span>
<span><span class="co">#&gt; 4    4 7.90</span></span>
<span><span class="co">#&gt; 5    5 7.87</span></span>
<span><span class="co">#&gt; 6    6 7.82</span></span></code></pre></div>
<p>Only by checking the structure is this obvious.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    100 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ time: chr  "1" "2" "3" "4" ...</span></span>
<span><span class="co">#&gt;  $ oxy : num  7.86 7.87 7.89 7.9 7.87 7.82 7.84 7.84 7.86 7.81 ...</span></span></code></pre></div>
<p>These data cannot be used in <code>respR</code> until this is
remedied. This shows the output when this dataset is checked using
<code>inspect</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Warning: inspect: Time column not numeric. Other column checks skipped. </span></span>
<span><span class="co">#&gt; Data cannot be analysed by respR functions if not numeric. </span></span>
<span><span class="co">#&gt; No output returned.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 time  oxy</span></span>
<span><span class="co">#&gt; numeric         WARN pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        skip pass</span></span>
<span><span class="co">#&gt; NA/NaN          skip pass</span></span>
<span><span class="co">#&gt; sequential      skip    -</span></span>
<span><span class="co">#&gt; duplicated      skip    -</span></span>
<span><span class="co">#&gt; evenly-spaced   skip    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="remedies">Remedies<a class="anchor" aria-label="anchor" href="#remedies"></a>
</h3>
<p>There are many ways to fix an issue such as this, from editing the
original file, to numerous potential solutions within <code>R</code>.
The easiest in this case is probably using <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric()</a></code>. On
data such as this it will parse the obviously numeric values to numeric,
and where it cannot, replace them with an <code>NA</code>.</p>
<p>The problem value is in position 50.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="fl">48</span><span class="op">:</span><span class="fl">52</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;    time  oxy</span></span>
<span><span class="co">#&gt; 48   48 7.63</span></span>
<span><span class="co">#&gt; 49   49 7.58</span></span>
<span><span class="co">#&gt; 50  --- 7.60</span></span>
<span><span class="co">#&gt; 51   51 7.60</span></span>
<span><span class="co">#&gt; 52   52 7.59</span></span></code></pre></div>
<p>We can try fixing the column with <code>as.numeric</code>, view the
same rows, and check the structure.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: NAs introduced by coercion</span></span>
<span></span>
<span><span class="va">df</span><span class="op">[</span><span class="fl">48</span><span class="op">:</span><span class="fl">52</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;    time  oxy</span></span>
<span><span class="co">#&gt; 48   48 7.63</span></span>
<span><span class="co">#&gt; 49   49 7.58</span></span>
<span><span class="co">#&gt; 50   NA 7.60</span></span>
<span><span class="co">#&gt; 51   51 7.60</span></span>
<span><span class="co">#&gt; 52   52 7.59</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    100 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ time: num  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ oxy : num  7.86 7.87 7.89 7.9 7.87 7.82 7.84 7.84 7.86 7.81 ...</span></span></code></pre></div>
<p>Now the column is numeric, but contains an <code>NA</code> value.
<code>respR</code> has been designed to work with <code>NA</code> values
in datasets, so analysing this one should not lead to any major issues.
<code>respR</code> relies on linear regressions on exact data values to
calculate rates, and <code>NA</code> values are simply ignored, so do
not affect slopes and therefore calculated rates, unless they occur over
large regions of the data.</p>
<p>However, we would strongly recommend that to be completely confident
in any results, and avoid obscure errors, <code>NA</code> values be
removed or replaced where possible before proceeding. Later checks in
<code>inspect</code> will identify locations of <code>NA</code> values
(see <a href="#nacheck">here</a>). In this case it is easy to fix, as it
is obvious what the missing value is.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="fl">50</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></code></pre></div>
<p>Now we can inspect again, and this time save the result.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 time  oxy</span></span>
<span><span class="co">#&gt; numeric         pass pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass pass</span></span>
<span><span class="co">#&gt; sequential      pass    -</span></span>
<span><span class="co">#&gt; duplicated      pass    -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="inspecting_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Now the saved object <code>insp</code> can be passed to functions
such as <code><a href="../reference/calc_rate.html">calc_rate()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="infcheck">Inf/-Inf<a class="anchor" aria-label="anchor" href="#infcheck"></a>
</h2>
<p>The next most important check is for infinite (or minus infinite)
values. Some oxygen sensing systems add these in error when interference
or data dropouts occur. Infinite values will cause problems when it
comes to calculating rates, so need to be removed.</p>
<div class="section level3">
<h3 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<p>This datasets contains an infinite oxygen value.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; Warning: inspect: Inf/-Inf values detected in Oxygen column(s). Remove or replace before proceeding.</span></span>
<span><span class="co">#&gt; inspect: Data issues detected. For more information use print().</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time Oxygen</span></span>
<span><span class="co">#&gt; numeric         pass   pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass   WARN</span></span>
<span><span class="co">#&gt; NA/NaN          pass   pass</span></span>
<span><span class="co">#&gt; sequential      pass      -</span></span>
<span><span class="co">#&gt; duplicated      pass      -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Inf/-Inf locations in Oxygen column: Oxygen </span></span>
<span><span class="co">#&gt; [1] 22</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>We can see a warning, and the output also lists the locations (row
numbers) of the <code>Inf</code> values (up to the first 20), and we can
use this to view it and check.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">[</span><span class="fl">20</span><span class="op">:</span><span class="fl">25</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;    Time Oxygen Temperature</span></span>
<span><span class="co">#&gt; 1:  520   95.3        15.1</span></span>
<span><span class="co">#&gt; 2:  521   95.0        15.0</span></span>
<span><span class="co">#&gt; 3:  522    Inf        15.1</span></span>
<span><span class="co">#&gt; 4:  523   95.2        15.1</span></span>
<span><span class="co">#&gt; 5:  524   95.2        15.1</span></span>
<span><span class="co">#&gt; 6:  525   95.3        15.1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inffix">Remedies<a class="anchor" aria-label="anchor" href="#inffix"></a>
</h3>
<p>Infinite values <strong>must</strong> be removed or replaced, or it
will severely affect rate calculations, and may have other unknown
effects in subsequent functions. Depending on how many, where they
occur, etc., the appropriate way to do this will vary. Here, we could
remove the row entirely, but since it is a single value we can just
replace it with an intermediate value which won’t affect rate
calculations.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">[</span><span class="fl">22</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="fl">21</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">data</span><span class="op">[</span><span class="fl">23</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">20</span><span class="op">:</span><span class="fl">25</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;    Time Oxygen Temperature</span></span>
<span><span class="co">#&gt; 1:  520   95.3        15.1</span></span>
<span><span class="co">#&gt; 2:  521   95.0        15.0</span></span>
<span><span class="co">#&gt; 3:  522   95.1        15.1</span></span>
<span><span class="co">#&gt; 4:  523   95.2        15.1</span></span>
<span><span class="co">#&gt; 5:  524   95.2        15.1</span></span>
<span><span class="co">#&gt; 6:  525   95.3        15.1</span></span>
<span></span>
<span><span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time Oxygen</span></span>
<span><span class="co">#&gt; numeric         pass   pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass   pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass   pass</span></span>
<span><span class="co">#&gt; sequential      pass      -</span></span>
<span><span class="co">#&gt; duplicated      pass      -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Now the saved object <code>insp</code> can be passed to functions
such as <code><a href="../reference/calc_rate.html">calc_rate()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="nacheck">NA/NaN<a class="anchor" aria-label="anchor" href="#nacheck"></a>
</h2>
<p>The third check is to look for missing data, that is <code>NA</code>
or <code>NaN</code> values. This is perhaps the most common issue
encountered when importing raw respirometry data files into
<code>R</code>. Many oxygen probe systems or computers struggle with
high recording frequencies, experience probe dropouts, suffer
interference, or other issues, and the typical practice is to fill the
resulting data gaps with <code>NA</code> or <code>NaN</code>.</p>
<p><code>respR</code> has been designed to work with <code>NA</code>
values in datasets, so analysing data with <code>NA/NaN</code> values
should not lead to any major issues, unless they occur over large
regions of the data. <code>respR</code> relies on linear regressions on
exact data values to calculate rates, and <code>NA/NaN</code> values are
simply ignored, so do not affect slopes and therefore calculated rates.
However, we would strongly recommend that to be completely confident in
any results, and avoid obscure errors, <code>NA/NaN</code> values be
removed or replaced where possible before proceeding.</p>
<p>If <code>inspect</code> finds <code>NA/NaN</code> data, it outputs
the locations (row numbers) to assist with removing or filling them.</p>
<div class="section level3">
<h3 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h3>
<p>This dataset has two columns of oxygen, one with a single
<code>NA</code> and one with a larger chunk of values missing.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">df</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 time oxy1 oxy2</span></span>
<span><span class="co">#&gt; numeric         pass pass pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass pass pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass WARN WARN</span></span>
<span><span class="co">#&gt; sequential      pass    -    -</span></span>
<span><span class="co">#&gt; duplicated      pass    -    -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass    -    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; NA/NaN locations in Oxygen column: oxy1 </span></span>
<span><span class="co">#&gt; [1] 23</span></span>
<span><span class="co">#&gt; NA/NaN locations in Oxygen column: oxy2 </span></span>
<span><span class="co">#&gt; [1] 57 58 59 60 61</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>The output console message gives a warning and prints the locations
(up to the first 20) of the missing values in the respective column.</p>
</div>
<div class="section level3">
<h3 id="remedies-1">Remedies<a class="anchor" aria-label="anchor" href="#remedies-1"></a>
</h3>
<p>The locations can also be found in the output object in the
<code>$locs</code> element with the name of the column.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insp</span><span class="op">$</span><span class="va">locs</span><span class="op">$</span><span class="va">oxy1</span><span class="op">$</span><span class="va">`NA/NaN`</span></span>
<span><span class="co">#&gt; [1] 23</span></span>
<span></span>
<span><span class="va">insp</span><span class="op">$</span><span class="va">locs</span><span class="op">$</span><span class="va">oxy2</span><span class="op">$</span><span class="va">`NA/NaN`</span></span>
<span><span class="co">#&gt; [1] 57 58 59 60 61</span></span></code></pre></div>
<p>These can be used to extract or fill the missing values, or simply
remove these rows. See above <a href="#inffix">example</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="seqcheck">Sequential Time<a class="anchor" aria-label="anchor" href="#seqcheck"></a>
</h2>
<p>This check is performed on the <code>time</code> column only.</p>
<p>Numeric time values are expected to be sequential, that is increasing
in value. A failure of this check could be an indication of problems
importing the file or of converting date-time values to numeric time
using <code><a href="../reference/format_time.html">format_time()</a></code> or other methods. This check helps flag
up that <em>something</em> might have occurred to make this happen on
import or processing, and might point to a larger problem that needs
investigating.</p>
<p>Non-sequential time values could cause unknown issues, so to be fully
confident in results and avoid obscure errors, we would strongly
recommend the data be amended to be sequential.</p>
<div class="section level3">
<h3 id="example-3">Example<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h3>
<p>This imported dataset contains time~oxygen data values, but no
numeric time.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Warning in import_file("zebrafish.csv"): NOTE: 'import_file' function has been deprecated, will not be updated, and will be removed in a future version of 'respR'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # import_file # -------------------------</span></span>
<span><span class="co">#&gt; Firesting-Pyro file detected</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt;          Time Comment Temperature Oxygen_Data_Ch_1</span></span>
<span><span class="co">#&gt;   1: 23:50:02      NA        13.5             9.79</span></span>
<span><span class="co">#&gt;   2: 23:50:04      NA        13.5             9.79</span></span>
<span><span class="co">#&gt;   3: 23:50:06      NA        13.5             9.79</span></span>
<span><span class="co">#&gt;   4: 23:50:08      NA        13.5             9.78</span></span>
<span><span class="co">#&gt;   5: 23:50:10      NA        13.5             9.79</span></span>
<span><span class="co">#&gt;  ---                                              </span></span>
<span><span class="co">#&gt; 490: 00:06:20      NA        13.5             9.56</span></span>
<span><span class="co">#&gt; 491: 00:06:22      NA        13.5             9.55</span></span>
<span><span class="co">#&gt; 492: 00:06:24      NA        13.5             9.55</span></span>
<span><span class="co">#&gt; 493: 00:06:26      NA        13.5             9.55</span></span>
<span><span class="co">#&gt; 494: 00:06:28      NA        13.5             9.54</span></span></code></pre>
<p>This is a small section of a real experiment where oxygen was
recorded every 2 seconds. Note how the Firesting-Pyro system has
exported times, <em>but not dates</em>, and that they cross over
midnight.</p>
<p>We will use the <code>lubridate()</code> package to convert the times
to numeric. The details are not that important, but briefly the times
are converted to a date-time format R understands, then an elapsed time
from the first entry is calculated.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parse to posix</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">parsed_time</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html" class="external-link">parse_date_time</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"HMS"</span><span class="op">)</span></span>
<span><span class="co"># convert to numeric difference in seconds from start</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">num_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, <span class="va">data</span><span class="op">[[</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">]</span><span class="op">]</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Time Comment Temperature Oxygen_Data_Ch_1         parsed_time num_time</span></span>
<span><span class="co">#&gt; 1: 23:50:02      NA        13.5             9.79 0000-01-01 23:50:02        0</span></span>
<span><span class="co">#&gt; 2: 23:50:04      NA        13.5             9.79 0000-01-01 23:50:04        2</span></span>
<span><span class="co">#&gt; 3: 23:50:06      NA        13.5             9.79 0000-01-01 23:50:06        4</span></span>
<span><span class="co">#&gt; 4: 23:50:08      NA        13.5             9.78 0000-01-01 23:50:08        6</span></span>
<span><span class="co">#&gt; 5: 23:50:10      NA        13.5             9.79 0000-01-01 23:50:10        8</span></span>
<span><span class="co">#&gt; 6: 23:50:12      NA        13.5             9.78 0000-01-01 23:50:12       10</span></span></code></pre></div>
<p>Now we inspect the data using the new numeric time</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data</span>, time <span class="op">=</span> <span class="fl">6</span>, oxygen <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: inspect: Non-sequential Time values found.</span></span>
<span><span class="co">#&gt; Warning: inspect: Time values are not evenly-spaced (numerically).</span></span>
<span><span class="co">#&gt; inspect: Data issues detected. For more information use print().</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 num_time Oxygen_Data_Ch_1</span></span>
<span><span class="co">#&gt; numeric             pass             pass</span></span>
<span><span class="co">#&gt; Inf/-Inf            pass             pass</span></span>
<span><span class="co">#&gt; NA/NaN              pass             pass</span></span>
<span><span class="co">#&gt; sequential          WARN                -</span></span>
<span><span class="co">#&gt; duplicated          pass                -</span></span>
<span><span class="co">#&gt; evenly-spaced       WARN                -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-sequential Time data locations in column: num_time </span></span>
<span><span class="co">#&gt; [1] 299</span></span>
<span><span class="co">#&gt; Uneven Time data locations in column: num_time </span></span>
<span><span class="co">#&gt; [1] 299</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] -86398      2</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Clearly there is something wrong, and the location where
non-sequential time data has been found is row 299. The issue has also
caused the evenly-spaced time check (see <a href="#evencheck">here</a>)
to fail, which we will cover later. Often the same issue will cause more
than one check to fail.</p>
<p>If we look at this region, it is clear what the problem is.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">[</span><span class="fl">297</span><span class="op">:</span><span class="fl">302</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;        Time Comment Temperature Oxygen_Data_Ch_1         parsed_time num_time</span></span>
<span><span class="co">#&gt; 1: 23:59:54      NA        13.6             9.99 0000-01-01 23:59:54      592</span></span>
<span><span class="co">#&gt; 2: 23:59:56      NA        13.6             9.98 0000-01-01 23:59:56      594</span></span>
<span><span class="co">#&gt; 3: 23:59:58      NA        13.5             9.99 0000-01-01 23:59:58      596</span></span>
<span><span class="co">#&gt; 4: 00:00:00      NA        13.6             9.99 0000-01-01 00:00:00   -85802</span></span>
<span><span class="co">#&gt; 5: 00:00:02      NA        13.6             9.99 0000-01-01 00:00:02   -85800</span></span>
<span><span class="co">#&gt; 6: 00:00:04      NA        13.6            10.00 0000-01-01 00:00:04   -85798</span></span></code></pre></div>
<p>Where times have crossed midnight, our code has failed to parse it
correctly. The lack of dates along with times means we have incorrectly
calculated the elapsed time.</p>
</div>
<div class="section level3">
<h3 id="remedies-2">Remedies<a class="anchor" aria-label="anchor" href="#remedies-2"></a>
</h3>
<p>If this particular issue is detected, it is usually an indication of
a deeper problem, so the actual remedy will depend on the situation,
from editing the original data file, to various solutions within R, such
as reordering rows.</p>
<p>Here, we can simply use the <code>respR</code> function
<code><a href="../reference/format_time.html">format_time()</a></code> (see also
<code><a href="../articles/format_time.html">vignette("format_time")</a></code>), which has been designed to detect
and fix this specific problem of times which cross midnight but have no
date attached. <code>format_time</code> parses and converts the times to
numeric and adds them as a new column.</p>
<pre><code><span><span class="co">#&gt; Warning in import_file("zebrafish.csv"): NOTE: 'import_file' function has been deprecated, will not be updated, and will be removed in a future version of 'respR'.</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_time.html">format_time</a></span><span class="op">(</span><span class="va">data</span>, time <span class="op">=</span> <span class="fl">1</span>, format <span class="op">=</span> <span class="st">"HMS"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Times cross midnight, attempting to parse correctly...</span></span>
<span></span>
<span><span class="va">data</span><span class="op">[</span><span class="fl">297</span><span class="op">:</span><span class="fl">302</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;        Time Comment Temperature Oxygen_Data_Ch_1 time_num</span></span>
<span><span class="co">#&gt; 1: 23:59:54      NA        13.6             9.99      593</span></span>
<span><span class="co">#&gt; 2: 23:59:56      NA        13.6             9.98      595</span></span>
<span><span class="co">#&gt; 3: 23:59:58      NA        13.5             9.99      597</span></span>
<span><span class="co">#&gt; 4: 00:00:00      NA        13.6             9.99      599</span></span>
<span><span class="co">#&gt; 5: 00:00:02      NA        13.6             9.99      601</span></span>
<span><span class="co">#&gt; 6: 00:00:04      NA        13.6            10.00      603</span></span></code></pre></div>
<p>If we <code>inspect</code> again, the problem is fixed.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data</span>, time <span class="op">=</span> <span class="fl">5</span>, oxygen <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 time_num Oxygen_Data_Ch_1</span></span>
<span><span class="co">#&gt; numeric             pass             pass</span></span>
<span><span class="co">#&gt; Inf/-Inf            pass             pass</span></span>
<span><span class="co">#&gt; NA/NaN              pass             pass</span></span>
<span><span class="co">#&gt; sequential          pass                -</span></span>
<span><span class="co">#&gt; duplicated          pass                -</span></span>
<span><span class="co">#&gt; evenly-spaced       pass                -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="duplicate-time">Duplicate Time<a class="anchor" aria-label="anchor" href="#duplicate-time"></a>
</h2>
<p>This check is performed on the <code>time</code> column only.</p>
<p>Duplicate time values can result from rounding time values, or the
system accidentally recording two values close together, or some other
issues causing values to be repeated or duplicated.</p>
<p>This warning is not necessarily a major issue. <code>respR</code>
relies on linear regressions on time~oxygen paired data values to
calculate rates. When fitting linear regressions, duplicates will not
affect results so as long as the data are genuine values. However, the
check flags up that <em>something</em> might have occurred to make this
happen on import or processing, and might point to a larger problem.</p>
<div class="section level3">
<h3 id="example-1-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1-1"></a>
</h3>
<p>This dataset has been recorded at approximately 1 second intervals,
but at 0.1s precision, and when rounded to the nearest second this leads
to lots of duplicated values.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## original data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_orig</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   times  oxy</span></span>
<span><span class="co">#&gt; 1   1.1 7.20</span></span>
<span><span class="co">#&gt; 2   2.5 7.21</span></span>
<span><span class="co">#&gt; 3   4.0 7.15</span></span>
<span><span class="co">#&gt; 4   5.0 7.13</span></span>
<span><span class="co">#&gt; 5   5.8 7.18</span></span>
<span></span>
<span><span class="co">## Before rounding</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_orig</span><span class="op">$</span><span class="va">times</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]  1.1  2.5  4.0  5.0  5.8  6.7  7.8  8.0  9.9 11.0</span></span>
<span><span class="co">## After rounding to nearest second</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_round</span><span class="op">$</span><span class="va">times</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]  1  2  4  5  6  7  8  8 10 11</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data_round</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 times  oxy</span></span>
<span><span class="co">#&gt; numeric          pass pass</span></span>
<span><span class="co">#&gt; Inf/-Inf         pass pass</span></span>
<span><span class="co">#&gt; NA/NaN           pass pass</span></span>
<span><span class="co">#&gt; sequential       pass    -</span></span>
<span><span class="co">#&gt; duplicated       WARN    -</span></span>
<span><span class="co">#&gt; evenly-spaced    WARN    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Duplicate Time data locations (first 20 shown) in column: times </span></span>
<span><span class="co">#&gt;  [1]  7  8 11 12 17 18 19 20 22 23 29 30 31 32 36 37 39 40 42 43</span></span>
<span><span class="co">#&gt; Uneven Time data locations (first 20 shown) in column: times </span></span>
<span><span class="co">#&gt;  [1]  2  7  8 11 13 17 18 19 21 22 23 29 30 31 34 36 37 39 40 42</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] 0 2</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="remedies-3">Remedies<a class="anchor" aria-label="anchor" href="#remedies-3"></a>
</h3>
<p>In this case, <code>inspect</code> produces a duplicate times
warning, however it can be safely ignored. These values are perfectly
valid at this precision, and when it comes to fitting linear regressions
and calculating rates will not realistically affect rate calculations.
However, an alternative option would be to not round the times at all;
<code>respR</code> will happily accept any form of numeric decimalised
time value.</p>
</div>
<div class="section level3">
<h3 id="example-2-1">Example 2<a class="anchor" aria-label="anchor" href="#example-2-1"></a>
</h3>
<p>This dataset by contrast contains several duplicated rows. The
<code>inspect</code> call detects and identifies these, allowing them to
be checked or amended.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time Oxygen</span></span>
<span><span class="co">#&gt; numeric         pass   pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass   pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass   pass</span></span>
<span><span class="co">#&gt; sequential      pass      -</span></span>
<span><span class="co">#&gt; duplicated      WARN      -</span></span>
<span><span class="co">#&gt; evenly-spaced   WARN      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Duplicate Time data locations in column: Time </span></span>
<span><span class="co">#&gt;  [1] 101 102 103 104 105 106 107 108 109 110</span></span>
<span><span class="co">#&gt; Uneven Time data locations in column: Time </span></span>
<span><span class="co">#&gt; [1] 101 102 103 104 105 106 107 108 109</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] 0 1</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>We can check these rows by extracting the relevant locations from the
<code>$locs</code> element of the saved output, and we see that for some
reason the row has been duplicated.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dupes</span> <span class="op">&lt;-</span> <span class="va">insp</span><span class="op">$</span><span class="va">locs</span><span class="op">$</span><span class="va">Time</span><span class="op">$</span><span class="va">duplicated</span></span>
<span></span>
<span><span class="va">data</span><span class="op">[</span><span class="va">dupes</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;     Time Oxygen Temperature</span></span>
<span><span class="co">#&gt;  1: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  2: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  3: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  4: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  5: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  6: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  7: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  8: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt;  9: 2100   93.7        14.5</span></span>
<span><span class="co">#&gt; 10: 2100   93.7        14.5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="remedies-4">Remedies<a class="anchor" aria-label="anchor" href="#remedies-4"></a>
</h3>
<p>Like other checks, if or how to amend this issue will depend on the
situation. Here, these duplicate rows could affect rate calculations, if
for instance we are determining rates over a specific row width across
the dataset (by contrast a rate using a <code>time</code> width would be
unaffected). They could also affect other reported outputs such as the
r-squared. It’s probably easiest to just remove them, and
<code>inspect</code> the data again.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Remove all but the first duplicate row</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="va">dupes</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">## inspect again</span></span>
<span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time Oxygen</span></span>
<span><span class="co">#&gt; numeric         pass   pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass   pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass   pass</span></span>
<span><span class="co">#&gt; sequential      pass      -</span></span>
<span><span class="co">#&gt; duplicated      pass      -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="evencheck">Evenly Spaced Time<a class="anchor" aria-label="anchor" href="#evencheck"></a>
</h2>
<p>Depending on the time metric, this is perhaps the most frequently
seen warning. Generally, respirometry data are recorded at regular
intervals. Any irregular intervals between time values are an indication
that something might have gone wrong: the system stopped recording for a
period, some data were lost when imported, rows were removed
accidentally, or some other reason. The purpose of this check is to find
and report any such gaps in the data. If these are found, the locations
are returned, and in addition the maximum and minimum intervals in the
time data.</p>
<div class="section level3">
<h3 id="example-1-2">Example 1<a class="anchor" aria-label="anchor" href="#example-1-2"></a>
</h3>
<p>One reason this check might produce warnings is through use of a
metric such as decimalised minutes. For example, data recorded once per
second, but converted to minutes is used in the
<code>flowthrough_mult.rd</code> example data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># seconds in decimal minutes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.02 0.03 0.05 0.07 0.08 0.10</span></span>
<span></span>
<span><span class="co"># difference between each value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01 0.02 0.02 0.01 0.02</span></span></code></pre></div>
<p>These have been converted to minutes and rounded, and we can see the
intervals are not numerically consistent. This will cause this check to
produce a warning in <code>inspect</code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; Warning: inspect: Time values are not evenly-spaced (numerically).</span></span>
<span><span class="co">#&gt; inspect: Data issues detected. For more information use print().</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 num.time oxy.out.1</span></span>
<span><span class="co">#&gt; numeric             pass      pass</span></span>
<span><span class="co">#&gt; Inf/-Inf            pass      pass</span></span>
<span><span class="co">#&gt; NA/NaN              pass      pass</span></span>
<span><span class="co">#&gt; sequential          pass         -</span></span>
<span><span class="co">#&gt; duplicated          pass         -</span></span>
<span><span class="co">#&gt; evenly-spaced       WARN         -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uneven Time data locations (first 20 shown) in column: num.time </span></span>
<span><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] 0.01 0.02</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="remedies-5">Remedies<a class="anchor" aria-label="anchor" href="#remedies-5"></a>
</h3>
<p>While there are too many locations printed here to get a handle on if
there are <em>actual</em> gaps in the data, the additional print out of
the minimum and maximum time intervals tells us the intervals are what
we would expect with these time values, so in the case of these data
they are fine to pass to subsequent functions.</p>
</div>
<div class="section level3">
<h3 id="example-2-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2-2"></a>
</h3>
<p>If there were a larger time gap in the data, this check would flag it
up. This dataset is missing a large number of rows.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time   O2</span></span>
<span><span class="co">#&gt; numeric         pass pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass pass</span></span>
<span><span class="co">#&gt; sequential      pass    -</span></span>
<span><span class="co">#&gt; duplicated      pass    -</span></span>
<span><span class="co">#&gt; evenly-spaced   WARN    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uneven Time data locations in column: Time </span></span>
<span><span class="co">#&gt; [1] 341</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1]  1 47</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="inspecting_files/figure-html/unnamed-chunk-42-1.png" width="960" style="display: block; margin: auto;"></p>
<p>While there is only one time gap location at row 341, we can see this
is a large gap of 47 seconds.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">[</span><span class="fl">340</span><span class="op">:</span><span class="fl">344</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    Time   O2</span></span>
<span><span class="co">#&gt; 1:  340 6.94</span></span>
<span><span class="co">#&gt; 2:  341 6.96</span></span>
<span><span class="co">#&gt; 3:  388 6.90</span></span>
<span><span class="co">#&gt; 4:  389 6.90</span></span>
<span><span class="co">#&gt; 5:  390 6.90</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="remedies-6">Remedies<a class="anchor" aria-label="anchor" href="#remedies-6"></a>
</h3>
<p>Like many of the issues, if or how to fix this depends on the
context. In this case it may have been an accidental deletion or
importing problem. However, you can still calculate rates across these
gaps, which will be perfectly reportable, as long as care is taken to
understand the implications of doing this.</p>
</div>
<div class="section level3">
<h3 id="calculating-rates-across-gaps">Calculating rates across gaps<a class="anchor" aria-label="anchor" href="#calculating-rates-across-gaps"></a>
</h3>
<p><code><a href="../reference/calc_rate.html">calc_rate()</a></code> allows you to calculate a rate using a
<code>"row"</code> or <code>"time"</code> interval. In this dataset,
because the time is in seconds and recording interval once per second,
they are therefore equivalent to the row numbers. Any rates calculated
in a complete region of the data before the gap will be identical for
either method.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cr_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">100</span>, <span class="fl">300</span>, <span class="st">"row"</span><span class="op">)</span></span>
<span><span class="va">cr_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">100</span>, <span class="fl">300</span>, <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr_row</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq row endrow time endtime  oxy endoxy rate.2pt      rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         7.14 -0.000489 0.645 100    300  100     300 7.08   6.98  -0.0005 -0.000489</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr_time</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq row endrow time endtime  oxy endoxy rate.2pt      rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         7.14 -0.000489 0.645 100    300  100     300 7.08   6.98  -0.0005 -0.000489</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>This will not be the case across the gap, or <em>after</em> it where
row numbers will now <em>not</em> be equivalent to the time values.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cr_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="st">"row"</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-46-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cr_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-46-2.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr_row</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq row endrow time endtime  oxy endoxy  rate.2pt      rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         7.19 -0.000712 0.879 200    400  200     446 7.05   6.87 -0.000732 -0.000712</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cr_time</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq row endrow time endtime  oxy endoxy rate.2pt      rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         7.18 -0.000676 0.719 200    354  200     400 7.05   6.89  -0.0008 -0.000676</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Note how the interval is correct in the respective metric, but now
differs in the other.</p>
<p>Either of these is reportable depending on the research question or
rate determination criteria, and a ‘correct’ rate in their own right. If
however, for example, you want to report a rate across a consistent time
window, the <code>by = "row"</code> result, while an accurate rate for
that row interval, does not conform to the expected time window.</p>
<p>Such gaps may also affect rolling rate determinations, such as in the
<code><a href="../reference/auto_rate.html">auto_rate()</a></code> function, if done using
<code>by = "row"</code>.</p>
<p>Note also, because of the missing rows, all rows <em>after</em> the
gap will not conform to the same time values, although as long as they
don’t include the gap will represent an equivalent time
<em>window</em>.</p>
</div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>When using <code>inspect</code>, a plot of the inspected data is
produced (unless <code>plot = FALSE</code>), against both time (bottom
blue axis) and row index (top red axis).</p>
<p>The top plot is the complete timeseries of oxygen against time. The
bottom plot is a rolling regression plot. This shows the rate of change
in oxygen across a rolling window specified using the <code>width</code>
operator (default is <code>width = 0.1</code>, or 10% of the entire
dataset). Each rate value is plotted against the centre of the time
window used to calculate it. This plot provides a quick visual
inspection of how the rate varies over the course of the experiment.
Regions of stable and consistent rates can be identified on this plot as
flat or level areas. This plot is for exploratory purposes only; later
functions allow rate to be calculated over specific regions.</p>
<p>Note, that because <code>respR</code> is primarily used to examine
oxygen consumption, the rolling rate plot is plotted on a reverse
y-axis. In <code>respR</code> oxygen uptake rates are negative since
they represent a negative slope of oxygen against time. In rolling rate
plots, by default the axis is reversed so that higher uptake rates
(e.g. maximum or active rates) will be higher on these plots. If you are
interested instead in oxygen production rates, which are positive, the
<code>rate.rev = FALSE</code> input can be passed in either the
<code>inspect</code> call, or when using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the
output object. In this case, the rate values will be plotted not
reversed, with higher oxygen <em>production</em> rates higher on the
plot.</p>
<div class="section level3">
<h3 id="rolling-rate-plot">Rolling rate plot<a class="anchor" aria-label="anchor" href="#rolling-rate-plot"></a>
</h3>
<p>Some datasets may benefit from changing the <code>width</code> to get
a better idea of how the rate fluctuates across the data. This is
helpful to inform the regions from which to extract rates in later
functions, as well as an appropriate time or row window to use when
extracting rates.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## default width of 10%</span></span>
<span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">sardine.rd</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-48-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In these data, after an initial unstable period rates seem to
stabilise, but there is still a lot of variability, with rates
fluctuating between around -0.0006 and -0.0008.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## width of 20%</span></span>
<span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">sardine.rd</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-49-1.png" width="960" style="display: block; margin: auto;"></p>
<p>With a higher <code>width</code> rates after the initial period are
much more stable. This tells us (presuming we are interested in routine
rates) that we probably want to extract rates from after timepoint 2000,
should not use a time window shorter than around 20% of the total data
length, and that our extracted rate should be around -0.0007.</p>
<p>If we are interested in the very lowest rate, it seems to occur just
before timepoint 6000 (although see <code><a href="../reference/auto_rate.html">auto_rate()</a></code> for
extracting the lowest rates).</p>
</div>
<div class="section level3">
<h3 id="intermittent-flow-data">Intermittent-flow data<a class="anchor" aria-label="anchor" href="#intermittent-flow-data"></a>
</h3>
<p>Note, intermittent-flow data will include rates across flush periods,
which can skew results, and possibly make the output difficult to
interpret.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">intermittent.rd</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-50-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here the flushes skew the rolling rates, but within each replicate
rates seem to be a consistent value of around -0.0005.</p>
<p>However, you can always use <code>inspect</code> without saving the
result for a closer look at regions of the data, though note the
<code>width</code> input will apply to the subset, not the original data
length.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">intermittent.rd</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1800</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-51-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="inspect-portions-of-long-experiments">Inspect portions of long experiments<a class="anchor" aria-label="anchor" href="#inspect-portions-of-long-experiments"></a>
</h3>
<p>For really long experiments, both the timeseries and rolling rate
plot may be difficult to interpret. This experiment on a zebra fish is
22h long and nearly 80000 rows.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-52-1.png" width="960" style="display: block; margin: auto;"></p>
<p><code>inspect</code> can be used without saving the result for a
closer look at smaller regions of the data, to better see what is going
on.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span><span class="op">[</span><span class="fl">20000</span><span class="op">:</span><span class="fl">24000</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-53-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This better shows us the structure of this intermittent-flow
experiment. Within these replicates specimen rates appear to be
consistent at around -0.002, but note this may not be accurate because
the rolling rate window might include the flush which will skew rate
values. When subset like this, the <code>width</code> operator refers to
the length of the subset not the original data.</p>
</div>
<div class="section level3">
<h3 id="multiple-columns-of-oxygen-data">Multiple columns of oxygen data<a class="anchor" aria-label="anchor" href="#multiple-columns-of-oxygen-data"></a>
</h3>
<p>For a quick overview of larger datasets, multiple oxygen columns can
be inspected by using the <code>oxygen</code> input to select multiple
columns. These must share the same <code>time</code> column. In this
case, data checks are performed, with a plot of each oxygen time series,
but no rolling rate plot is produced. All data are plotted on the same
axis range of both time and oxygen (total range of data).</p>
<p>This is chiefly exploratory functionality to allow for a quick
overview of a dataset. Note, that if it is saved the output
<code>inspect</code> object will contain all columns in its
<code>$dataframe</code> element, but subsequent functions in
<code>respR</code> (<code>calc_rate</code>, <code>auto_rate</code>,
etc.) will by default only use the <em>first two</em> columns
(<code>time</code>, and the first specified <code>oxygen</code> column).
To analyse and determine rates from different columns, best practice is
to inspect and assign each time-oxygen column pair as separate
<code>inspect</code> objects.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-54-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This gives us a quick visual overview of the dataset, allowing us to,
for example, see the experiments which have some sort of issues, and
which are controls (the last two here).</p>
</div>
<div class="section level3">
<h3 id="plot-an-additional-data-type">Plot an additional data type<a class="anchor" aria-label="anchor" href="#plot-an-additional-data-type"></a>
</h3>
<p>By using the <code>add.data</code> input an additional data source
(for example temperature) can be plotted in alongside the oxygen
timeseries to help with understanding where rates may or may not have
fluctuated. This input indicates a column number in the same input data
frame sharing the same time data. This column is not passed through the
above checks. It is a visual aid only to help with selection of regions
from which to extract rates.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot column 4 (temperature) alongside oxygen timeseries</span></span>
<span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">sardine.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">2</span>, add.data <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-55-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="additional-plotting-options">Additional plotting options<a class="anchor" aria-label="anchor" href="#additional-plotting-options"></a>
</h3>
<p>Additional plotting controls can be passed in either the main
<code>inspect</code> call or when using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on the
output object.</p>
<p>Most notable is <code>rate.rev = FALSE</code>. This means rates in
the rolling rate plot will be plotted on a normal y-axis, that is not
reversed. This allows oxygen production rates to be plotted correctly,
with higher rates appearing higher on the plot.</p>
<p>If axis labels obscure parts of the plot they can be suppressed using
<code>legend = FALSE</code>. Console output messages can be suppressed
with <code>quiet = TRUE</code> (in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> only). Lastly, a
different <code>width</code> value can be passed to see how it affects
the rolling rate plot.</p>
<p>In addition, the generic <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> inputs <code>oma</code>,
<code>mai</code>, <code>tck</code>, <code>mgp</code>, <code>las</code>,
and <code>pch</code> are accepted via <code>...</code> to allow default
parameters to be changed. Particularly useful are <code>las = 1</code>
to make axis labels horizontal and adjusting the second (left side) of
the four <code>mai</code> (inner margins) input to make y-axis labels
more readable.</p>
<p>This example examining oxygen production in algae uses some of these
options.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">algae.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">2</span>, width <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>        legend <span class="op">=</span> <span class="cn">FALSE</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>        las <span class="op">=</span> <span class="fl">1</span>, mai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="inspecting_files/figure-html/unnamed-chunk-56-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
