<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>select_rate: Exploring and filtering results • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="select_rate: Exploring and filtering results">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>select_rate: Exploring and filtering
results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/select_rate.Rmd" class="external-link"><code>vignettes/select_rate.Rmd</code></a></small>
      <div class="hidden name"><code>select_rate.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="adjintro">Introduction<a class="anchor" aria-label="anchor" href="#adjintro"></a>
</h2>
<p>Depending on the type of experiment or the functions used,
<code>respR</code> analyses can return multiple rates from a single
dataset. Once these are converted to final units in
<code><a href="../reference/convert_rate.html">convert_rate()</a></code> this can result in an often large array of
rates from different or even overlapping regions of the data.</p>
<p>Multiple rates can be a result of several analyses. The
<code><a href="../reference/auto_rate.html">auto_rate()</a></code> function uses machine learning techniques to
automatically detect the most linear regions of a dataset, as well as
being able to fit a rolling regression of a specified width over the
entire dataset and order the results in various ways. Both of these can
return hundreds to thousands of rates. <code><a href="../reference/calc_rate.html">calc_rate()</a></code> can also
return multiple rates depending on the inputs.
<code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code> and <code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code> return a
single rate from every replicate in an intermittent-flow respirometry
dataset, so there will be at least as many rates as there are
replicates.</p>
<p><code>select_rate</code> helps explore and filter
<code>convert_rate</code> results by selecting rates according to
various criteria. For example, extracting only positive or negative
rates, only the highest or lowest rates by number or percentile, those
above a particular R-squared, only those from certain data regions, and
numerous other methods that allow advanced filtering of rates. This
allows for application of consistent rate selection criteria and
reporting of results. Several methods also allow the results to be
reordered by that metric, which can be useful in several situations.</p>
<div class="section level3">
<h3 id="flowthrough-analyses">Flowthrough analyses<a class="anchor" aria-label="anchor" href="#flowthrough-analyses"></a>
</h3>
<p><code>select_rate</code> can also select from multiple rates in
<code>convert_rate.ft</code> objects from flowthrough analyses. There is
also a <code>select_rate.ft</code> function but it is a simple wrapper
for <code>select_rate</code>. Therefore the following examples also
apply to filtering flowthrough results, but see
<code><a href="../articles/flowthrough.html">vignette("flowthrough")</a></code> for some specific examples.</p>
</div>
</div>
<div class="section level2">
<h2 id="selection-methods">Selection methods<a class="anchor" aria-label="anchor" href="#selection-methods"></a>
</h2>
<p>The function includes a wide array of criteria by which
<code>convert_rate</code> results can be filtered. The full list can be
seen in the <a href="https://januarharianto.github.io/respR/reference/select_rate.html#details-1">Details</a>
section of the help file. We will run through a few specific examples
below. Multiple selection criteria can be applied by saving the output
and processing it through the function multiple times with different
criteria, or alternatively via piping (<code>%&gt;%</code> or
<code>|&gt;</code>). See examples.</p>
</div>
<div class="section level2">
<h2 id="rankcol">Rep and rank columns<a class="anchor" aria-label="anchor" href="#rankcol"></a>
</h2>
<p>For most selection operations, the summary table <code>$rank</code>
column is important in keeping track of results. The <code>$rank</code>
column is context-specific, and what it represents depends on the type
of experiment analysed or the function used to determine the rates. If
numeric values were converted, it is the order in which they were
entered. Similarly, if <code>calc_rate</code> was used to determine
multiple rates, it is the order as entered using <code>from</code> and
<code>to</code>. For <code>auto_rate</code> it relates to the
<code>method</code> input. For example it indicates the kernel density
ranking if the <code>linear</code> method was used, the ascending or
descending ordering by absolute rate value if <code>lowest</code> or
<code>highest</code> were used, or numerical order if
<code>minimum</code> or <code>maximum</code> were used. For
intermittent-flow experiments analysed via <code>calc_rate.int</code> or
<code>auto_rate.int</code> it indicates the ranking <em>within</em> each
replicate in the <code>$rep</code> column (though since usually these
only return a single rate per replicate it is usually filled with the
value <code>1</code>).</p>
<p>Therefore the <code>$rep</code> and <code>$rank</code> columns can be
used to keep track of selections or reordering because the original
values will be retained unchanged through these operations. The original
order can always be restored by using
<code>method = "rep", n = NULL</code> or
<code>method = "rank", n = NULL</code>, in which case the table will be
reordered by <code>$rep</code> then <code>$rank</code>.</p>
</div>
<div class="section level2">
<h2 id="plotconv">Plot<a class="anchor" aria-label="anchor" href="#plotconv"></a>
</h2>
<p>As of <a href="https://januarharianto.github.io/respR/articles/release_notes.html">v2.1</a>,
<code>convert_rate</code> has new plotting functionality that helps
explore the results and view the result of selection or reordering.
Either pass <code>plot = TRUE</code> in the <code>convert_rate</code>
call (default is <code>FALSE</code>), or alternatively the output object
can be passed or piped to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> after processing in
<code>select_rate</code>.</p>
<p>There are three ways of plotting the results:</p>
<div class="section level3">
<h3 id="type-full">
<code>type = "full"</code><a class="anchor" aria-label="anchor" href="#type-full"></a>
</h3>
<p>The default is <code>type = "full"</code>, which plots each rate
(summary table row) in order in the context of the entire data
timeseries up to a maximum of 20. These can be selected using
<code>pos</code>, which represents rows of the summary table with the
default being <code>pos = 1:20</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sard</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This lets you see where each rate occurs within the dataset, and the
converted rate value is in the title. The values on the axes - time
(bottom), row (top), and oxygen (left) - are in the units of the
original raw data.</p>
</div>
<div class="section level3">
<h3 id="type-rate">
<code>type = "rate"</code><a class="anchor" aria-label="anchor" href="#type-rate"></a>
</h3>
<p>This plots the entire data timeseries on the upper plot, and on the
lower plot the output rate values in the chosen output units. Each rate
is plotted against the middle of the region used to determine it.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sard</span>, type <span class="op">=</span> <span class="st">"rate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This lets you see how the rate varies across the dataset and decide
how to filter the results. Here for example, rates are higher at the
start of the experiment, and stable low rates only occur after around
timepoint 2000.</p>
</div>
<div class="section level3">
<h3 id="type-overlap">
<code>type = "overlap"</code><a class="anchor" aria-label="anchor" href="#type-overlap"></a>
</h3>
<p>This plot helps with understanding how rates are distributed across
the dataset, particularly the data region each uses and how they may
overlap. The top plot is the entire data timeseries. In the lower plot
every rate regression in <code>$summary</code> is represented by a line
showing its location within the timeseries. The y-axis represents the
position (i.e. row) of the summary table descending from top to bottom.
If no reordering or selection has been performed, this will be
equivalent to the <code>$rep</code> or <code>$rank</code> column. See <a href="#rankcol">above section</a> for what these may represent, but note
as reordering or selection is performed rank and summary table position
will not necessarily be equivalent.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sard</span>, type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here we have analysed the data using the <code>auto_rate</code>
<code>"linear"</code> method, and we can see many of the results are
from similar or essentially equivalent regions of the data. See below
for how these may be reduced.</p>
</div>
<div class="section level3">
<h3 id="additional-options">Additional options<a class="anchor" aria-label="anchor" href="#additional-options"></a>
</h3>
<p>Additional inputs can be passed, such as <code>pos</code>,
<code>quiet</code>, <code>legend</code>, and <code>highlight</code>. See
<code><a href="../reference/select_rate.html">help("select_rate")</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>These are brief run-throughs of a few example selection or reordering
operations. More practical examples can be seen in
<code><a href="../articles/intermittent_long.html">vignette("intermittent_long")</a></code>. These are not
recommendations for how you should conduct your own analyses, or for
what selection criteria are appropriate for particular datasets, they
are simply examples to demonstrate the functionality.</p>
</div>
<div class="section level2">
<h2 id="auto_rate-linear-results">1. <code>auto_rate</code> <code>"linear"</code> results<a class="anchor" aria-label="anchor" href="#auto_rate-linear-results"></a>
</h2>
<p>Generally speaking the <code>linear</code> method is very good at
identifying linear regions, and typically the top result is the most
appropriate to report. However, it depends on the aims of your
experiment and there may be situations where we would want to further
refine the returned results.</p>
<p>We’ll use the <code>sardine.rd</code> dataset, and let’s say we are
interested in extracting a standard metabolic rate (SMR), that is a
basal or maintenance rate. Generally this is the lowest rate observed,
and usually that requires defining the duration over which the rate is
sustained when we extract it, and how to choose this duration is
arguably not objective. The <code>linear</code> method has a benefit
here, in that it will identify consistently maintained rates, including
the lowest consistently maintained rates. However, it will also identify
all consistently maintained rates in the dataset, so the lowest is not
necessarily the top-ranked one.</p>
<p>We’ll <code>inspect</code> the data, pipe the result to
<code>auto_rate</code> using the default inputs of the
<code>"linear"</code> method and <code>width = 0.2</code>, then adjust
the rates for background (using an invented value as an example), then
convert the rates to our final units.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">sardine.rd</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="op">-</span><span class="fl">0.00006</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,</span>
<span>               time.unit <span class="op">=</span> <span class="st">"sec"</span>,</span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/kg"</span>,</span>
<span>               volume <span class="op">=</span> <span class="fl">12.3</span>,</span>
<span>               mass <span class="op">=</span> <span class="fl">0.0477</span>,</span>
<span>               S <span class="op">=</span> <span class="fl">35</span>, </span>
<span>               t <span class="op">=</span> <span class="fl">14.8</span>,</span>
<span>               p <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span> </span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This is large dataset, from a relatively long experiment of over 2
hours. The <code>auto_rate</code> analysis has identified 39 linear
regions, of which the above plot is the highest ranked one, or most
linear according to the kernel density analysis. This does not mean it’s
the lowest rate, but is generally the most consistently maintained
one.</p>
<p>Let’s look at the <code>convert_rate</code> summary table, which
contains all rate regression parameters and data locations, adjustments
(if applied), units, and more.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">sard</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;  1:  NA    1         94.9 -0.000661 0.982   19082 3659   6736 3658    6735 92.6   90.4 -0.000661   -0.00006     -0.000601  -0.000601     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.17       -45.5          NA  mgO2/hr/kg       -45.5</span></span>
<span><span class="co">#&gt;  2:  NA    2         95.1 -0.000688 0.986   17476 2242   5543 2241    5542 93.7   91.2 -0.000688   -0.00006     -0.000628  -0.000628     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.27       -47.5          NA  mgO2/hr/kg       -47.5</span></span>
<span><span class="co">#&gt;  3:  NA    3         94.9 -0.000662 0.987   15982 3628   7164 3627    7163 92.5   90.2 -0.000662   -0.00006     -0.000602  -0.000602     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.17       -45.6          NA  mgO2/hr/kg       -45.6</span></span>
<span><span class="co">#&gt;  4:  NA    4         95.1 -0.000708 0.979    9211 1578   4236 1577    4235 94.2   92.2 -0.000708   -0.00006     -0.000648  -0.000648     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.34       -49.1          NA  mgO2/hr/kg       -49.1</span></span>
<span><span class="co">#&gt;  5:  NA    5         95.1 -0.000706 0.971    7562 1947   4236 1946    4235 93.8   92.2 -0.000706   -0.00006     -0.000646  -0.000646     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.33       -48.9          NA  mgO2/hr/kg       -48.9</span></span>
<span><span class="co">#&gt;  6:  NA    6         95.7 -0.001047 0.961    6865  601   1969  600    1968 95.1   93.7 -0.001047   -0.00006     -0.000987  -0.000987     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.56       -74.7          NA  mgO2/hr/kg       -74.7</span></span>
<span><span class="co">#&gt;  7:  NA    7         95.1 -0.000709 0.978    6399 1578   4196 1577    4195 94.2   92.2 -0.000709   -0.00006     -0.000649  -0.000649     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.34       -49.1          NA  mgO2/hr/kg       -49.1</span></span>
<span><span class="co">#&gt;  8:  NA    8         94.8 -0.000628 0.929    6288 5050   6613 5049    6612 91.4   90.5 -0.000628   -0.00006     -0.000568  -0.000568     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.05       -43.0          NA  mgO2/hr/kg       -43.0</span></span>
<span><span class="co">#&gt;  9:  NA    9         94.7 -0.000619 0.912    2611 5123   6507 5122    6506 91.5   90.6 -0.000619   -0.00006     -0.000559  -0.000559     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.02       -42.4          NA  mgO2/hr/kg       -42.4</span></span>
<span><span class="co">#&gt; 10:  NA   10         95.7 -0.001043 0.961    1918  596   1981  595    1980 95.0   93.6 -0.001043   -0.00006     -0.000983  -0.000983     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.55       -74.4          NA  mgO2/hr/kg       -74.4</span></span>
<span><span class="co">#&gt; 11:  NA   11         95.7 -0.001040 0.961    1734  589   1983  588    1982 95.1   93.8 -0.001040   -0.00006     -0.000980  -0.000980     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.54       -74.2          NA  mgO2/hr/kg       -74.2</span></span>
<span><span class="co">#&gt; 12:  NA   12         95.7 -0.001035 0.962    1675  571   1989  570    1988 95.1   93.9 -0.001035   -0.00006     -0.000975  -0.000975     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.52       -73.8          NA  mgO2/hr/kg       -73.8</span></span>
<span><span class="co">#&gt; 13:  NA   13         95.7 -0.001042 0.961    1461  594   1982  593    1981 95.0   93.8 -0.001042   -0.00006     -0.000982  -0.000982     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.55       -74.3          NA  mgO2/hr/kg       -74.3</span></span>
<span><span class="co">#&gt; 14:  NA   14         95.7 -0.001039 0.961    1370  587   1987  586    1986 95.0   93.8 -0.001039   -0.00006     -0.000979  -0.000979     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.53       -74.1          NA  mgO2/hr/kg       -74.1</span></span>
<span><span class="co">#&gt; 15:  NA   15         95.7 -0.001037 0.961    1272  582   1988  581    1987 95.2   93.8 -0.001037   -0.00006     -0.000977  -0.000977     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.53       -74.0          NA  mgO2/hr/kg       -74.0</span></span>
<span><span class="co">#&gt; 16:  NA   16         95.7 -0.001034 0.962    1269  570   1992  569    1991 95.0   93.8 -0.001034   -0.00006     -0.000974  -0.000974     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.52       -73.8          NA  mgO2/hr/kg       -73.8</span></span>
<span><span class="co">#&gt; 17:  NA   17         95.1 -0.000705 0.915     724 1578   2900 1577    2899 94.2   93.0 -0.000705   -0.00006     -0.000645  -0.000645     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.33       -48.9          NA  mgO2/hr/kg       -48.9</span></span>
<span><span class="co">#&gt; 18:  NA   18         95.2 -0.000717 0.918     591 1518   2831 1517    2830 94.1   93.2 -0.000717   -0.00006     -0.000657  -0.000657     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.37       -49.8          NA  mgO2/hr/kg       -49.8</span></span>
<span><span class="co">#&gt; 19:  NA   19         95.2 -0.000716 0.918     582 1518   2838 1517    2837 94.1   93.2 -0.000716   -0.00006     -0.000656  -0.000656     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.37       -49.7          NA  mgO2/hr/kg       -49.7</span></span>
<span><span class="co">#&gt; 20:  NA   20         95.4 -0.000855 0.935     581 1185   2499 1184    2498 94.6   93.3 -0.000855   -0.00006     -0.000795  -0.000795     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.87       -60.2          NA  mgO2/hr/kg       -60.2</span></span>
<span><span class="co">#&gt; 21:  NA   21         95.1 -0.000702 0.915     577 1584   2908 1583    2907 94.1   93.2 -0.000702   -0.00006     -0.000642  -0.000642     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.32       -48.6          NA  mgO2/hr/kg       -48.6</span></span>
<span><span class="co">#&gt; 22:  NA   22         95.4 -0.000855 0.935     577 1185   2497 1184    2496 94.6   93.2 -0.000855   -0.00006     -0.000795  -0.000795     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.87       -60.2          NA  mgO2/hr/kg       -60.2</span></span>
<span><span class="co">#&gt; 23:  NA   23         95.2 -0.000721 0.918     575 1514   2823 1513    2822 94.2   93.0 -0.000721   -0.00006     -0.000661  -0.000661     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.39       -50.0          NA  mgO2/hr/kg       -50.0</span></span>
<span><span class="co">#&gt; 24:  NA   24         95.5 -0.000892 0.936     551 1083   2391 1082    2390 94.6   93.3 -0.000892   -0.00006     -0.000832  -0.000832     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.01       -63.0          NA  mgO2/hr/kg       -63.0</span></span>
<span><span class="co">#&gt; 25:  NA   25         95.4 -0.000850 0.933     542 1215   2519 1214    2518 94.4   93.4 -0.000850   -0.00006     -0.000790  -0.000790     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.85       -59.8          NA  mgO2/hr/kg       -59.8</span></span>
<span><span class="co">#&gt; 26:  NA   26         95.5 -0.000894 0.937     501 1067   2390 1066    2389 94.6   93.6 -0.000894   -0.00006     -0.000834  -0.000834     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.01       -63.1          NA  mgO2/hr/kg       -63.1</span></span>
<span><span class="co">#&gt; 27:  NA   27         95.5 -0.000894 0.938     499 1067   2389 1066    2388 94.6   93.3 -0.000894   -0.00006     -0.000834  -0.000834     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.01       -63.2          NA  mgO2/hr/kg       -63.2</span></span>
<span><span class="co">#&gt; 28:  NA   28         95.3 -0.000803 0.928     496 1324   2634 1323    2633 94.3   93.3 -0.000803   -0.00006     -0.000743  -0.000743     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.68       -56.3          NA  mgO2/hr/kg       -56.3</span></span>
<span><span class="co">#&gt; 29:  NA   29         95.5 -0.000894 0.937     495 1069   2389 1068    2388 94.5   93.3 -0.000894   -0.00006     -0.000834  -0.000834     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.01       -63.2          NA  mgO2/hr/kg       -63.2</span></span>
<span><span class="co">#&gt; 30:  NA   30         95.3 -0.000802 0.927     489 1328   2637 1327    2636 94.3   93.3 -0.000802   -0.00006     -0.000742  -0.000742     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.68       -56.2          NA  mgO2/hr/kg       -56.2</span></span>
<span><span class="co">#&gt; 31:  NA   31         95.3 -0.000802 0.928     488 1323   2638 1322    2637 94.3   93.3 -0.000802   -0.00006     -0.000742  -0.000742     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.68       -56.2          NA  mgO2/hr/kg       -56.2</span></span>
<span><span class="co">#&gt; 32:  NA   32         95.3 -0.000802 0.928     477 1323   2637 1322    2636 94.3   93.3 -0.000802   -0.00006     -0.000742  -0.000742     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.68       -56.2          NA  mgO2/hr/kg       -56.2</span></span>
<span><span class="co">#&gt; 33:  NA   33         95.4 -0.000854 0.935     472 1185   2501 1184    2500 94.6   93.4 -0.000854   -0.00006     -0.000794  -0.000794     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.87       -60.1          NA  mgO2/hr/kg       -60.1</span></span>
<span><span class="co">#&gt; 34:  NA   34         95.4 -0.000854 0.935     447 1186   2500 1185    2499 94.4   93.3 -0.000854   -0.00006     -0.000794  -0.000794     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.87       -60.1          NA  mgO2/hr/kg       -60.1</span></span>
<span><span class="co">#&gt; 35:  NA   35         95.5 -0.000894 0.938     421 1063   2394 1062    2393 94.5   93.5 -0.000894   -0.00006     -0.000834  -0.000834     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.01       -63.1          NA  mgO2/hr/kg       -63.1</span></span>
<span><span class="co">#&gt; 36:  NA   36         95.5 -0.000894 0.937     388 1066   2393 1065    2392 94.7   93.4 -0.000894   -0.00006     -0.000834  -0.000834     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.01       -63.1          NA  mgO2/hr/kg       -63.1</span></span>
<span><span class="co">#&gt; 37:  NA   37         95.3 -0.000803 0.929     376 1315   2641 1314    2640 94.3   93.3 -0.000803   -0.00006     -0.000743  -0.000743     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.68       -56.3          NA  mgO2/hr/kg       -56.3</span></span>
<span><span class="co">#&gt; 38:  NA   38         95.3 -0.000803 0.929     369 1317   2641 1316    2640 94.3   93.3 -0.000803   -0.00006     -0.000743  -0.000743     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.68       -56.2          NA  mgO2/hr/kg       -56.2</span></span>
<span><span class="co">#&gt; 39:  NA   39         95.3 -0.000803 0.928     322 1325   2635 1324    2634 94.2   93.3 -0.000803   -0.00006     -0.000743  -0.000743     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.68       -56.2          NA  mgO2/hr/kg       -56.2</span></span>
<span><span class="co">#&gt;     rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Obviously this is a lot of information. The <code>rate.output</code>,
which is the primary output we are interested in, varies in value by
quite a lot. The r-squared of the regressions is fairly variable. The
linear regions also come from all over the dataset as can be seen by
looking at the time or row columns. It might be difficult to know how to
handle this many results and arrive at a final reportable rate.</p>
<p>If we are looking for the lowest linear rate, the top ranked result
here is actually a very good one! It is amongst the lowest rates (only 2
in rows 8 and 9 are lower), has a high r-squared, and is sustained over
a large region of the data. This would probably be completely
appropriate to report as the SMR, however we’ll proceed with selection
to show how these criteria can be applied, and then these could be
applied to other experiments.</p>
<div class="section level3">
<h3 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h3>
<p>We can use the <code>convert_rate</code> plotting functionality to
get a better idea of rate values and how they are distributed. We’ll
look at both the rate value plot and the overlap plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sard</span>, type <span class="op">=</span> <span class="st">"rate"</span><span class="op">)</span></span>
<span><span class="co">#&gt; plot.convert_rate: Plotting all rate(s)...</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sard</span>, type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span></span>
<span><span class="co">#&gt; plot.convert_rate: Plotting all rate(s)...</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-7-2.png" width="960" style="display: block; margin: auto;"></p>
<p>We can see the rates are higher at the start of the dataset, after
which they stabilise. From the overlap plot we can see many of the
linear regions substantially overlap and are essentially from the same
regions of the data. Some are even completely contained within others.
We don’t need to keep all of these different results.</p>
</div>
<div class="section level3">
<h3 id="selection-of-rates">Selection of rates<a class="anchor" aria-label="anchor" href="#selection-of-rates"></a>
</h3>
<p><code>select_rate</code> allows us to select out only the results
that meet certain criteria. If we are interested in the lowest rates we
can use this method to select any number of the lowest rates using
<code>n</code>. Here is the lowest single rate.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest"</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    9         94.7 -0.000619 0.912    2611 5123   6507 5122    6506 91.5   90.6 -0.000619   -0.00006     -0.000559  -0.000559     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.02       -42.4          NA  mgO2/hr/kg       -42.4</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="additional-selection-criteria">Additional selection criteria<a class="anchor" aria-label="anchor" href="#additional-selection-criteria"></a>
</h3>
<p>Objectively, this is a perfectly acceptable result and would be fine
to report, but let’s apply a couple of additional criteria. The result
above has a relatively low r-squared than others in the dataset, and
also is around 23 minutes in duration.</p>
<p>Let’s say we are only interested in rate results with an r-squared
above 0.95, and also that we are only interested in rates which are
sustained for at least 30 minutes (1800s). We can apply multiple
selection criteria by using pipes (alternatively you can save the output
and process it through <code>select_rate</code> multiple times).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rsq"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"duration"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1800</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest"</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1         94.9 -0.000661 0.982   19082 3659   6736 3658    6735 92.6   90.4 -0.000661   -0.00006     -0.000601  -0.000601     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.17       -45.5          NA  mgO2/hr/kg       -45.5</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Now our rate is slightly higher than in the previous example, but it
fulfils these additional criteria, so we could report this as our final
rate if these criteria were what we decided upon.</p>
<p>Please note again however - this is not a recommendation as to what
rates or criteria you should apply to your own data. This is just an
example, and the important point to take is that the same selection
criteria can be consistently applied and documented across multiple
analyses.</p>
</div>
<div class="section level3">
<h3 id="reporting-the-result">Reporting the result<a class="anchor" aria-label="anchor" href="#reporting-the-result"></a>
</h3>
<p><code>select_rate</code> allows you to apply very specific selection
criteria in a specific priority order. Because of this is it
straightforward to report the analysis in clear language. We might
report the above analysis in just a short passage in the methods like
this:</p>
<p><em>“Data was analysed using the R package <code>respR</code>
(Harianto et al. 2019). The auto_rate”linear” method was used to
automatically identify linear regions of the data. SMR was defined as
the lowest of these rates with r-squared above 0.95 sustained for at
least 30 minutes.”</em></p>
</div>
</div>
<div class="section level2">
<h2 id="auto_rate-lowest-results">2. <code>auto_rate</code> <code>"lowest"</code> results<a class="anchor" aria-label="anchor" href="#auto_rate-lowest-results"></a>
</h2>
<p>Let’s use the <code>sardine.rd</code> dataset again, and let’s say we
again want to extract a standard metabolic rate (SMR), but we want to
define a specific duration.</p>
<div class="section level3">
<h3 id="method-lowest">
<code>method = "lowest"</code><a class="anchor" aria-label="anchor" href="#method-lowest"></a>
</h3>
<p>The SMR rates we extracted above occur over durations of 45 minutes
to nearly an hour. But maybe we want to standardise our analyses and
comparisons of different specimens by defining our SMR as the lowest
rate across a specific duration, for example 20 minutes. We can use the
<code>auto_rate</code> <code>method = "lowest"</code> to output all
rates of this specific <code>width</code> and order them from lowest to
highest value, adjust and convert these, then apply some additional
selection criteria.</p>
<p>Here we do a rolling regression of 20 minutes (<code>1200</code>
seconds) <code>width</code> in the <code>"time"</code> metric.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">sardine.rd</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest"</span>, width <span class="op">=</span> <span class="fl">1200</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="op">-</span><span class="fl">0.00006</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,</span>
<span>               time.unit <span class="op">=</span> <span class="st">"sec"</span>,</span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/kg"</span>,</span>
<span>               volume <span class="op">=</span> <span class="fl">12.3</span>,</span>
<span>               mass <span class="op">=</span> <span class="fl">0.0477</span>,</span>
<span>               S <span class="op">=</span> <span class="fl">35</span>, </span>
<span>               t <span class="op">=</span> <span class="fl">14.8</span>,</span>
<span>               p <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;    1:  NA    1         94.7 -0.000612 0.886      NA 5257   6457 5256    6456 91.4   90.9 -0.000612   -0.00006     -0.000552  -0.000552     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -1.99       -41.8          NA  mgO2/hr/kg       -41.8</span></span>
<span><span class="co">#&gt;    2:  NA    2         94.7 -0.000612 0.886      NA 5258   6458 5257    6457 91.4   90.7 -0.000612   -0.00006     -0.000552  -0.000552     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -1.99       -41.8          NA  mgO2/hr/kg       -41.8</span></span>
<span><span class="co">#&gt;    3:  NA    3         94.7 -0.000612 0.886      NA 5259   6459 5258    6458 91.3   90.7 -0.000612   -0.00006     -0.000552  -0.000552     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -1.99       -41.8          NA  mgO2/hr/kg       -41.8</span></span>
<span><span class="co">#&gt;    4:  NA    4         94.7 -0.000612 0.888      NA 5254   6454 5253    6453 91.5   90.7 -0.000612   -0.00006     -0.000552  -0.000552     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -1.99       -41.8          NA  mgO2/hr/kg       -41.8</span></span>
<span><span class="co">#&gt;    5:  NA    5         94.7 -0.000612 0.887      NA 5256   6456 5255    6455 91.4   90.8 -0.000612   -0.00006     -0.000552  -0.000552     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.00       -41.8          NA  mgO2/hr/kg       -41.8</span></span>
<span><span class="co">#&gt;   ---                                                                                                                                                                                                                                             </span></span>
<span><span class="co">#&gt; 6309:  NA 6309         95.8 -0.001089 0.954      NA  695   1895  694    1894 95.0   93.8 -0.001089   -0.00006     -0.001029  -0.001029     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.72       -77.9          NA  mgO2/hr/kg       -77.9</span></span>
<span><span class="co">#&gt; 6310:  NA 6310         95.8 -0.001089 0.954      NA  692   1892  691    1891 95.0   93.8 -0.001089   -0.00006     -0.001029  -0.001029     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.72       -77.9          NA  mgO2/hr/kg       -77.9</span></span>
<span><span class="co">#&gt; 6311:  NA 6311         95.8 -0.001089 0.954      NA  694   1894  693    1893 95.0   93.8 -0.001089   -0.00006     -0.001029  -0.001029     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.72       -77.9          NA  mgO2/hr/kg       -77.9</span></span>
<span><span class="co">#&gt; 6312:  NA 6312         95.8 -0.001089 0.954      NA  691   1891  690    1890 95.0   93.8 -0.001089   -0.00006     -0.001029  -0.001029     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.72       -77.9          NA  mgO2/hr/kg       -77.9</span></span>
<span><span class="co">#&gt; 6313:  NA 6313         95.8 -0.001089 0.954      NA  693   1893  692    1892 95.0   93.7 -0.001089   -0.00006     -0.001029  -0.001029     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.72       -77.9          NA  mgO2/hr/kg       -77.9</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>The function has fit every regression of 1200s width across the
entire dataset and ranked them in order of absolute rate value from
lowest to highest. The plot shows the top ranking result, in this case
the very lowest rate. We may not necessarily want to use this result
however. In this case it has a relatively low r-squared compared to
others (we’re not showing the full summary table but it ranges from
around 0.88 to 0.95).</p>
<p>Let’s look at the <code>"overlap"</code> plot output.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This plot is perhaps difficult to understand at first, but should
become clear. The summary table is ordered from lowest to highest rates
descending. The lower plot reflects this, and shows most of these lower
rates, the ones at the top of both this plot and the summary table, are
towards the end of the dataset. By contrast, high rates are at the
start. This plot is essentially the rolling rate (panel 4) of the
<code>auto_rate</code> plot just above flipped vertically. See how the
lowest rates occur around timepoint 6000 in both.</p>
<p>We are looking for lowest rates, so we don’t need to keep any rates
before around timepoint 3000. We can remove those using
<code>time_omit</code>. Let’s also only keep those with r-squared above
0.9.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"time_omit"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3000</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rsq"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # plot.convert_rate # -------------------</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;    1:  NA  562         94.9 -0.000645 0.900      NA 3845   5045 3844    5044 92.4   91.6 -0.000645   -0.00006     -0.000585  -0.000585     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.11       -44.3          NA  mgO2/hr/kg       -44.3</span></span>
<span><span class="co">#&gt;    2:  NA  694         94.9 -0.000653 0.903      NA 4521   5721 4520    5720 91.8   91.1 -0.000653   -0.00006     -0.000593  -0.000593     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.14       -44.9          NA  mgO2/hr/kg       -44.9</span></span>
<span><span class="co">#&gt;    3:  NA  699         94.9 -0.000653 0.903      NA 4519   5719 4518    5718 92.0   91.2 -0.000653   -0.00006     -0.000593  -0.000593     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.14       -44.9          NA  mgO2/hr/kg       -44.9</span></span>
<span><span class="co">#&gt;    4:  NA  700         94.9 -0.000653 0.903      NA 4520   5720 4519    5719 92.1   91.1 -0.000653   -0.00006     -0.000593  -0.000593     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.14       -44.9          NA  mgO2/hr/kg       -44.9</span></span>
<span><span class="co">#&gt;    5:  NA  702         94.9 -0.000653 0.901      NA 4584   5784 4583    5783 91.8   91.3 -0.000653   -0.00006     -0.000593  -0.000593     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.14       -44.9          NA  mgO2/hr/kg       -44.9</span></span>
<span><span class="co">#&gt;   ---                                                                                                                                                                                                                                             </span></span>
<span><span class="co">#&gt; 1849:  NA 4421         95.3 -0.000711 0.904      NA 6198   7398 6197    7397 90.8   90.1 -0.000711   -0.00006     -0.000651  -0.000651     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.35       -49.3          NA  mgO2/hr/kg       -49.3</span></span>
<span><span class="co">#&gt; 1850:  NA 4424         95.3 -0.000711 0.904      NA 6195   7395 6194    7394 90.9   90.0 -0.000711   -0.00006     -0.000651  -0.000651     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.35       -49.3          NA  mgO2/hr/kg       -49.3</span></span>
<span><span class="co">#&gt; 1851:  NA 4426         95.3 -0.000711 0.904      NA 6197   7397 6196    7396 90.8   90.0 -0.000711   -0.00006     -0.000651  -0.000651     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.35       -49.3          NA  mgO2/hr/kg       -49.3</span></span>
<span><span class="co">#&gt; 1852:  NA 4427         95.3 -0.000711 0.904      NA 6196   7396 6195    7395 90.9   90.0 -0.000711   -0.00006     -0.000651  -0.000651     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.35       -49.3          NA  mgO2/hr/kg       -49.3</span></span>
<span><span class="co">#&gt; 1853:  NA 4457         95.3 -0.000711 0.905      NA 6193   7393 6192    7392 90.9   90.0 -0.000711   -0.00006     -0.000651  -0.000651     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.35       -49.3          NA  mgO2/hr/kg       -49.3</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Now we are left with 1853 results. We’ll refine our selection
criteria further by only taking the 500 lowest of these rates, then
removing those which overlap with another by 90% or more (see <a href="#overlap">Overlapping results</a> section for explanation of this
method). We are doing the <code>"overlap"</code> method last because it
is <em>extremely</em> computationally intensive and the time it takes
increases exponentially with the number of results remaining.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rsq"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"time_omit"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3000</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest"</span>, n <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"overlap"</span>, n <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # plot.convert_rate # -------------------</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA  562         94.9 -0.000645 0.900      NA 3845   5045 3844    5044 92.4   91.6 -0.000645   -0.00006     -0.000585  -0.000585     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.11       -44.3          NA  mgO2/hr/kg       -44.3</span></span>
<span><span class="co">#&gt; 2:  NA  694         94.9 -0.000653 0.903      NA 4521   5721 4520    5720 91.8   91.1 -0.000653   -0.00006     -0.000593  -0.000593     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.14       -44.9          NA  mgO2/hr/kg       -44.9</span></span>
<span><span class="co">#&gt; 3:  NA 1055         94.9 -0.000662 0.900      NA 3686   4886 3685    4885 92.6   91.7 -0.000662   -0.00006     -0.000602  -0.000602     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.17       -45.6          NA  mgO2/hr/kg       -45.6</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # mean.convert_rate # -------------------</span></span>
<span><span class="co">#&gt; Mean of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean of 3 output rates:</span></span>
<span><span class="co">#&gt; [1] -44.9</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr/kg"</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Now we are left with only 3 results. We could take the top result as
our SMR, but just to show a different option this time we have piped the
results to the mean function to get a final mean rate.</p>
<p>To repeat the note from above: this is not a recommendation as to
what rates or criteria you should apply to your own data. This is just
an example, and the important point to take is that the same selection
criteria can be consistently applied and documented across multiple
analyses.</p>
</div>
<div class="section level3">
<h3 id="selection-criteria-ordering">Selection criteria ordering<a class="anchor" aria-label="anchor" href="#selection-criteria-ordering"></a>
</h3>
<p>Note that the order you apply selection criteria is <em>extremely
important</em>. Applying the same criteria in a different order can give
totally different results. What happens if we repeat the above but take
the lowest 500 results first, <em>then</em> apply our r-squared
range?</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sard</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest"</span>, n <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rsq"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; select_rate: Selecting lowest 500 *absolute* rate values...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 5813 rate(s) removed, 500 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; select_rate: Selecting rates with rsq values between 0.9 and 1...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 500 rate(s) removed, 0 rate(s) remaining -----</span></span></code></pre></div>
<p>Now we have no results! This is because in the original ordered
results, none of the lowest 500 rates had an r-squared above 0.9.</p>
<p>This demonstrates how selection criteria should be consistently
applied in the same priority order across different analyses.</p>
</div>
<div class="section level3">
<h3 id="reporting-the-result-1">Reporting the result<a class="anchor" aria-label="anchor" href="#reporting-the-result-1"></a>
</h3>
<p><code>select_rate</code> allows you to apply very specific selection
criteria in a specific priority order. Because of this is it
straightforward to report the analysis. We might report the above in
just a short passage in the methods like this:</p>
<p><em>“Data was analysed using the R package <code>respR</code>
(Harianto et al. 2019). The <code>auto_rate</code> function was used to
calculate a rolling regression of 20 minutes across the dataset. SMR was
defined as the mean of the lowest rates with r-squared above
0.9.”</em></p>
</div>
</div>
<div class="section level2">
<h2 id="intermittent-flow-results">3. Intermittent-flow results<a class="anchor" aria-label="anchor" href="#intermittent-flow-results"></a>
</h2>
<p><code>select_rate</code> becomes really useful when it comes to
dealing with the results of intermittent-flow analyses, particularly the
outputs of <code>calc_rate.int</code> and <code>auto_rate.int</code>.
When you have tens to hundreds of replicates it can be difficult to both
extract rates from them and filter the results consistently. These
functions introduced in <a href="https://januarharianto.github.io/respR/articles/release_notes.html">respR
v2.1</a> combined with <code>select_rate</code> make this process really
straightforward.</p>
<p>A full analysis of a long intermittent-flow experiment including
results filtering using <code>select_rate</code> can be seen in
<code><a href="../articles/intermittent_long.html">vignette("intermittent_long")</a></code>. Here we will show a brief
example using part of the same dataset.</p>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>Here we will subset a portion of the <code>zeb_intermittent.rd</code>
dataset, use <code>calc_rate.int</code> to extract a rate from the same
time period of each. We’ll specify the replicates cycle at every 660
rows using <code>starts</code>, use a <code>wait</code> phase of two
minutes (120 rows), and a <code>measure</code> phase of six minutes (360
rows) within each replicate. Then we convert the results, plot them in
two different ways, and show the summary table.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span>,</span>
<span>                       from <span class="op">=</span> <span class="fl">5840</span>,</span>
<span>                       to <span class="op">=</span> <span class="fl">19039</span>,</span>
<span>                       by <span class="op">=</span> <span class="st">"row"</span>, </span>
<span>                       quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span>starts <span class="op">=</span> <span class="fl">660</span>,</span>
<span>                wait <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                measure <span class="op">=</span> <span class="fl">360</span>,</span>
<span>                by <span class="op">=</span> <span class="st">"row"</span>,  </span>
<span>                plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>, </span>
<span>               time.unit <span class="op">=</span> <span class="st">"secs"</span>,</span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,</span>
<span>               volume <span class="op">=</span> <span class="fl">0.12</span>,         </span>
<span>               mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"rate"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"><img src="select_rate_files/figure-html/unnamed-chunk-16-2.png" width="960" style="display: block; margin: auto;"></p>
<p>The first <code>type = "full"</code> plot shows each replicate rate
in the context of the entire data series. The second
<code>type = "rate"</code> plot is really useful in understanding how
rates change over the course of these 20 replicates.</p>
<p>The summary, which is quite a large table, shows us how these rates
change across the 20 replicates.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_sub</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rep rank intercept_b0 slope_b1   rsq density   row endrow  time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;  1:   1    1         53.2 -0.00785 0.997      NA   121    480  5960    6319 6.45   3.57 -0.00785         NA            NA   -0.00785     mg/L       sec   0.12 0.0009   NA NA NA NA   -3.390       -3.77          NA   mgO2/hr/g       -3.77</span></span>
<span><span class="co">#&gt;  2:   2    1         51.9 -0.00684 0.975      NA   781   1140  6620    6979 6.82   4.41 -0.00684         NA            NA   -0.00684     mg/L       sec   0.12 0.0009   NA NA NA NA   -2.956       -3.28          NA   mgO2/hr/g       -3.28</span></span>
<span><span class="co">#&gt;  3:   3    1         53.6 -0.00641 0.994      NA  1441   1800  7280    7639 6.99   4.64 -0.00641         NA            NA   -0.00641     mg/L       sec   0.12 0.0009   NA NA NA NA   -2.767       -3.07          NA   mgO2/hr/g       -3.07</span></span>
<span><span class="co">#&gt;  4:   4    1         42.1 -0.00442 0.989      NA  2101   2460  7940    8299 7.16   5.45 -0.00442         NA            NA   -0.00442     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.909       -2.12          NA   mgO2/hr/g       -2.12</span></span>
<span><span class="co">#&gt;  5:   5    1         40.0 -0.00382 0.989      NA  2761   3120  8600    8959 7.31   5.88 -0.00382         NA            NA   -0.00382     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.648       -1.83          NA   mgO2/hr/g       -1.83</span></span>
<span><span class="co">#&gt;  6:   6    1         37.3 -0.00323 0.986      NA  3421   3780  9260    9619 7.47   6.31 -0.00323         NA            NA   -0.00323     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.395       -1.55          NA   mgO2/hr/g       -1.55</span></span>
<span><span class="co">#&gt;  7:   7    1         34.9 -0.00276 0.985      NA  4081   4440  9920   10279 7.56   6.62 -0.00276         NA            NA   -0.00276     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.191       -1.32          NA   mgO2/hr/g       -1.32</span></span>
<span><span class="co">#&gt;  8:   8    1         34.0 -0.00250 0.979      NA  4741   5100 10580   10939 7.64   6.67 -0.00250         NA            NA   -0.00250     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.078       -1.20          NA   mgO2/hr/g       -1.20</span></span>
<span><span class="co">#&gt;  9:   9    1         35.1 -0.00245 0.973      NA  5401   5760 11240   11599 7.60   6.70 -0.00245         NA            NA   -0.00245     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.057       -1.17          NA   mgO2/hr/g       -1.17</span></span>
<span><span class="co">#&gt; 10:  10    1         35.2 -0.00231 0.984      NA  6061   6420 11900   12259 7.64   6.88 -0.00231         NA            NA   -0.00231     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.999       -1.11          NA   mgO2/hr/g       -1.11</span></span>
<span><span class="co">#&gt; 11:  11    1         36.9 -0.00232 0.983      NA  6721   7080 12560   12919 7.74   6.88 -0.00232         NA            NA   -0.00232     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.002       -1.11          NA   mgO2/hr/g       -1.11</span></span>
<span><span class="co">#&gt; 12:  12    1         39.5 -0.00240 0.982      NA  7381   7740 13220   13579 7.76   6.91 -0.00240         NA            NA   -0.00240     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.038       -1.15          NA   mgO2/hr/g       -1.15</span></span>
<span><span class="co">#&gt; 13:  13    1         40.0 -0.00232 0.981      NA  8041   8400 13880   14239 7.77   6.89 -0.00232         NA            NA   -0.00232     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.003       -1.11          NA   mgO2/hr/g       -1.11</span></span>
<span><span class="co">#&gt; 14:  14    1         40.8 -0.00228 0.979      NA  8701   9060 14540   14899 7.69   6.92 -0.00228         NA            NA   -0.00228     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.984       -1.09          NA   mgO2/hr/g       -1.09</span></span>
<span><span class="co">#&gt; 15:  15    1         46.5 -0.00255 0.984      NA  9361   9720 15200   15559 7.77   6.83 -0.00255         NA            NA   -0.00255     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.100       -1.22          NA   mgO2/hr/g       -1.22</span></span>
<span><span class="co">#&gt; 16:  16    1         43.6 -0.00227 0.982      NA 10021  10380 15860   16219 7.63   6.84 -0.00227         NA            NA   -0.00227     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.979       -1.09          NA   mgO2/hr/g       -1.09</span></span>
<span><span class="co">#&gt; 17:  17    1         44.0 -0.00220 0.977      NA 10681  11040 16520   16879 7.73   6.97 -0.00220         NA            NA   -0.00220     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.949       -1.05          NA   mgO2/hr/g       -1.05</span></span>
<span><span class="co">#&gt; 18:  18    1         45.5 -0.00220 0.975      NA 11341  11700 17180   17539 7.84   6.97 -0.00220         NA            NA   -0.00220     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.949       -1.05          NA   mgO2/hr/g       -1.05</span></span>
<span><span class="co">#&gt; 19:  19    1         45.8 -0.00213 0.978      NA 12001  12360 17840   18199 7.79   7.03 -0.00213         NA            NA   -0.00213     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.920       -1.02          NA   mgO2/hr/g       -1.02</span></span>
<span><span class="co">#&gt; 20:  20    1         47.7 -0.00216 0.976      NA 12661  13020 18500   18859 7.83   6.99 -0.00216         NA            NA   -0.00216     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.932       -1.04          NA   mgO2/hr/g       -1.04</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extract-rates">Extract rates<a class="anchor" aria-label="anchor" href="#extract-rates"></a>
</h3>
<p>Let’s say we are interested in two rates: a maximum metabolic rate
(MMR), that is the highest rate, and a routine metabolic rate (RMR).</p>
<div class="section level4">
<h4 id="mmr">MMR<a class="anchor" aria-label="anchor" href="#mmr"></a>
</h4>
<p>In this example the rate from the first replicate is clearly the
highest, but we can use <code>select_rate</code> to extract it. This
tells the function we are interested in the highest rates (in absolute
value, that is ignoring the sign - see <code><a href="../reference/select_rate.html">help("select_rate")</a></code>
for full details) and to select the single highest one
(<code>n = 1</code>). We also plot it to check which replicate it comes
from, and use <code>summary</code> with the <code>export</code> option
to save the full result as a <code>data.frame</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span><span class="va">zeb_sub</span>, method <span class="op">=</span> <span class="st">"highest"</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span>export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;"></p>
<p>That’s it! We can print the data frame we saved to check the result.
This contains the full results, from which replicate the rate came from,
the data region it was calculated over, any adjustments (which we didn’t
apply here), experimental data such as respirometer volume and specimen
mass, and of course the output rate and its units. This is a great way
of saving the results.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmr</span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:   1    1         53.2 -0.00785 0.997      NA 121    480 5960    6319 6.45   3.57 -0.00785         NA            NA   -0.00785     mg/L       sec   0.12 0.0009   NA NA NA NA    -3.39       -3.77          NA   mgO2/hr/g       -3.77</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rmr">RMR<a class="anchor" aria-label="anchor" href="#rmr"></a>
</h4>
<p>Getting the RMR is just as straightforward. Let’s define it as the
mean of the lowest 10th percentile of rates (quite common, but usually
in studies where there are many more replicates), so this time we pipe
the result to <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span><span class="va">zeb_sub</span>, method <span class="op">=</span> <span class="st">"lowest_percentile"</span>, n <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # plot.convert_rate # -------------------</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # mean.convert_rate # -------------------</span></span>
<span><span class="co">#&gt; Mean of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean of 2 output rates:</span></span>
<span><span class="co">#&gt; [1] -1.03</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr/g"</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Again, we can export the full results using <code>summary</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rmr</span>, export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density   row endrow  time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  19    1         45.8 -0.00213 0.978      NA 12001  12360 17840   18199 7.79   7.03 -0.00213         NA            NA   -0.00213     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.920       -1.02          NA   mgO2/hr/g       -1.02</span></span>
<span><span class="co">#&gt; 2:  20    1         47.7 -0.00216 0.976      NA 12661  13020 18500   18859 7.83   6.99 -0.00216         NA            NA   -0.00216     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.932       -1.04          NA   mgO2/hr/g       -1.04</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="more-examples">More examples<a class="anchor" aria-label="anchor" href="#more-examples"></a>
</h2>
<p>See the following documentation and vignettes for more examples of
how <code>select_rate</code> can be used.</p>
<ul>
<li><code><a href="../reference/select_rate.html">help("select_rate")</a></code></li>
<li><code><a href="../articles/intermittent_short.html">vignette("intermittent_short")</a></code></li>
<li><code><a href="../articles/intermittent_long.html">vignette("intermittent_long")</a></code></li>
</ul>
</div>
<div class="section level2">
<h2 id="overlap">Overlapping results<a class="anchor" aria-label="anchor" href="#overlap"></a>
</h2>
<p>A notable aspect of the <code>auto_rate</code> <code>linear</code>
method is that due to the machine learning algorithm it can often return
multiple linear regions from the same part of a dataset. There is a
special selection method to remove some or all of these overlapping
rates.</p>
<p>In the <code>overlap</code> method, the <code>n</code> input
indicates the proportional degree of overlap to allow for a result to be
retained. For <code>n = 0</code> only rates which do not overlap at all,
that is share <em>no</em> data, are retained. For <code>n = 1</code>
rates which are entirely contained with at least one other are removed.
For values in between these, for example <code>n = 0.5</code>, any
regression which shares at least 50% of its data with another are
removed. This analysis is performed working from the bottom of the
summary table upwards, so generally lower ranked results are removed
first. It is recommended this method be used after other selection
criteria have been applied, as it is quite aggressive about removing
rates, and can be <em>very</em> computationally intensive when there are
many results.</p>
<p>Here we’ll show examples of how it can be used to make
<code>auto_rate</code> results more manageable. Let’s first look at the
results of the <code>auto_rate</code> <code>"linear"</code> method on
the <code>sardine.rd</code> dataset using the <code>overlap</code> plot
type in convert rate.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sardine.rd</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,</span>
<span>               time.unit <span class="op">=</span> <span class="st">"sec"</span>,</span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/kg"</span>,</span>
<span>               volume <span class="op">=</span> <span class="fl">12.3</span>,</span>
<span>               mass <span class="op">=</span> <span class="fl">0.0477</span>,</span>
<span>               S <span class="op">=</span> <span class="fl">35</span>, </span>
<span>               t <span class="op">=</span> <span class="fl">14.8</span>,</span>
<span>               p <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-22-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Now let’s remove all results that share 100% of their datapoints with
at least one other. Here we pipe the result to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sardine.rd</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,</span>
<span>               time.unit <span class="op">=</span> <span class="st">"sec"</span>,</span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/kg"</span>,</span>
<span>               volume <span class="op">=</span> <span class="fl">12.3</span>,</span>
<span>               mass <span class="op">=</span> <span class="fl">0.0477</span>,</span>
<span>               S <span class="op">=</span> <span class="fl">35</span>, </span>
<span>               t <span class="op">=</span> <span class="fl">14.8</span>,</span>
<span>               p <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"overlap"</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-23-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This greatly reduces the number of results, but there is still a
substantial overlap between them. Therefore, let’s adjust the overlap
threshold to 0.9, that is regressions which share 90% or more of data
with at least one other are removed.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sardine.rd</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,</span>
<span>               time.unit <span class="op">=</span> <span class="st">"sec"</span>,</span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/kg"</span>,</span>
<span>               volume <span class="op">=</span> <span class="fl">12.3</span>,</span>
<span>               mass <span class="op">=</span> <span class="fl">0.0477</span>,</span>
<span>               S <span class="op">=</span> <span class="fl">35</span>, </span>
<span>               t <span class="op">=</span> <span class="fl">14.8</span>,</span>
<span>               p <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"overlap"</span>, n <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span></span></code></pre></div>
<p><img src="select_rate_files/figure-html/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq density  row endrow time endtime  oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S    t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    2         95.1 -0.000688 0.986   17476 2242   5543 2241    5542 93.7   91.2 -0.000688         NA            NA  -0.000688     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.48       -52.1          NA  mgO2/hr/kg       -52.1</span></span>
<span><span class="co">#&gt; 2:  NA    3         94.9 -0.000662 0.987   15982 3628   7164 3627    7163 92.5   90.2 -0.000662         NA            NA  -0.000662     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.39       -50.1          NA  mgO2/hr/kg       -50.1</span></span>
<span><span class="co">#&gt; 3:  NA    4         95.1 -0.000708 0.979    9211 1578   4236 1577    4235 94.2   92.2 -0.000708         NA            NA  -0.000708     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -2.56       -53.6          NA  mgO2/hr/kg       -53.6</span></span>
<span><span class="co">#&gt; 4:  NA    6         95.7 -0.001047 0.961    6865  601   1969  600    1968 95.1   93.7 -0.001047         NA            NA  -0.001047     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.78       -79.2          NA  mgO2/hr/kg       -79.2</span></span>
<span><span class="co">#&gt; 5:  NA   20         95.4 -0.000855 0.935     581 1185   2499 1184    2498 94.6   93.3 -0.000855         NA            NA  -0.000855     %Air       sec   12.3 0.0477   NA 35 14.8 1.01    -3.09       -64.7          NA  mgO2/hr/kg       -64.7</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>This has greatly reduced the number of linear regions, and is a much
more manageable set of results.</p>
</div>
<div class="section level2">
<h2 id="full-documentation">Full documentation<a class="anchor" aria-label="anchor" href="#full-documentation"></a>
</h2>
<p>See <code><a href="../reference/select_rate.html">help("select_rate")</a></code> for full details of all the
selection criteria that can be applied.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
