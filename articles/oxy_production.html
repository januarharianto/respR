<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oxygen production respirometry • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Oxygen production respirometry">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR in Use</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Oxygen production respirometry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/oxy_production.Rmd" class="external-link"><code>vignettes/oxy_production.Rmd</code></a></small>
      <div class="hidden name"><code>oxy_production.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Introduction<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>While the majority of respirometry studies are concerned with oxygen
uptake by various organisms, there are many studies of organisms such as
plants, algae and corals where oxygen production rates are of primary
interest. We have designed <code>respR</code> to be able to process and
calculate rates from oxygen production data in exactly the same way as
for consumption data. In fact, the package has already <a href="https://januarharianto.github.io/respR/articles/citations.html">been
used</a> by several studies to determine the production rates of
diatoms, algae, and corals.</p>
<p>Here we will use the included <code>algae.rd</code> dataset to
briefly show how production data may be processed and used to extract
production rates. It contains 20 hours of data recorded once per minute
on oxygen production by an algae. More information on the data can be
seen by running <code><a href="../reference/algae.rd.html">?algae.rd</a></code>.</p>
</div>
<div class="section level2">
<h2 id="inspect">Inspect the data<a class="anchor" aria-label="anchor" href="#inspect"></a>
</h2>
<p>Like all analyses in <code>respR</code> the first step is to inspect
the data for common issues.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">algae.rd</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; Warning: inspect: Time values are not evenly-spaced (numerically).</span></span>
<span><span class="co">#&gt; inspect: Data issues detected. For more information use print().</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time Oxygen</span></span>
<span><span class="co">#&gt; numeric         pass   pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass   pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass   pass</span></span>
<span><span class="co">#&gt; sequential      pass      -</span></span>
<span><span class="co">#&gt; duplicated      pass      -</span></span>
<span><span class="co">#&gt; evenly-spaced   WARN      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uneven Time data locations (first 20 shown) in column: Time </span></span>
<span><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] 0.01 0.02</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p><img src="oxy_production_files/figure-html/unnamed-chunk-1-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In <code>respR</code> oxygen uptake rates are represented by negative
values since they represent a negative slope of oxygen against time.
Since the focus of the package is on uptake rates, by default the
<code><a href="../reference/inspect.html">inspect()</a></code> function plots rolling rates on a reversed axis
so that higher oxygen uptake rates appear higher on the plot. To examine
production rates, which are positive, we pass
<code>rate.rev = FALSE</code> to reverse this behaviour</p>
<p>We can see the data passes most of the checks. The warning about
uneven time can be safely disregarded as it stems from the per minute
recording interval being converted to decimalised hours, and we can see
the minimum and maximum intervals indicate there are no major gaps.</p>
<p>We can see that at the default rolling rate <code>width</code> input
of 10% of the data the rate is very variable, from zero to over 0.15.
However, there are characteristics of the raw data which could cause
this; it has a fairly shallow overall slope and high relative noise
level, therefore rates over narrow time windows would be expected to be
variable. Instead we can pick a more appropriate width that will give a
better idea of the true rate.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">algae_insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">algae.rd</span>, width <span class="op">=</span> <span class="fl">0.5</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; Warning: inspect: Time values are not evenly-spaced (numerically).</span></span>
<span><span class="co">#&gt; inspect: Data issues detected. For more information use print().</span></span></code></pre></div>
<p><img src="oxy_production_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We can see now that rate is actually highly stable across the
dataset, and this tells us when we come to calculate rates we should
probably use rates determined over this width or higher, and the value
will be around 0.09 to 0.10.</p>
</div>
<div class="section level2">
<h2 id="calculate-rates">Calculate rates<a class="anchor" aria-label="anchor" href="#calculate-rates"></a>
</h2>
<p>Since the rate appears to be fairly stable across the dataset we will
use <code><a href="../reference/auto_rate.html">auto_rate()</a></code> to identify the most linear region.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">algae_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">algae_insp</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; auto_rate: Applying default 'width' of 0.2</span></span></code></pre></div>
<p><img src="oxy_production_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This is a good opportunity to explain how the <code>auto_rate</code>
<code>"linear"</code> method works and how to interpret the outputs.
Briefly (see <code><a href="../articles/auto_rate.html">vignette("auto_rate")</a></code> for more detail), the
linear method uses the input <code>width</code> as a starting seed value
to calculate a rolling rate across the dataset (seen in panel 3). It
then uses these rates to identify linear regions using kernel density
estimation (KDE, see panel 6). Peaks in this plot represent linear
regions, that is areas of stable rates at that <code>width</code>
representative of that region as a whole. It then re-samples these
regions and runs additional linear analysis at different widths to
arrive at a final rate for this region. This is why the final, high
ranked rates tend to be over widths greater than the input
<code>width</code>, as can be seen here with the top ranked result.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">algae_rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.auto_rate # -------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Summary of Results by Kernel Density Rank ===</span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow  time endtime  oxy endoxy   rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         95.8   0.0911 0.849   27.78  59    980  0.98    16.3 96.0   97.3 0.0911</span></span>
<span><span class="co">#&gt; 2:  NA    2         96.4   0.0507 0.128    8.93 891   1144 14.85    19.1 97.1   97.3 0.0507</span></span>
<span><span class="co">#&gt; 3:  NA    3         95.5   0.1194 0.441    6.86 460    714  7.67    11.9 96.2   96.6 0.1194</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions : 961 | Results : 3 | Method : linear | Roll width : 240 | Roll type : row </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Here, we have a very good top ranked result; it is calculated over a
large part of the dataset, is around the value we expected from
inspecting it earlier, this value is in the middle of the range of
rolling rates at the default input width (dashed line, panel 3), and has
a high r-squared in comparison to the other results.</p>
<p>Generally, the higher and wider the peak in the KDE, the more linear
the region. We can see three peaks in the KDE (panel 6). However, the
other two are very much lower and narrower. Let’s look at the second
ranked result using <code>pos</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">algae_rate</span>, pos <span class="op">=</span> <span class="fl">2</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="oxy_production_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here we can see this rate is over a much narrower region towards the
end of the data, the value of 0.05 is very much lower than we are
expecting, and at the extremes of the range (panel 3). While this may be
a linear region within the data, it is very much not representative of
the data as a whole.</p>
<p>In this analysis, we can easily see that the top ranked result is the
one we want, and we can exclude the other two. See
<code><a href="../articles/select_rate.html">vignette("select_rate")</a></code> for more advanced filtering of
<code>auto_rate</code> results by many different criteria.</p>
<div class="section level3">
<h3 id="rolling-rate-widths-in-auto_rate">Rolling rate widths in <code>auto_rate</code><a class="anchor" aria-label="anchor" href="#rolling-rate-widths-in-auto_rate"></a>
</h3>
<p>We saw in the <code>inspect</code> <a href="#inspect">section</a>
above a higher <code>width</code> made the rolling rate much more
consistent. It is not necessarily always the case increasing the default
of <code>width = 0.2</code> will improve the results of
<code>auto_rate</code> however, as it gives the KDE much less variation
to work with.</p>
<p>Here is the summary table of the results when we increase the width
to 0.5. Note that the rolling rate plot (panel 3) in which the rate
looks highly variable is now on a much narrower y-axis range. In fact,
it is identical to the one in the <code>inspect</code> plot <a href="#inspect">above</a> but on different axes ranges.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">algae_insp</span>, width <span class="op">=</span> <span class="fl">0.5</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">summary</span></span></code></pre></div>
<p><img src="oxy_production_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow  time endtime  oxy endoxy   rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         95.8   0.0900 0.881   179.5  11   1086  0.18    18.1 95.7   97.2 0.0900</span></span>
<span><span class="co">#&gt; 2:  NA    2         95.8   0.0899 0.855   138.4 132   1083  2.20    18.1 96.2   97.3 0.0899</span></span>
<span><span class="co">#&gt; 3:  NA    3         95.7   0.0916 0.761   111.3 338   1016  5.63    16.9 96.2   97.3 0.0916</span></span>
<span><span class="co">#&gt; 4:  NA    4         95.8   0.0910 0.763    74.4 328   1016  5.47    16.9 96.3   97.3 0.0910</span></span>
<span><span class="co">#&gt; 5:  NA    5         95.9   0.0813 0.651    57.9 612   1200 10.20    20.0 96.9   97.6 0.0813</span></span>
<span><span class="co">#&gt; 6:  NA    6         95.9   0.0820 0.651    46.9 612   1192 10.20    19.9 96.9   97.6 0.0820</span></span>
<span><span class="co">#&gt; 7:  NA    7         95.8   0.0903 0.824    27.4 203   1042  3.38    17.4 96.3   97.2 0.0903</span></span>
<span><span class="co">#&gt; 8:  NA    8         95.8   0.0852 0.639    20.2 543   1083  9.05    18.1 96.7   97.3 0.0852</span></span></code></pre>
<p>This doesn’t really improve our analysis very much, and could be more
confusing since there are more results. There is still one central peak
in the KDE analysis, which uses more of the dataset, but it is largely
the same as the top ranked result in the earlier analysis, differing in
rate value by only 1-2%. The other results are more consistent in their
rate values, but they are largely redundant as they broadly use the same
range of the data. We can visualise this using the internal
<code><a href="../reference/overlap.p.html">overlap.p()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">algae_insp</span>, width <span class="op">=</span> <span class="fl">0.5</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">respR</span><span class="fu">:::</span><span class="fu"><a href="../reference/overlap.p.html">overlap.p</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; overlap.p: Plotting all rate(s)...</span></span></code></pre></div>
<p><img src="oxy_production_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;"></p>
<p>So we could use the top ranked result here, but the ultimate rate
value barely differs from our earlier analysis, and in this case the
default <code>width</code> provided us with a valid result, so there is
no real reason to exclude it. This does however serve as a good example
of how users should experiment with different widths in
<code>auto_rate</code> to get an idea of how it might affect analyses.
Certain datasets will benefit from this more than others.</p>
<p>See <a href="https://januarharianto.github.io/respR/articles/refs.html#references">Prinzing
et al. 2021</a> for an excellent discussion of appropriate widths in
rolling regressions to determine maximum metabolic rates, much of which
is relevant to extracting rates of any kind.</p>
</div>
</div>
<div class="section level2">
<h2 id="adjust-rate">Adjust rate<a class="anchor" aria-label="anchor" href="#adjust-rate"></a>
</h2>
<p>Oxygen production rates can be adjusted in the exact same way as
uptake rates. In most oxygen production respirometry, background is
likely similar to that in uptake respirometry, that is microbial
organisms are consuming oxygen. However there may be cases where some of
the production could be contributed by other organisms, such as another
algae growing on the surfaces of the respirometer. What is important is
to quantify this by running blank experiments which are identical in
every way except for the presence of the specimen you are interested in.
See <code><a href="../articles/adjust_rate.html">vignette("adjust_rate")</a></code> for details of the numerous
ways experiments can be background adjusted, most of which is equally
relevant to oxygen production respirometry.</p>
<p>Here, we don’t have a control experiment to work with, so we will
just invent some values. The most important aspect here is to be careful
with the <strong><em>signs</em></strong> of the rates we are using;
production rates are positive, uptake rates negative.</p>
<p>This is how you would adjust for a oxygen <em>uptake</em> by
micro-organisms. The uptake background is negative, which means the
production rates have been <em>under</em>-estimated.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">algae_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">algae_rate</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.007</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; adjust_rate: Rate adjustments applied using "mean" method.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">algae_rate_adj</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.adjust_rate # -----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using 'mean' method.</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow  time endtime  oxy endoxy   rate adjustment rate.adjusted</span></span>
<span><span class="co">#&gt; 1:  NA    1         95.8   0.0911 0.849   27.78  59    980  0.98    16.3 96.0   97.3 0.0911     -0.007        0.0981</span></span>
<span><span class="co">#&gt; 2:  NA    2         96.4   0.0507 0.128    8.93 891   1144 14.85    19.1 97.1   97.3 0.0507     -0.007        0.0577</span></span>
<span><span class="co">#&gt; 3:  NA    3         95.5   0.1194 0.441    6.86 460    714  7.67    11.9 96.2   96.6 0.1194     -0.007        0.1264</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>If however you find the control has a background <em>input</em> of
oxygen it is entered as a positive value, in which case the specimen
production rates have been <em>over-</em>estimated.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">algae_rate</span>, by <span class="op">=</span> <span class="fl">0.009</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; adjust_rate: Rate adjustments applied using "mean" method.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.adjust_rate # -----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using 'mean' method.</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow  time endtime  oxy endoxy   rate adjustment rate.adjusted</span></span>
<span><span class="co">#&gt; 1:  NA    1         95.8   0.0911 0.849   27.78  59    980  0.98    16.3 96.0   97.3 0.0911      0.009        0.0821</span></span>
<span><span class="co">#&gt; 2:  NA    2         96.4   0.0507 0.128    8.93 891   1144 14.85    19.1 97.1   97.3 0.0507      0.009        0.0417</span></span>
<span><span class="co">#&gt; 3:  NA    3         95.5   0.1194 0.441    6.86 460    714  7.67    11.9 96.2   96.6 0.1194      0.009        0.1104</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>See also <a href="https://januarharianto.github.io/respR/articles/adjust_rate.html#case-9-adjusting-oxygen-production-rates">Case
9</a> in <code><a href="../articles/adjust_rate.html">vignette("adjust_rate")</a></code> where we perform a similar
adjustment to production rates.</p>
</div>
<div class="section level2">
<h2 id="convert-rate">Convert rate<a class="anchor" aria-label="anchor" href="#convert-rate"></a>
</h2>
<p>Production rates are converted to units in exactly the same way as
uptake rates.</p>
<p>New in <code>respR</code> v2.0 is the ability to output rates as
surface-area specific, which is often used to express oxygen production
of algae and corals per unit area, so we’ll add an <code>area</code>
input and specify an area-specific <code>output.unit</code>.</p>
<p>The <code>area</code> input must be in units of <span class="math inline">\(m^2\)</span>. Here we can also use the new
<code><a href="../reference/convert_val.html">convert_val()</a></code> function to enter the <code>area</code>
input. This function converts between units of area, mass, etc. It is
particularly handy in <code>convert_rate</code> because the default
output unit for area conversions is <span class="math inline">\(m^2\)</span>. Let’s say our algae is 10 <span class="math inline">\(cm^2\)</span>. We don’t have to do this conversion
ourselves, but can rely on <code>convert_val</code>. We don’t even need
to tell it this is an area conversion - it detects this automatically
from the input units.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">algae_rate_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">algae_rate_adj</span>, </span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>, </span>
<span>                                time.unit <span class="op">=</span> <span class="st">"hr"</span>, </span>
<span>                                output.unit <span class="op">=</span> <span class="st">"mg/h/m2"</span>,</span>
<span>                                area <span class="op">=</span> <span class="fu"><a href="../reference/convert_val.html">convert_val</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"cm2"</span><span class="op">)</span>,</span>
<span>                                volume <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                                t <span class="op">=</span> <span class="fl">12</span>, S <span class="op">=</span> <span class="fl">30</span>, P <span class="op">=</span><span class="fl">1.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; convert_rate: Object of class 'adjust_rate' detected. Converting all adjusted rates in '$rate.adjusted'.</span></span></code></pre></div>
<p>In this case, we were only interested in the top ranked rate result.
We can extract it using <code>summary</code> and the <code>pos</code>
and <code>export</code> inputs. We can see the converted
<code>area</code> input in <span class="math inline">\(m^2\)</span> in
the summary table.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">algae_rate_conv</span>, pos <span class="op">=</span> <span class="fl">1</span>, export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of converted rates from entered 'pos' rank(s):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime oxy endoxy   rate adjustment rate.adjusted rate.input oxy.unit time.unit volume mass  area  S  t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1         95.8   0.0911 0.849    27.8  59    980 0.98    16.3  96   97.3 0.0911     -0.007        0.0981     0.0981     %Air        hr    0.1   NA 0.001 30 12 1.01 0.000872          NA       0.872  mgO2/hr/m2       0.872</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>The exported data frame will contain all rate regression parameters
and data locations, adjustments (if applied), units, and more. This is a
great way of exporting all the relevant data for your final results.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
