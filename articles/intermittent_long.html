<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intermittent-flow respirometry: Long experiment • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Intermittent-flow respirometry: Long experiment">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Intermittent-flow respirometry: Long
experiment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/intermittent_long.Rmd" class="external-link"><code>vignettes/intermittent_long.Rmd</code></a></small>
      <div class="hidden name"><code>intermittent_long.Rmd</code></div>

    </div>

    
    
<p>This vignette shows a intermittent-flow analysis from a lengthy
experiment, with over 100 replicates and a background rate that changes
over the course of the experiment. This type of experiment is one many
fish physiologists in particular will be familiar with.</p>
<p>The example data (<code>zeb_intermittent.rd</code>) was kindly
provided by <a href="https://twitter.com/thambithuraid" class="external-link">Dr. Davide
Thambithurai</a>, and is from an experiment on a zebrafish. It is
comprised of one replicate of 14 minutes duration (12 minutes recording,
2 minutes flushing), followed by 105 replicates of 11 minutes duration
(9 minutes recording, 2 minutes flushing). In addition there are pre-
and post-experiment background recordings. See
<code><a href="../reference/zeb_intermittent.rd.html">help(zeb_intermittent.rd)</a></code> for row locations of all
stages.</p>
<p>See <code><a href="../articles/intermittent_short.html">vignette("intermittent_short")</a></code> for an example with a
smaller dataset, which covers in more detail the basics of analysing
intermittent-flow data and is a better starting point if you are new to
<code>respR</code> or analysing these types of experiment. Even if not,
we would recommend reading both before starting your analysis.</p>
<div class="section level2">
<h2 id="experiment-overview">Experiment overview<a class="anchor" aria-label="anchor" href="#experiment-overview"></a>
</h2>
<p>From this experiment dataset we want to extract several metrics:</p>
<ol style="list-style-type: decimal">
<li><p><em>Pre- and post-experiment background rates</em>. Background
rates were recorded at the start and end of the experiment (initial and
end sections with shallow slopes). This was a lengthy experiment in high
temperatures, and so the microbial background rate increases
substantially over the course of the experiment. We will assume this
increase is constant (i.e. linear), and each replicate rate will be
adjusted with a background rate calculated according its time within the
experiment. That is, later replicates will be adjusted by a greater
amount.</p></li>
<li><p><em>Maximum metabolic rate (MMR)</em>. Before this experiment the
fish had been exercised to exhaustion, then immediately placed in the
respirometer. The first replicate during which it is recovering from the
accrued oxygen debt will represent MMR.</p></li>
<li><p><em>Routine metabolic rate (RMR)</em>. This will be calculated
using the later replicates once the animal has recovered from the
exercise. This is generally defined as the routine use of oxygen to fuel
basal metabolism and minor spontaneous movements for maintaining station
or posture.</p></li>
<li><p><em>Standard metabolic rate (SMR)</em>. Sometimes also known as
basal or minimum metabolic rate. This is also calculated using the later
replicates once the animal has recovered. This is generally defined as
the lowest oxygen use rates observed, which are representative of the
requirements of basal metabolism only.</p></li>
</ol>
<p>Which of these last two metrics is valid or appropriate to report
depends on the organism and the circumstances and aims of the
experiments. Their definitions are widely debated, and there is a huge
literature on the differences between these physiological metrics. See
<a href="https://januarharianto.github.io/respR/articles/refs.html#references">here</a>
for some papers discussing these. Here, we will show how to extract what
may be regarded as both RMR and SMR from this dataset.</p>
</div>
<div class="section level2">
<h2 id="analysis">Analysis methods<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>Extracting the <a href="#background">background</a> rates and <a href="#mmr">MMR</a> are relatively straightforward and will be covered
in their own sections.</p>
<p>After this, we will show two different approaches to extract RMR and
SMR using <code>respR</code> functions. The <a href="#crint">first</a>
uses the dedicated <code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code> function to run
<code>calc_rate</code> on each replicate to extract a rate from the same
data region of each, before filtering these to get the RMR. The <a href="#arint">second</a> uses the dedicated <code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code>
function to run <code>auto_rate</code> on each replicate to extract the
lowest rate from each of a specified width, before filtering these to
get the SMR.</p>
<p><strong><em>Please note</em></strong>: You should not simply copy and
repeat the following code on your own data. They are examples to show
how the <code>respR</code> functions are adaptable and flexible and how
rates can be extracted, filtered and selected to arrive at a final
reportable rate in a variety of ways. They are not recommendations that
you should use these specific approaches for particular outputs. There
is a <a href="https://januarharianto.github.io/respR/articles/refs.html#references">massive
literature</a> around respirometry, the different physiological metrics,
and how to quantify them. Before analysis of your own data you should
familiarise yourself with it, with similar experiments in the
literature, and the current state of best practices in the field. Many
factors such as appropriate regions or widths to extract rates from,
method used to extract rates, and final selection criteria differ
between experiments for very good reasons, in that every study is
different. It is important to select appropriate analysis factors
objectively and report them in your methods. See especially <a href="https://journals.biologists.com/jeb/article/224/18/jeb242522/272132/Guidelines-for-reporting-methods-to-estimate" class="external-link">Killen
et al. (2021)</a> and <a href="https://januarharianto.github.io/respR/articles/refs.html#references">Prinzing
et al. (2021)</a>.</p>
<p>Note we use the native pipe operator (<code>|&gt;</code>) introduced
in <a href="https://www.r-bloggers.com/2021/05/new-features-in-r-4-1-0/" class="external-link">R
v4.1</a> for much of the following. These can be substituted for
<code>dpylr</code> pipes (<code>%&gt;%</code>) if you have not yet
updated, or alternatively save output objects and enter them into the
next function.</p>
</div>
<div class="section level2">
<h2 id="inspecting">Inspecting the data<a class="anchor" aria-label="anchor" href="#inspecting"></a>
</h2>
<p><code><a href="../reference/inspect.html">inspect()</a></code> is the general <code>respR</code> function for
visualising and inspecting data prior to analysis, and saving it to an
object that can be used in subsequent functions. This is a very large
dataset (nearly 80,000 rows), so if running the code in this vignette
note that operations may take some time.</p>
<p>Before progressing, we’ll inspect a portion of the data at the start
without saving the result to show the structure.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_intermittent.rd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">18000</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The top plot shows the initial background recording up to row 5000,
the first replicate of 14 minutes duration to determine MMR, followed by
replicates of 11 minutes duration. We can see in these oxygen
decreasing, separated by regular flushes where it increases back to
ambient levels. The bottom plot, a rolling rate across a window of 10%
of the data, is not particularly useful as this window will include
multiple replicates.</p>
<p>We can similarly have a quick look at the end of the dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_intermittent.rd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">65000</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We can see that by the end of the experiment the replicates are much
more regular, suggesting rates have stabilised, and we can also see the
end background recording. This time we passed a different
<code>width</code> to <code>inspect</code>, so the rolling rate plot is
across a 1% window. This makes it slightly more useful, and we can see
within each replicate rates seem to be consistent at around -0.0025,
while the background rate is much lower and closer to zero (dashed
line).</p>
<p>Now that we are fairly satisfied the experiment looks as expected we
can inspect the entire dataset and this time save the result to an
object we will use for the rest of the analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here because the dataset is so large the plots are of limited use,
but we can at least see that much more oxygen was used in the early
replicates, as would be expected because the specimen was exercised
prior to the experiment, after which they stabilise and are more
regular.</p>
</div>
<div class="section level2">
<h2 id="background">Background rates<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>The initial and end sections of the data will be used to calculate
background rates and how they change over the course of the experiment.
Timepoints of these will typically have been recorded as part of the
experiment, so can be used to subset the relevant sections (see
<code><a href="../reference/zeb_intermittent.rd.html">?zeb_intermittent.rd</a></code> for row locations of all stages).</p>
<p>We subset these regions from the <code>inspect</code> object we just
saved above, and save them as separate <code>calc_rate.bg</code>
objects.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bg_pre</span> <span class="op">&lt;-</span> <span class="va">zeb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">4999</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bg_post</span> <span class="op">&lt;-</span> <span class="va">zeb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">75140</span>, to <span class="op">=</span> <span class="fl">79251</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The two different background rates (only the post-experiment plot is
shown above) have been saved to these two objects. We can see the actual
values by printing them:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bg_pre</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.bg # ------------------</span></span>
<span><span class="co">#&gt; Background rate(s):</span></span>
<span><span class="co">#&gt; [1] -0.0000742</span></span>
<span><span class="co">#&gt; Mean background rate:</span></span>
<span><span class="co">#&gt; [1] -0.0000742</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bg_post</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.bg # ------------------</span></span>
<span><span class="co">#&gt; Background rate(s):</span></span>
<span><span class="co">#&gt; [1] -0.0001217</span></span>
<span><span class="co">#&gt; Mean background rate:</span></span>
<span><span class="co">#&gt; [1] -0.0001217</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>We can see the background rate increases by around 70% over the
course of the experiment. We will use these later to apply a dynamic
background adjustment to specimen rates based on their time during the
experiment.</p>
</div>
<div class="section level2">
<h2 id="mmr">MMR<a class="anchor" aria-label="anchor" href="#mmr"></a>
</h2>
<p>Here we calculate maximum metabolic rate (MMR) from the first
replicate. This replicate is longer than the others; 14 mins (840 rows)
vs. 11 mins (660 rows) for all others.</p>
<div class="section level3">
<h3 id="mmrsubset">Subset<a class="anchor" aria-label="anchor" href="#mmrsubset"></a>
</h3>
<p>Here, we subset the first replicate which starts at row 5000 and is
14 minutes long (840 rows) to a separate <code>inspect</code> object,
excluding the two minutes of flush (120 rows) at the end, and plot it to
see how the rate changes over the replicate.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset rep 1</span></span>
<span><span class="va">zeb_rep_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb</span>, </span>
<span>                         from <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                         to <span class="op">=</span> <span class="fl">5000</span> <span class="op">+</span> <span class="fl">840</span> <span class="op">-</span> <span class="fl">120</span>, </span>
<span>                         by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In this replicate, the rolling rate plot shows that calculated at
this particular <code>width</code>, the rate declines rapidly from
around -0.012 to around -0.008, then declines more slowly over the
course of the replicate (note we pass a higher <code>width</code> than
the default 0.1 to smooth the rolling rate a little more). This is as we
would expect from an animal recovering from exercise. However the very
initial stages of replicates are often unstable and excluded from rate
analysis (usually known as the “wait” phase). Therefore we will probably
want to extract our MMR rate after this initial stage but before it
declines too much.</p>
</div>
<div class="section level3">
<h3 id="extract-rates">Extract rates<a class="anchor" aria-label="anchor" href="#extract-rates"></a>
</h3>
<p>We will show three different ways of extracting what could be defined
as an MMR. First, we will use <code><a href="../reference/calc_rate.html">calc_rate()</a></code> to extract a rate
from a single specific region. Secondly, we will use the
<code>auto_rate</code> <code>"highest"</code> method to automatically
extract the highest rate of a specific width. Lastly, we will use the
<code>auto_rate</code> <code>"linear"</code> method with the default
inputs to identify linear regions of the data and choose the highest
from amongst these. In this last example we will also show how to adjust
and convert rates, then filter them using <code><a href="../reference/select_rate.html">select_rate()</a></code> to
arrive at a final reportable result.</p>
</div>
<div class="section level3">
<h3 id="calc_rate">1. <code>calc_rate</code><a class="anchor" aria-label="anchor" href="#calc_rate"></a>
</h3>
<p>This function (see <code><a href="../articles/calc_rate.html">vignette("calc_rate")</a></code>) simply allows
you to extract a rate (or multiple rates) from a specified row, time, or
oxygen region. In the <a href="#crint">later example</a> for extracting
rates from the other replicates using <code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code> we
use the same three minute <code>wait</code> phase and five minute
<code>measure</code> phase in each replicate. We will use the same here
to allow for comparison with those rates. This is fairly common practice
in respirometry studies and perfectly acceptable, in that it is
objective and consistent.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_mmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">zeb_rep_1</span>,</span>
<span>                     from <span class="op">=</span> <span class="fl">180</span>, <span class="co"># three minutes 'wait' after start</span></span>
<span>                     to <span class="op">=</span> <span class="fl">480</span>,   <span class="co"># five minutes later = 'measure' phase</span></span>
<span>                     by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq row endrow time endtime  oxy endoxy rate.2pt     rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         39.5 -0.00647 0.995 180    480 5179    5479 6.03   4.08 -0.00653 -0.00647</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>We can see the rate as the final column in summary, and this would be
perfectly acceptable to report as the MMR as long as the analysis
criteria were also included. See <a href="#opt3">option 3</a> for how to
adjust and convert the rate.</p>
</div>
<div class="section level3">
<h3 id="auto_rate-method-highest">2. <code>auto_rate</code> <code>method = "highest"</code><a class="anchor" aria-label="anchor" href="#auto_rate-method-highest"></a>
</h3>
<p><code>auto_rate</code> also allows you to also extract rates of a
specific time or row width, but in contrast to <code>calc_rate</code> it
calculates <em>every</em> rate of this width across the dataset and then
orders them in various ways. One method is to order by highest absolute
value to get the highest uptake rate.</p>
<p>Here we run this method and choose a <code>width</code> of two
minutes (120 rows), that is the function will calculate every rate of
this width and order them from highest to lowest. We use the same three
minute <code>wait</code> phase to exclude the initial part of the
replicate, and for that we use <code><a href="../reference/subset_data.html">subset_data()</a></code> to remove the
first 180 rows, then pipe the output to <code>auto_rate</code> (we could
also have done this when we first subset and inspected the data <a href="#mmrsubset">above</a>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_mmr</span> <span class="op">&lt;-</span> <span class="va">zeb_rep_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">180</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"highest"</span>,</span>
<span>            width <span class="op">=</span> <span class="fl">120</span>,</span>
<span>            by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.auto_rate # -------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Summary of Results by Highest Rate ===</span></span>
<span><span class="co">#&gt;      rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy     rate</span></span>
<span><span class="co">#&gt;   1:  NA    1         43.3 -0.00719 0.984      NA  10    129 5188    5307 5.96   5.14 -0.00719</span></span>
<span><span class="co">#&gt;   2:  NA    2         43.2 -0.00718 0.984      NA   9    128 5187    5306 5.98   5.11 -0.00718</span></span>
<span><span class="co">#&gt;   3:  NA    3         43.2 -0.00718 0.984      NA  11    130 5189    5308 6.04   5.17 -0.00718</span></span>
<span><span class="co">#&gt;   4:  NA    4         43.2 -0.00717 0.984      NA  14    133 5192    5311 5.93   5.07 -0.00717</span></span>
<span><span class="co">#&gt;   5:  NA    5         43.2 -0.00717 0.984      NA  15    134 5193    5312 5.94   5.14 -0.00717</span></span>
<span><span class="co">#&gt;  ---                                                                                          </span></span>
<span><span class="co">#&gt; 419:  NA  419         31.7 -0.00505 0.971      NA 420    539 5598    5717 3.41   2.84 -0.00505</span></span>
<span><span class="co">#&gt; 420:  NA  420         31.7 -0.00505 0.971      NA 419    538 5597    5716 3.37   2.79 -0.00505</span></span>
<span><span class="co">#&gt; 421:  NA  421         31.6 -0.00503 0.971      NA 423    542 5601    5720 3.37   2.79 -0.00503</span></span>
<span><span class="co">#&gt; 422:  NA  422         31.6 -0.00503 0.971      NA 421    540 5599    5718 3.44   2.84 -0.00503</span></span>
<span><span class="co">#&gt; 423:  NA  423         31.6 -0.00503 0.971      NA 422    541 5600    5719 3.39   2.77 -0.00503</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions : 423 | Results : 423 | Method : highest | Roll width : 120 | Roll type : row </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>We have already seen that rates are high at the start and then
decline across the replicate, so it’s not a surprise that the highest
rates are from early in the replicate. We can see our MMR under these
criteria would be the first row of this summary table. See next section
for how these multiple rates can be adjusted, converted, and filtered to
get a final output rate.</p>
</div>
<div class="section level3">
<h3 id="opt3">3. <code>auto_rate</code> <code>method = "linear"</code><a class="anchor" aria-label="anchor" href="#opt3"></a>
</h3>
<p>Here we simply run <code>auto_rate</code> and let the default inputs
be applied to find the linear regions of the data. Be sure to read
<code><a href="../reference/auto_rate.html">help("auto_rate")</a></code> and <code><a href="../articles/auto_rate.html">vignette("auto_rate")</a></code> to
understand what this method does, appropriate inputs and how to modify
the defaults. We again subset the data to remove the initial 3
minutes.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_mmr</span> <span class="op">&lt;-</span> <span class="va">zeb_rep_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">180</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.auto_rate # -------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Summary of Results by Kernel Density Rank ===</span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy     rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         36.3 -0.00588 0.996    1199 122    450 5300    5628 5.20   3.27 -0.00588</span></span>
<span><span class="co">#&gt; 2:  NA    2         32.0 -0.00511 0.981     644 394    541 5572    5719 3.56   2.77 -0.00511</span></span>
<span><span class="co">#&gt; 3:  NA    3         37.6 -0.00612 0.991     425 102    304 5280    5482 5.35   4.10 -0.00612</span></span>
<span><span class="co">#&gt; 4:  NA    4         37.6 -0.00612 0.991     420 101    304 5279    5482 5.31   4.10 -0.00612</span></span>
<span><span class="co">#&gt; 5:  NA    5         42.9 -0.00711 0.979     417   4    111 5182    5289 6.04   5.22 -0.00711</span></span>
<span><span class="co">#&gt; 6:  NA    6         41.1 -0.00678 0.985     412  52    184 5230    5362 5.63   4.84 -0.00678</span></span>
<span><span class="co">#&gt; 7:  NA    7         36.7 -0.00595 0.986     405 305    451 5483    5629 4.15   3.19 -0.00595</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions : 435 | Results : 7 | Method : linear | Roll width : 108 | Roll type : row </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>The function has found seven linear regions. All of these rates are
valid results depending on the question being asked, in that they have
been found to be linear regions, and so of consistently sustained rates.
In this case, since we are interested in the maximum rate, the fifth
ranked result has the highest <code>rate</code> value, and comes from
early in the replicate, so is probably the result we are most interested
in. We can plot it using <code>pos</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_mmr</span>, pos <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Many aspects will feed into rate selection criteria for a specific
experiment or study, and it depends on these whether this in an
acceptable, reportable result. Maybe at less than 2 minutes this is not
a long enough duration for us to be comfortable that this was a
sustained MMR. In which case perhaps one of the other results is better
reported. Or maybe we could report an average of some of the rates, such
as the top three. The important thing is to apply these selection
criteria consistently and report them alongside results.</p>
<div class="section level4">
<h4 id="width">Changing the <code>width</code><a class="anchor" aria-label="anchor" href="#width"></a>
</h4>
<p>These are all valid options, as long as they are reported. However,
we can also change the analysis parameters. The <code>width</code> input
in <code>auto_rate</code> determines the width of the rolling
regressions used to find linear regions. See <code><a href="../reference/auto_rate.html">auto_rate()</a></code>
and other vignettes for full details, but briefly in the case of the
<code>"linear"</code> method this is the starting point for the
analysis. Resulting regressions will vary in width, but in general the
minimum width will be increased by increasing the <code>width</code>.
The default value is 0.2, representing 20% of the data length. Here,
with 10 minutes of data this would represent 2 minutes, which is quite a
brief time window. So instead we will increase this to 0.5 (it can also
be specified in the units of the <code>"by"</code> input).</p>
<p>See <a href="https://januarharianto.github.io/respR/articles/refs.html#references">Prinzing
et al. (2021)</a> for an excellent discussion of appropriate widths in
rolling regressions to determine MMR.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_mmr</span> <span class="op">&lt;-</span> <span class="va">zeb_rep_1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">180</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.auto_rate # -------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Summary of Results by Kernel Density Rank ===</span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy     rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         36.2 -0.00586 0.996    4258 146    447 5324    5625 5.03   3.30 -0.00586</span></span>
<span><span class="co">#&gt; 2:  NA    2         34.6 -0.00556 0.993    1231 260    517 5438    5695 4.33   2.93 -0.00556</span></span>
<span><span class="co">#&gt; 3:  NA    3         36.6 -0.00592 0.993     963 119    363 5297    5541 5.21   3.75 -0.00592</span></span>
<span><span class="co">#&gt; 4:  NA    4         34.6 -0.00557 0.993     900 259    514 5437    5692 4.36   2.96 -0.00557</span></span>
<span><span class="co">#&gt; 5:  NA    5         39.3 -0.00642 0.994     738  31    277 5209    5455 5.86   4.21 -0.00642</span></span>
<span><span class="co">#&gt; 6:  NA    6         38.5 -0.00629 0.993     731  55    296 5233    5474 5.65   4.10 -0.00629</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions : 272 | Results : 6 | Method : linear | Roll width : 271 | Roll type : row </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Now we have six results varying between 4 and 5 minutes duration, and
they are much more consistent in rate value. In this case the fifth
result has the highest rate, is early in the replicate, and so is likely
a good estimation of MMR. Note how the rolling rate plot is smoother
with this higher width.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_mmr</span>, pos <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
<p>With non-linear data like this, such as from an animal recovering
from exercise, increasing the width over which a rate is determined will
necessarily decrease the rate values. The researcher needs to keep this
in mind, and find a balance between a width that provides a good
estimation of the specimen’s physiological state, but also is not
affected by other factors such as data noise or anomalies. Most
importantly, these decisions and criteria should be reported.</p>
<p>High width values can lead to overfitting and mis-estimation of
rates, and low widths underfitting and rate values which are too
sensitive to data noise. See <a href="https://januarharianto.github.io/respR/articles/auto_rate.html#width">here</a>
for discussion of this in the context of <code>auto_rate</code>, and how
to choose an appropriate <code>width</code>. We recommend reading <a href="https://januarharianto.github.io/respR/articles/refs.html#references">Prinzing
et al. (2021)</a> to understand the nuances of determining MMR and
regression widths. See also <a href="https://januarharianto.github.io/respR/articles/refs.html#references">Killen
et al. (2021)</a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="adjust">Adjust<a class="anchor" aria-label="anchor" href="#adjust"></a>
</h3>
<p>The <code><a href="../reference/adjust_rate.html">adjust_rate()</a></code> function allows rates to be background
adjusted in a number of ways. See <code><a href="../articles/adjust_rate.html">vignette("adjust_rate")</a></code>
for examples. Here we will use it to apply a dynamic linear correction
using the start and end background rates we determined <a href="#background">earlier</a>. Essentially this calculates the
appropriate background adjustment for a rate using the time at which it
was determined, assuming the background rate increases linearly from the
pre- to post-experiment values.</p>
<p>For MMR, we will adjust the results from option 3 above, but this
will work with the other options also. We have our saved
<code>auto_rate</code> object, so it’s relatively easy to adjust. We
just need to enter the two background rate objects we saved earlier and
specify the method.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_mmr_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">zeb_mmr</span>, </span>
<span>                           by <span class="op">=</span> <span class="va">bg_pre</span>,     <span class="co"># first background rate</span></span>
<span>                           by2 <span class="op">=</span> <span class="va">bg_post</span>,   <span class="co"># second background rate</span></span>
<span>                           method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="co">#&gt; adjust_rate: Rate adjustments applied using "linear" method.</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_mmr_adj</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.adjust_rate # -----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using 'linear' method.</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy     rate adjustment rate.adjusted</span></span>
<span><span class="co">#&gt; 1:  NA    1         36.2 -0.00586 0.996    4258 146    447 5324    5625 5.03   3.30 -0.00586 -0.0000761      -0.00578</span></span>
<span><span class="co">#&gt; 2:  NA    2         34.6 -0.00556 0.993    1231 260    517 5438    5695 4.33   2.93 -0.00556 -0.0000761      -0.00549</span></span>
<span><span class="co">#&gt; 3:  NA    3         36.6 -0.00592 0.993     963 119    363 5297    5541 5.21   3.75 -0.00592 -0.0000760      -0.00585</span></span>
<span><span class="co">#&gt; 4:  NA    4         34.6 -0.00557 0.993     900 259    514 5437    5692 4.36   2.96 -0.00557 -0.0000761      -0.00550</span></span>
<span><span class="co">#&gt; 5:  NA    5         39.3 -0.00642 0.994     738  31    277 5209    5455 5.86   4.21 -0.00642 -0.0000760      -0.00635</span></span>
<span><span class="co">#&gt; 6:  NA    6         38.5 -0.00629 0.993     731  55    296 5233    5474 5.65   4.10 -0.00629 -0.0000760      -0.00622</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>There are several things to note here. We can see the ultimate
<code>adjustment</code> value is small in comparison to the rate of the
specimen, as it should be in most experiments. Also, the adjustment
values differ slightly; they are lower for rates that come from the
start of the replicate. This is what we would expect because we are
assuming the background rate is increasing over time.
<code>adjust_rate</code> uses the midpoint time of each rate regression
to calculate the appropriate adjustment value, so earlier rates will
have a lower background adjustment. Lastly, the adjustments are very
close in value to the pre-experiment background rate of
<code>-0.0000742</code> we established <a href="#background">earlier</a>. Again, this is what we would expect
because this is the first replicate and conducted just after the first
background recording. If we are assuming there is a linear increase in
background rate over time this would mean they should be very close in
value.</p>
<p>See later <a href="#crintadj">section</a> for how adjustment values
differ in other replicates.</p>
</div>
<div class="section level3">
<h3 id="convert">Convert<a class="anchor" aria-label="anchor" href="#convert"></a>
</h3>
<p>Now that the rates have been adjusted we can convert them to units.
This will convert every rate in the object.</p>
<p>The <code>convert_rate</code> function can output rates as
<em>absolute</em>, that is of the whole animal or chamber,
<em>mass-specific</em> if a <code>mass</code> is entered, or
<em>area-specific</em> if an <code>area</code> is entered. The
<code>output.unit</code> should be correctly formatted for whichever of
these are chosen, that is in the order Oxygen/Time, Oxygen/Time/Mass, or
Oxygen/Time/Area.</p>
<p>Note the <code>volume</code> input is volume of water in the
respirometer, <em>not the volume of the respirometer</em>. That is, it
represents the <em>effective volume</em>. A specimen will displace some
of the water, therefore this is the volume of the respirometer minus the
volume of the specimen. There are several approaches to calculate the
effective volume or specimen volume: geometrically; through displacement
in a separate vessel; or calculated from the mass and density. For
example, fish are often assumed to have an equal density as water (~1000
kg/m^3), so their mass is measured, converted to volume and subtracted
from the respirometer volume. Volume could also be determined directly
by pouring out and measuring the water at the end of the experiment, or
by weighing the respirometer. See the <a href="https://github.com/nicholascarey/respfun" class="external-link"><code>respfun</code></a>
respirometry utilities package for functions to calculate the effective
volume and convert water mass to volume.</p>
<p>Here we use the <code>adjust_rate</code> object saved in the previous
step, and we’ll convert to a mass-specific rate.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_mmr_adj_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">zeb_mmr_adj</span>,</span>
<span>                                 oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,       <span class="co"># oxygen units of the original raw data</span></span>
<span>                                 time.unit <span class="op">=</span> <span class="st">"secs"</span>,      <span class="co"># time units of the original raw data</span></span>
<span>                                 output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,  <span class="co"># desired output unit</span></span>
<span>                                 volume <span class="op">=</span> <span class="fl">0.12</span>,           <span class="co"># effective volume of the respirometer in L</span></span>
<span>                                 mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span>           <span class="co"># mass of the specimen in kg</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_mmr_adj_conv</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1         36.2 -0.00586 0.996    4258 146    447 5324    5625 5.03   3.30 -0.00586 -0.0000761      -0.00578   -0.00578     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.50       -2.78          NA   mgO2/hr/g       -2.78</span></span>
<span><span class="co">#&gt; 2:  NA    2         34.6 -0.00556 0.993    1231 260    517 5438    5695 4.33   2.93 -0.00556 -0.0000761      -0.00549   -0.00549     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.37       -2.63          NA   mgO2/hr/g       -2.63</span></span>
<span><span class="co">#&gt; 3:  NA    3         36.6 -0.00592 0.993     963 119    363 5297    5541 5.21   3.75 -0.00592 -0.0000760      -0.00585   -0.00585     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.53       -2.81          NA   mgO2/hr/g       -2.81</span></span>
<span><span class="co">#&gt; 4:  NA    4         34.6 -0.00557 0.993     900 259    514 5437    5692 4.36   2.96 -0.00557 -0.0000761      -0.00550   -0.00550     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.37       -2.64          NA   mgO2/hr/g       -2.64</span></span>
<span><span class="co">#&gt; 5:  NA    5         39.3 -0.00642 0.994     738  31    277 5209    5455 5.86   4.21 -0.00642 -0.0000760      -0.00635   -0.00635     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.74       -3.05          NA   mgO2/hr/g       -3.05</span></span>
<span><span class="co">#&gt; 6:  NA    6         38.5 -0.00629 0.993     731  55    296 5233    5474 5.65   4.10 -0.00629 -0.0000760      -0.00622   -0.00622     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.69       -2.98          NA   mgO2/hr/g       -2.98</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>The <code>$summary</code> table contains all rate regression
parameters and data locations, adjustments (if applied), units, and
more. In fact it contains <em>all</em> relevant information about the
analysis and is a great way of saving the results, especially using the
<code>export = TRUE</code> input to save it as a data frame. One handy
tip: you may want to enter <code>S</code>, <code>t</code>, and
<code>P</code> even if they are not required for conversions to the
output rate unit because they are saved in the <code>$summary</code>
table, and this can help in keeping track of results across different
experiments. Note the <code>row</code> and <code>endrow</code> columns
will refer to rows of the most recent subset of the data, however the
<code>time</code> and <code>endtime</code> will always refer back to the
time values of original raw data.</p>
</div>
<div class="section level3">
<h3 id="select">Select<a class="anchor" aria-label="anchor" href="#select"></a>
</h3>
<p>The last analysis step is to select our final reportable MMR from the
multiple rates we determined using the <code>linear</code> method. We
saw <a href="#width">earlier</a> that after changing some analysis
parameters one of the MMR rates, the 5th in the summary table, was
higher than the others.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_mmr_adj_conv</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1         36.2 -0.00586 0.996    4258 146    447 5324    5625 5.03   3.30 -0.00586 -0.0000761      -0.00578   -0.00578     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.50       -2.78          NA   mgO2/hr/g       -2.78</span></span>
<span><span class="co">#&gt; 2:  NA    2         34.6 -0.00556 0.993    1231 260    517 5438    5695 4.33   2.93 -0.00556 -0.0000761      -0.00549   -0.00549     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.37       -2.63          NA   mgO2/hr/g       -2.63</span></span>
<span><span class="co">#&gt; 3:  NA    3         36.6 -0.00592 0.993     963 119    363 5297    5541 5.21   3.75 -0.00592 -0.0000760      -0.00585   -0.00585     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.53       -2.81          NA   mgO2/hr/g       -2.81</span></span>
<span><span class="co">#&gt; 4:  NA    4         34.6 -0.00557 0.993     900 259    514 5437    5692 4.36   2.96 -0.00557 -0.0000761      -0.00550   -0.00550     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.37       -2.64          NA   mgO2/hr/g       -2.64</span></span>
<span><span class="co">#&gt; 5:  NA    5         39.3 -0.00642 0.994     738  31    277 5209    5455 5.86   4.21 -0.00642 -0.0000760      -0.00635   -0.00635     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.74       -3.05          NA   mgO2/hr/g       -3.05</span></span>
<span><span class="co">#&gt; 6:  NA    6         38.5 -0.00629 0.993     731  55    296 5233    5474 5.65   4.10 -0.00629 -0.0000760      -0.00622   -0.00622     mg/L       sec   0.12 0.0009   NA NA NA NA    -2.69       -2.98          NA   mgO2/hr/g       -2.98</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>In this case, we could fairly confidently report this as our MMR of
-3.05 mg/h/g. However, the <code><a href="../reference/select_rate.html">select_rate()</a></code> function allows
you to filter rates by applying selection criteria. This example will
select and extract the highest <code>n</code> rates to a new object, in
this case the highest single rate. This is quite a simplistic example,
but see later and <code><a href="../articles/select_rate.html">vignette("select_rate")</a></code> for more advanced
examples including how to apply multiple criteria.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span><span class="va">zeb_mmr_adj_conv</span>,</span>
<span>                   method <span class="op">=</span> <span class="st">"highest"</span>,</span>
<span>                   n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; select_rate: Selecting highest 1 *absolute* rate values...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 5 rate(s) removed, 1 rate(s) remaining -----</span></span></code></pre></div>
<p>If we need to save any of the other regression data for this rate,
<code>summary</code> has additional inputs that are useful:
<code>pos</code> allows specific rows of summary tables to be extracted,
and <code>export</code> allows it to be saved as a separate data frame.
Here, we’ll use this on the final object to export the coefficients and
other data for this rate.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmr_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">MMR</span>, export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmr_results</span></span>
<span><span class="co">#&gt;      rep  rank intercept_b0 slope_b1   rsq density   row endrow  time endtime   oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass   area      S      t      P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;    &lt;num&gt; &lt;int&gt;        &lt;num&gt;    &lt;num&gt; &lt;num&gt;   &lt;num&gt; &lt;int&gt;  &lt;int&gt; &lt;num&gt;   &lt;num&gt; &lt;num&gt;  &lt;num&gt;    &lt;num&gt;      &lt;num&gt;         &lt;num&gt;      &lt;num&gt;   &lt;char&gt;    &lt;char&gt;  &lt;num&gt;  &lt;num&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;    &lt;num&gt;       &lt;num&gt;      &lt;lgcl&gt;      &lt;char&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    NA     5         39.3 -0.00642 0.994     738    31    277  5209    5455  5.86   4.21 -0.00642  -0.000076      -0.00635   -0.00635     mg/L       sec   0.12 0.0009     NA     NA     NA     NA    -2.74       -3.05          NA   mgO2/hr/g       -3.05</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="complete-mmr-analysis">Complete MMR analysis<a class="anchor" aria-label="anchor" href="#complete-mmr-analysis"></a>
</h3>
<p>This is the complete analysis we have just conducted to get MMR.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmr_results</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">zeb_rep_1</span> <span class="op">|&gt;</span>                              <span class="co"># using the inspected replicate 1 data...</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">180</span>, </span>
<span>              by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span>                <span class="co"># subset to apply a 'wait' period</span></span>
<span>  <span class="fu"><a href="../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span>                 <span class="co"># use auto_rate to get most linear regions</span></span>
<span>  <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">bg_pre</span>, </span>
<span>              by2 <span class="op">=</span> <span class="va">bg_post</span>, </span>
<span>              method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span> <span class="op">|&gt;</span>         <span class="co"># adjust</span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>, </span>
<span>               time.unit <span class="op">=</span> <span class="st">"secs"</span>, </span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>, </span>
<span>               volume <span class="op">=</span> <span class="fl">0.12</span>, </span>
<span>               mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span> <span class="op">|&gt;</span>            <span class="co"># convert</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"highest"</span>, </span>
<span>              n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span>                     <span class="co"># select highest rate </span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span>export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>                    <span class="co"># final reportable result</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;      rep  rank intercept_b0 slope_b1   rsq density   row endrow  time endtime   oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass   area      S      t      P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;    &lt;num&gt; &lt;int&gt;        &lt;num&gt;    &lt;num&gt; &lt;num&gt;   &lt;num&gt; &lt;int&gt;  &lt;int&gt; &lt;num&gt;   &lt;num&gt; &lt;num&gt;  &lt;num&gt;    &lt;num&gt;      &lt;num&gt;         &lt;num&gt;      &lt;num&gt;   &lt;char&gt;    &lt;char&gt;  &lt;num&gt;  &lt;num&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;    &lt;num&gt;       &lt;num&gt;      &lt;lgcl&gt;      &lt;char&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:    NA     5         39.3 -0.00642 0.994     738    31    277  5209    5455  5.86   4.21 -0.00642  -0.000076      -0.00635   -0.00635     mg/L       sec   0.12 0.0009     NA     NA     NA     NA    -2.74       -3.05          NA   mgO2/hr/g       -3.05</span></span></code></pre>
<p>This allows you to document all analysis parameters and rate
selection criteria so that they can be consistently applied and reported
alongside the results. See <a href="#report">Reporting</a> section for
how analyses might be reported concisely in text.</p>
</div>
</div>
<div class="section level2">
<h2 id="rmr">RMR<a class="anchor" aria-label="anchor" href="#rmr"></a>
</h2>
<div class="section level3">
<h3 id="crint">
<code>calc_rate.int</code><a class="anchor" aria-label="anchor" href="#crint"></a>
</h3>
<p>To extract a rate from every replicate and calculate a routine
metabolic rate (RMR) from amongst the results we will use
<code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code>. To repeat the note from <a href="#analysis">above</a>, this is not a recommendation that this is
how you should extract an RMR from your own data; it is simply an
example of one approach and how the <code>respR</code> functions are
flexible and adaptable. <code>calc_rate.int</code> was introduced in <a href="https://januarharianto.github.io/respR/articles/release_notes.html#version-2-1-2022-12-06"><code>respR v2.1</code></a>
and allows you to specify a replicate structure and run
<code>calc_rate</code> on each replicate to extract a rate from the same
time or row region in each. See <code><a href="../articles/calc_rate.int.html">vignette("calc_rate.int")</a></code>
for details of the functionality.</p>
<p>The difference between this and the approach <a href="#arint">below</a> using <code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code> is that you
specify a region over which to calculate a rate, and this will be the
same in each replicate. This takes away some of the objectivity in
determining rates that <code>auto_rate</code> allows for, but as long as
selection criteria are reported and applied consistently is a perfectly
valid way of processing intermittent-flow data.</p>
<p>We’ve shown above how to get background rates and MMR, so we will use
<code>calc_rate.int</code> to extract a rate from the same region of
each replicate and filter these rates to report an RMR. In these data,
after the first replicate of 14 minutes duration for <a href="#mmr">MMR</a> there is a regular structure of 105 replicates of 11
minutes duration including the flush.</p>
</div>
<div class="section level3">
<h3 id="subset-data">Subset data<a class="anchor" aria-label="anchor" href="#subset-data"></a>
</h3>
<p>In the examples <a href="https://januarharianto.github.io/respR/articles/intermittent_short.html">here</a>
we had to specify the start and end location of every replicate in
<code>calc_rate.int</code>. However, if replicates cycle at a regular
interval we can simply enter this as <code>starts</code>. This tells the
function that starting from row 1 replicates cycle at this regular
interval, and it can be entered as a row interval or a duration in time,
as specified using the <code>by</code> input. We only need to subset the
data so that the first replicate starts at row 1 before passing it to
<code>calc_rate.int</code>.</p>
<p>We start by subsetting the data so that the 105 regularly-spaced
replicates start at row 1, that is we exclude the starting background
recording, the first replicate for MMR, and the end background
recording. We then <code>inspect</code> it.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_insp</span> <span class="op">&lt;-</span> <span class="va">zeb_intermittent.rd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">5840</span>, </span>
<span>              to <span class="op">=</span> <span class="fl">75139</span>,</span>
<span>              by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="extract-rates-1">Extract rates<a class="anchor" aria-label="anchor" href="#extract-rates-1"></a>
</h3>
<p>Now we run <code>calc_rate.int</code> and specify a 660 row interval
between replicates using <code>starts</code>. We’ll calculate a rate
across the same five minute time period in each replicate, from three
minutes to eight minutes. To do this we specify a 180 row
<code>wait</code> phase and 300 row <code>measure</code> phase.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_cr.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">zeb_insp</span>,</span>
<span>                            starts <span class="op">=</span> <span class="fl">660</span>,</span>
<span>                            wait <span class="op">=</span> <span class="fl">180</span>,</span>
<span>                            measure <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                            by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span></span>
<span><span class="co">#&gt; plot.calc_rate.int: Plotting first 20 selected reps only. To plot others modify 'pos' input.</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-25-1.png" width="960" style="display: block; margin: auto;">
By default the function plots the first 20 replicates (<code>pos</code>
can be used to choose others up to a maximum of 20). Note how the lower
time axis has the actual raw data time values, but the top row axis
refers to the rows of each replicate subset. In these plots the rate
data is the yellow points, the red shaded region is the
<code>wait</code> phase, and the green shaded region the
<code>measure</code> phase.</p>
<p>We can use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to view the results.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_cr.int</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of all replicate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      rep rank intercept_b0 slope_b1   rsq   row endrow  time endtime  oxy endoxy rate.2pt     rate</span></span>
<span><span class="co">#&gt;   1:   1    1         53.3 -0.00786 0.995   181    480  6020    6319 5.90   3.57 -0.00781 -0.00786</span></span>
<span><span class="co">#&gt;   2:   2    1         47.2 -0.00615 0.977   841   1140  6680    6979 6.24   4.41 -0.00614 -0.00615</span></span>
<span><span class="co">#&gt;   3:   3    1         52.7 -0.00628 0.990  1501   1800  7340    7639 6.64   4.64 -0.00668 -0.00628</span></span>
<span><span class="co">#&gt;   4:   4    1         41.3 -0.00432 0.984  2161   2460  8000    8299 6.74   5.45 -0.00434 -0.00432</span></span>
<span><span class="co">#&gt;   5:   5    1         38.8 -0.00368 0.986  2821   3120  8660    8959 6.99   5.88 -0.00369 -0.00368</span></span>
<span><span class="co">#&gt;  ---                                                                                              </span></span>
<span><span class="co">#&gt; 101: 101    1        162.7 -0.00215 0.974 66181  66480 72020   72319 7.58   6.94 -0.00215 -0.00215</span></span>
<span><span class="co">#&gt; 102: 102    1        174.1 -0.00229 0.977 66841  67140 72680   72979 7.56   6.88 -0.00228 -0.00229</span></span>
<span><span class="co">#&gt; 103: 103    1        168.4 -0.00219 0.977 67501  67800 73340   73639 7.59   6.94 -0.00217 -0.00219</span></span>
<span><span class="co">#&gt; 104: 104    1        181.5 -0.00235 0.977 68161  68460 74000   74299 7.62   6.93 -0.00231 -0.00235</span></span>
<span><span class="co">#&gt; 105: 105    1        170.0 -0.00218 0.972 68821  69120 74660   74959 7.61   6.96 -0.00218 -0.00218</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>As we saw from our inspection of the data <a href="#inspecting">earlier</a>, rates are higher at the start of the
dataset because the specimen was exercised before being placed in the
respirometer. We will filter these out shortly. For now we can see we
have a rate from every replicate. Our entered time range has been
applied <em>within</em> each replicate, and the replicate each rate
originates from can be seen in the <code>$rep</code> column.</p>
</div>
<div class="section level3">
<h3 id="crintadj">Adjust<a class="anchor" aria-label="anchor" href="#crintadj"></a>
</h3>
<p><code>calc_rate.int</code> objects also work with
<code>adjust_rate</code>, including with dynamic adjustment methods.
Here, we’ll adjust using the pre- and post-experiment background
recordings assuming the background rate increases linearly from the
initial to ending background rates.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_cr.int_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">zeb_cr.int</span>,</span>
<span>                              by <span class="op">=</span> <span class="va">bg_pre</span>, </span>
<span>                              by2 <span class="op">=</span> <span class="va">bg_post</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="co">#&gt; adjust_rate: Rate adjustments applied using "linear" method.</span></span></code></pre></div>
<p>If the adjustments were correctly applied we would expect the
adjustment value of the early replicates to be close to the value of the
initial background rate (<code>-0.000074</code>), and those of the later
ones close to that of the ending background rate
(<code>-0.000120</code>). Let’s look at the summary to check, and use
<code>pos</code> to pick out one from the start, middle and end.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_cr.int_adj</span>, pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">50</span>, <span class="fl">105</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.adjust_rate # -----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using 'linear' method.</span></span>
<span><span class="co">#&gt; Summary of rate results from entered 'pos' rank(s):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq   row endrow  time endtime  oxy endoxy rate.2pt     rate adjustment rate.adjusted</span></span>
<span><span class="co">#&gt; 1:   1    1         53.3 -0.00786 0.995   181    480  6020    6319 5.90   3.57 -0.00781 -0.00786 -0.0000765      -0.00778</span></span>
<span><span class="co">#&gt; 2:  50    1         89.6 -0.00214 0.966 32521  32820 38360   38659 7.64   7.03 -0.00204 -0.00214 -0.0000971      -0.00204</span></span>
<span><span class="co">#&gt; 3: 105    1        170.0 -0.00218 0.972 68821  69120 74660   74959 7.61   6.96 -0.00218 -0.00218 -0.0001201      -0.00206</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>As expected the <code>$adjustment</code> column values increase over
the experiment between these values, so we can proceed to
conversion.</p>
</div>
<div class="section level3">
<h3 id="convert-1">Convert<a class="anchor" aria-label="anchor" href="#convert-1"></a>
</h3>
<p>Now we will convert the rates, then plot the values to decide how to
select a final RMR rate.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_cr.int_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">zeb_cr.int_adj</span>,</span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,       <span class="co"># oxygen units of the original raw data</span></span>
<span>                                time.unit <span class="op">=</span> <span class="st">"secs"</span>,      <span class="co"># time units of the original raw data</span></span>
<span>                                output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,  <span class="co"># desired output unit</span></span>
<span>                                volume <span class="op">=</span> <span class="fl">0.12</span>,           <span class="co"># effective volume of the respirometer in L</span></span>
<span>                                mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span>           <span class="co"># mass of the specimen in kg</span></span></code></pre></div>
<p>The converted rates can be seen in the summary table.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_cr.int_conv</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      rep rank intercept_b0 slope_b1   rsq density   row endrow  time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;   1:   1    1         53.3 -0.00786 0.995      NA   181    480  6020    6319 5.90   3.57 -0.00786 -0.0000765      -0.00778   -0.00778     mg/L       sec   0.12 0.0009   NA NA NA NA   -3.363      -3.736          NA   mgO2/hr/g      -3.736</span></span>
<span><span class="co">#&gt;   2:   2    1         47.2 -0.00615 0.977      NA   841   1140  6680    6979 6.24   4.41 -0.00615 -0.0000769      -0.00608   -0.00608     mg/L       sec   0.12 0.0009   NA NA NA NA   -2.625      -2.917          NA   mgO2/hr/g      -2.917</span></span>
<span><span class="co">#&gt;   3:   3    1         52.7 -0.00628 0.990      NA  1501   1800  7340    7639 6.64   4.64 -0.00628 -0.0000773      -0.00621   -0.00621     mg/L       sec   0.12 0.0009   NA NA NA NA   -2.681      -2.978          NA   mgO2/hr/g      -2.978</span></span>
<span><span class="co">#&gt;   4:   4    1         41.3 -0.00432 0.984      NA  2161   2460  8000    8299 6.74   5.45 -0.00432 -0.0000778      -0.00424   -0.00424     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.831      -2.035          NA   mgO2/hr/g      -2.035</span></span>
<span><span class="co">#&gt;   5:   5    1         38.8 -0.00368 0.986      NA  2821   3120  8660    8959 6.99   5.88 -0.00368 -0.0000782      -0.00360   -0.00360     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.556      -1.729          NA   mgO2/hr/g      -1.729</span></span>
<span><span class="co">#&gt;  ---                                                                                                                                                                                                                                         </span></span>
<span><span class="co">#&gt; 101: 101    1        162.7 -0.00215 0.974      NA 66181  66480 72020   72319 7.58   6.94 -0.00215 -0.0001185      -0.00203   -0.00203     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.879      -0.977          NA   mgO2/hr/g      -0.977</span></span>
<span><span class="co">#&gt; 102: 102    1        174.1 -0.00229 0.977      NA 66841  67140 72680   72979 7.56   6.88 -0.00229 -0.0001189      -0.00217   -0.00217     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.939      -1.043          NA   mgO2/hr/g      -1.043</span></span>
<span><span class="co">#&gt; 103: 103    1        168.4 -0.00219 0.977      NA 67501  67800 73340   73639 7.59   6.94 -0.00219 -0.0001193      -0.00207   -0.00207     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.895      -0.995          NA   mgO2/hr/g      -0.995</span></span>
<span><span class="co">#&gt; 104: 104    1        181.5 -0.00235 0.977      NA 68161  68460 74000   74299 7.62   6.93 -0.00235 -0.0001197      -0.00223   -0.00223     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.963      -1.070          NA   mgO2/hr/g      -1.070</span></span>
<span><span class="co">#&gt; 105: 105    1        170.0 -0.00218 0.972      NA 68821  69120 74660   74959 7.61   6.96 -0.00218 -0.0001201      -0.00206   -0.00206     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.888      -0.987          NA   mgO2/hr/g      -0.987</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>We can see the converted rates as the last column. The
<code>$summary</code> table contains the all rate regression parameters
and data locations, adjustments (if applied), units, and more. It can be
exported as a separate data frame by using <code>export = TRUE</code> in
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. This is a great way of exporting all the
relevant data for your final results.</p>
</div>
<div class="section level3">
<h3 id="crintselect">Select<a class="anchor" aria-label="anchor" href="#crintselect"></a>
</h3>
<p>It will depend on the aims and circumstances of an experiment what
rate results to extract, summarise, and report. For instance we might
report RMR as a mean of a representative selection of rates after the
specimens uptake rate has stabilised, or a mean of a number or
percentile of lowest rates found. The important thing is to apply these
selection criteria consistently and report them alongside results.</p>
<p>As of <a href="https://januarharianto.github.io/respR/articles/release_notes.html#version-2-1-2022-12-06"><code>respR v2.1</code></a>
<code>convert_rate</code> has new plotting functionality to help
visualise and explore rate results. For intermittent-flow results the
most useful of these is <code>type = "rate"</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_cr.int_conv</span>, type <span class="op">=</span> <span class="st">"rate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-31-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This shows how the calculated rate values vary across the dataset. We
can see from this plot they are high at the start, stabilise after
around timepoint 20000, then are a little unstable again if not slightly
elevated after timepoint 60000. Between these however they appear to be
very stable.</p>
<p>The <code><a href="../reference/select_rate.html">select_rate()</a></code> function allows
<code>convert_rate</code> results to be filtered or reordered in various
ways. See <code><a href="../reference/select_rate.html">help("select_rate")</a></code> and
<code><a href="../articles/select_rate.html">vignette("select_rate")</a></code> for more details. For this
analysis, lets only use rates from replicates between timepoints 20000
and 60000. Then, simply to show an example of how rates can be further
selected, let’s only select those with r-squared of 0.97 and above,
select the lowest 20, and finally take the mean of them.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RMR</span> <span class="op">&lt;-</span> <span class="va">zeb_cr.int_conv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"time"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20000</span>, <span class="fl">60000</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rsq"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.97</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest"</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; select_rate: Selecting rates which occur only between times 20000 and 60000...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 45 rate(s) removed, 60 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; select_rate: Selecting rates with rsq values between 0.97 and 1...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 24 rate(s) removed, 36 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; select_rate: Selecting lowest 20 *absolute* rate values...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 16 rate(s) removed, 20 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rep rank intercept_b0 slope_b1   rsq density   row endrow  time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;  1:  25    1         52.8 -0.00207 0.971      NA 16021  16320 21860   22159 7.70   7.06 -0.00207 -0.0000866      -0.00198   -0.00198     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.855      -0.950          NA   mgO2/hr/g      -0.950</span></span>
<span><span class="co">#&gt;  2:  26    1         54.0 -0.00206 0.972      NA 16681  16980 22520   22819 7.68   7.06 -0.00206 -0.0000870      -0.00197   -0.00197     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.851      -0.946          NA   mgO2/hr/g      -0.946</span></span>
<span><span class="co">#&gt;  3:  33    1         63.6 -0.00206 0.972      NA 21301  21600 27140   27439 7.71   7.08 -0.00206 -0.0000899      -0.00197   -0.00197     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.852      -0.947          NA   mgO2/hr/g      -0.947</span></span>
<span><span class="co">#&gt;  4:  36    1         66.0 -0.00200 0.971      NA 23281  23580 29120   29419 7.66   7.08 -0.00200 -0.0000912      -0.00191   -0.00191     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.826      -0.917          NA   mgO2/hr/g      -0.917</span></span>
<span><span class="co">#&gt;  5:  38    1         71.5 -0.00210 0.972      NA 24601  24900 30440   30739 7.63   7.06 -0.00210 -0.0000920      -0.00201   -0.00201     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.867      -0.963          NA   mgO2/hr/g      -0.963</span></span>
<span><span class="co">#&gt;  6:  39    1         68.0 -0.00194 0.971      NA 25261  25560 31100   31399 7.71   7.05 -0.00194 -0.0000924      -0.00185   -0.00185     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.799      -0.887          NA   mgO2/hr/g      -0.887</span></span>
<span><span class="co">#&gt;  7:  49    1         85.7 -0.00207 0.972      NA 31861  32160 37700   37999 7.69   7.03 -0.00207 -0.0000966      -0.00197   -0.00197     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.853      -0.947          NA   mgO2/hr/g      -0.947</span></span>
<span><span class="co">#&gt;  8:  51    1         88.7 -0.00208 0.970      NA 33181  33480 39020   39319 7.66   6.98 -0.00208 -0.0000975      -0.00198   -0.00198     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.856      -0.951          NA   mgO2/hr/g      -0.951</span></span>
<span><span class="co">#&gt;  9:  55    1         95.4 -0.00211 0.973      NA 35821  36120 41660   41959 7.63   7.03 -0.00211 -0.0000992      -0.00201   -0.00201     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.868      -0.964          NA   mgO2/hr/g      -0.964</span></span>
<span><span class="co">#&gt; 10:  58    1         99.3 -0.00210 0.973      NA 37801  38100 43640   43939 7.70   7.04 -0.00210 -0.0001004      -0.00200   -0.00200     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.864      -0.960          NA   mgO2/hr/g      -0.960</span></span>
<span><span class="co">#&gt; 11:  59    1         99.7 -0.00208 0.971      NA 38461  38760 44300   44599 7.66   6.95 -0.00208 -0.0001008      -0.00198   -0.00198     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.855      -0.950          NA   mgO2/hr/g      -0.950</span></span>
<span><span class="co">#&gt; 12:  63    1        107.2 -0.00212 0.977      NA 41101  41400 46940   47239 7.63   7.00 -0.00212 -0.0001025      -0.00202   -0.00202     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.872      -0.969          NA   mgO2/hr/g      -0.969</span></span>
<span><span class="co">#&gt; 13:  68    1        113.5 -0.00211 0.971      NA 44401  44700 50240   50539 7.67   7.02 -0.00211 -0.0001046      -0.00200   -0.00200     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.865      -0.962          NA   mgO2/hr/g      -0.962</span></span>
<span><span class="co">#&gt; 14:  73    1        118.7 -0.00207 0.972      NA 47701  48000 53540   53839 7.67   7.01 -0.00207 -0.0001067      -0.00197   -0.00197     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.850      -0.944          NA   mgO2/hr/g      -0.944</span></span>
<span><span class="co">#&gt; 15:  74    1        114.6 -0.00197 0.970      NA 48361  48660 54200   54499 7.66   7.02 -0.00197 -0.0001071      -0.00187   -0.00187     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.807      -0.896          NA   mgO2/hr/g      -0.896</span></span>
<span><span class="co">#&gt; 16:  75    1        119.6 -0.00204 0.973      NA 49021  49320 54860   55159 7.67   7.04 -0.00204 -0.0001076      -0.00193   -0.00193     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.835      -0.928          NA   mgO2/hr/g      -0.928</span></span>
<span><span class="co">#&gt; 17:  79    1        125.3 -0.00205 0.973      NA 51661  51960 57500   57799 7.67   7.04 -0.00205 -0.0001092      -0.00194   -0.00194     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.837      -0.930          NA   mgO2/hr/g      -0.930</span></span>
<span><span class="co">#&gt; 18:  80    1        122.0 -0.00197 0.971      NA 52321  52620 58160   58459 7.60   7.01 -0.00197 -0.0001097      -0.00186   -0.00186     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.803      -0.892          NA   mgO2/hr/g      -0.892</span></span>
<span><span class="co">#&gt; 19:  81    1        125.0 -0.00200 0.974      NA 52981  53280 58820   59119 7.67   7.01 -0.00200 -0.0001101      -0.00189   -0.00189     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.815      -0.905          NA   mgO2/hr/g      -0.905</span></span>
<span><span class="co">#&gt; 20:  82    1        133.8 -0.00212 0.973      NA 53641  53940 59480   59779 7.68   7.03 -0.00212 -0.0001105      -0.00201   -0.00201     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.869      -0.965          NA   mgO2/hr/g      -0.965</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # mean.convert_rate # -------------------</span></span>
<span><span class="co">#&gt; Mean of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean of 20 output rates:</span></span>
<span><span class="co">#&gt; [1] -0.939</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr/g"</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>That’s it; this is our final routine metabolic rate (at least, as we
have chosen to define it).</p>
</div>
</div>
<div class="section level2">
<h2 id="smr">SMR<a class="anchor" aria-label="anchor" href="#smr"></a>
</h2>
<div class="section level3">
<h3 id="arint">
<code>auto_rate.int</code><a class="anchor" aria-label="anchor" href="#arint"></a>
</h3>
<p>To extract a rate from every replicate and determine a standard
metabolic rate (SMR) from amongst the results we will use
<code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code>. To repeat the note from <a href="#analysis">above</a>, this is not a recommendation that this is
how you should extract an SMR from your own data; it is simply an
example of one approach and how the <code>respR</code> functions are
flexible and adaptable.</p>
<p>Introduced in <a href="https://januarharianto.github.io/respR/articles/release_notes.html#version-2-1-2022-12-06"><code>respR v2.1</code></a>,
<code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code> is a dedicated function for
intermittent-flow respirometry data, in which you specify a replicate
structure and run <code><a href="../reference/auto_rate.html">auto_rate()</a></code> on each replicate. This
function extracts rates in a number of ways including the most linear or
most consistently maintained rates, plus highest and lowest rates of a
specified width. See <code><a href="../articles/auto_rate.html">vignette("auto_rate")</a></code> for more
details, and <code><a href="../articles/auto_rate.int.html">vignette("auto_rate.int")</a></code> for an overview of
this function.</p>
<p>The difference between this and the approach <a href="#crint">above</a> using <code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code> is that the
specified <code>measure</code> phase is not the same as the region over
which a rate is calculated. Instead a <code>measure</code> phase is
specified and the <code>auto_rate</code> analysis is done
<em>within</em> this region using the <code>method</code> and
<code>width</code> inputs. This can result in rates of different widths
coming from within this region depending on the inputs.</p>
</div>
<div class="section level3">
<h3 id="subset-data-1">Subset data<a class="anchor" aria-label="anchor" href="#subset-data-1"></a>
</h3>
<p>We again subset the data so that the 105 regularly-spaced replicates
start at row 1.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_insp</span> <span class="op">&lt;-</span> <span class="va">zeb_intermittent.rd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">5840</span>, </span>
<span>              to <span class="op">=</span> <span class="fl">75139</span>,</span>
<span>              by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="arintextract">Extract rates<a class="anchor" aria-label="anchor" href="#arintextract"></a>
</h3>
<p>To get SMR we necessarily need to define it, in particular the
duration over which rates are calculated within each replicate. These
should be chosen appropriately and with reference to best practices and
previous studies. Here, let’s say we want to extract the lowest rate
across 2 minutes within each replicate, and we will define our SMR for
this specimen as the mean of the lowest 10th percentile of all 105
extracted rates.</p>
<p>We run <code>auto_rate.int</code> on the inspected data and use
<code>method = "lowest"</code> and <code>width = 120</code>. This means
the function calculates <em>every</em> rate of this width within each
replicate, orders them according to the input <code>method</code>, and
by default (<code>n = 1</code>) returns the top ranked result, in this
case the lowest, for each replicate.</p>
<p>We again specify a 660 row interval between replicates using
<code>starts</code>. Just to be different from the <a href="#crint">above</a> example, this time we will specify a 2 minute
(120 row) <code>wait</code> phase, and six minute (360 row)
<code>measure</code> phase.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_ar.int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_rate.int.html">auto_rate.int</a></span><span class="op">(</span><span class="va">zeb_insp</span>,</span>
<span>                            starts <span class="op">=</span> <span class="fl">660</span>,</span>
<span>                            wait <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                            measure <span class="op">=</span> <span class="fl">360</span>,</span>
<span>                            method <span class="op">=</span> <span class="st">"lowest"</span>,</span>
<span>                            width <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                            by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; plot.auto_rate.int: Plotting first 20 selected rates only. To plot others modify 'pos' input.</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-34-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Note how the plots show the rates coming from different regions
within each replicate measure phase. The summary contains all the
results, that is the lowest 2-minute rate from each replicate. Before
selecting from amongst these to get our final SMR we first need to
adjust and convert them. This is exactly the same process we followed in
the <a href="#crintadj">example above</a>.</p>
</div>
<div class="section level3">
<h3 id="adjust-1">Adjust<a class="anchor" aria-label="anchor" href="#adjust-1"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_ar.int_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">zeb_ar.int</span>,</span>
<span>                              by <span class="op">=</span> <span class="va">bg_pre</span>, </span>
<span>                              by2 <span class="op">=</span> <span class="va">bg_post</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="co">#&gt; adjust_rate: Rate adjustments applied using "linear" method.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="convert-2">Convert<a class="anchor" aria-label="anchor" href="#convert-2"></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_ar.int_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">zeb_ar.int_adj</span>,</span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,       <span class="co"># oxygen units of the original raw data</span></span>
<span>                                time.unit <span class="op">=</span> <span class="st">"secs"</span>,      <span class="co"># time units of the original raw data</span></span>
<span>                                output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,  <span class="co"># desired output unit</span></span>
<span>                                volume <span class="op">=</span> <span class="fl">0.12</span>,           <span class="co"># effective volume of the respirometer in L</span></span>
<span>                                mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span>           <span class="co"># mass of the specimen in kg</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_ar.int_conv</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      rep rank intercept_b0 slope_b1   rsq density   row endrow  time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;   1:   1    1         45.5 -0.00658 0.984      NA   179    298  6018    6137 5.88   5.12 -0.00658 -0.0000764      -0.00650   -0.00650     mg/L       sec   0.12 0.0009   NA NA NA NA   -2.810      -3.122          NA   mgO2/hr/g      -3.122</span></span>
<span><span class="co">#&gt;   2:   2    1         34.0 -0.00424 0.906      NA  1021   1140  6860    6979 5.00   4.41 -0.00424 -0.0000770      -0.00416   -0.00416     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.798      -1.998          NA   mgO2/hr/g      -1.998</span></span>
<span><span class="co">#&gt;   3:   3    1         47.3 -0.00557 0.932      NA  1668   1787  7507    7626 5.51   4.81 -0.00557 -0.0000774      -0.00549   -0.00549     mg/L       sec   0.12 0.0009   NA NA NA NA   -2.374      -2.638          NA   mgO2/hr/g      -2.638</span></span>
<span><span class="co">#&gt;   4:   4    1         35.5 -0.00360 0.952      NA  2203   2322  8042    8161 6.55   6.13 -0.00360 -0.0000777      -0.00352   -0.00352     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.522      -1.691          NA   mgO2/hr/g      -1.691</span></span>
<span><span class="co">#&gt;   5:   5    1         36.2 -0.00338 0.928      NA  2841   2960  8680    8799 6.87   6.50 -0.00338 -0.0000781      -0.00330   -0.00330     mg/L       sec   0.12 0.0009   NA NA NA NA   -1.426      -1.584          NA   mgO2/hr/g      -1.584</span></span>
<span><span class="co">#&gt;  ---                                                                                                                                                                                                                                         </span></span>
<span><span class="co">#&gt; 101: 101    1        154.6 -0.00204 0.850      NA 66251  66370 72090   72209 7.43   7.20 -0.00204 -0.0001185      -0.00192   -0.00192     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.831      -0.923          NA   mgO2/hr/g      -0.923</span></span>
<span><span class="co">#&gt; 102: 102    1        146.2 -0.00191 0.836      NA 66862  66981 72701   72820 7.54   7.32 -0.00191 -0.0001188      -0.00179   -0.00179     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.773      -0.859          NA   mgO2/hr/g      -0.859</span></span>
<span><span class="co">#&gt; 103: 103    1        151.7 -0.00197 0.852      NA 67680  67799 73519   73638 7.18   6.97 -0.00197 -0.0001194      -0.00185   -0.00185     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.797      -0.886          NA   mgO2/hr/g      -0.886</span></span>
<span><span class="co">#&gt; 104: 104    1        162.6 -0.00209 0.864      NA 68269  68388 74108   74227 7.35   7.10 -0.00209 -0.0001197      -0.00197   -0.00197     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.853      -0.948          NA   mgO2/hr/g      -0.948</span></span>
<span><span class="co">#&gt; 105: 105    1        147.5 -0.00187 0.817      NA 68986  69105 74825   74944 7.17   6.97 -0.00187 -0.0001202      -0.00175   -0.00175     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.758      -0.842          NA   mgO2/hr/g      -0.842</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="quality-control">Quality control<a class="anchor" aria-label="anchor" href="#quality-control"></a>
</h3>
<p>We can plot the <code>convert_rate</code> object for a quick look at
how rates vary across the data.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_ar.int_conv</span>, type <span class="op">=</span> <span class="st">"rate"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-38-1.png" width="960" style="display: block; margin: auto;"></p>
<p>These rates seem to be a bit lower than those we extracted for RMR <a href="#crintselect">above</a>, as we would expect for an SMR.</p>
<p>This is an opportunity to do some quality control before we select
our final rates to determine SMR. Looking at the plot above there is one
result that seems to be uncharacteristically low compared to the others
with a value just over 0.5. Looking at the summary table we can see this
is from replicate 48. We can plot a selection of rates from this region
using <code>pos</code> and the y-axis range will adapt to provide a more
detailed view of the range of rates.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_ar.int_conv</span>, type <span class="op">=</span> <span class="st">"rate"</span>, pos <span class="op">=</span> <span class="fl">30</span><span class="op">:</span><span class="fl">80</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-39-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Replicate 48 does seem to be anomalously low. If we go back to the
<code>auto_rate.int</code> results object we can use <code>pos</code> to
plot this replicate for a closer look. We’ll do this in two different
ways using <code>type</code>. Firstly the rate in the context of the
whole replicate, secondly the <code>auto_rate</code> output plot for
this replicate which has more diagnostic plots, but only shows the
<code>measure</code> phase.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_ar.int</span>, type <span class="op">=</span> <span class="st">"rep"</span>, pos <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-40-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_ar.int</span>, type <span class="op">=</span> <span class="st">"ar"</span>, pos <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_long_files/figure-html/unnamed-chunk-40-2.png" width="960" style="display: block; margin: auto;"></p>
<p>Looking at these plots this result does seem to be anomalous, and in
this replicate the rate extracted is not really representative. It also
has a lower r-squared which otherwise varies from 0.72 to 0.98. There
seems to be an anomaly in the oxygen trace, maybe a sensor glitch or
slight temperature change. Issues like this causing glitches in the
trace are very common.</p>
<p>Therefore, it would be perfectly acceptable and justifiable to
manually exclude this result (there are also 1 or 2 others we might want
to investigate). To apply such selection criteria objectively and
systematically would require examining multiple experiments. This is why
definitions of metrics like SMR and analysis parameters should usually
be decided upon after thoroughly exploring all your results. After this
you should be able to arrive at a set of objective and reasonable
selection criteria.</p>
</div>
<div class="section level3">
<h3 id="select-1">Select<a class="anchor" aria-label="anchor" href="#select-1"></a>
</h3>
<p>To get our final SMR we just need to use <code>select_rate</code>
again with our chosen criteria, and pipe the result to
<code>mean</code>. We decided <a href="#arintextract">above</a> our
definition of SMR would be the mean of the lowest 10th percentile of the
rates extracted from each replicate. We also want to exclude the result
from replicate 48.</p>
<p>Excluding this replicate could be achieved in a number of ways in
<code>select_rate</code>. We could use <code>method = "rsq"</code> to
select only results with r-squared above a certain value which excludes
this one. We could use the <code>time_omit</code> method to exclude this
rate based on its timepoint (found in the summary table), or use the
<code>rep</code> method simply to select all replicates <em>except</em>
this one. There is a specific <code>rep_omit</code> method however to
remove particular replicates.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SMR</span> <span class="op">&lt;-</span> <span class="va">zeb_ar.int_conv</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rep_omit"</span>, n <span class="op">=</span> <span class="fl">48</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest_percentile"</span>, n <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; select_rate: Selecting rates which *ARE NOT* from 'rep_omit' replicates...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 1 rate(s) removed, 104 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; select_rate: Selecting lowest 10th percentile of *absolute* rate values...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 93 rate(s) removed, 11 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rep rank intercept_b0 slope_b1   rsq density   row endrow  time endtime  oxy endoxy     rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;  1:  21    1         34.5 -0.00141 0.725      NA 13533  13652 19372   19491 7.24   7.12 -0.00141 -0.0000849      -0.00132   -0.00132     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.571      -0.634          NA   mgO2/hr/g      -0.634</span></span>
<span><span class="co">#&gt;  2:  28    1         46.5 -0.00163 0.789      NA 18076  18195 23915   24034 7.45   7.29 -0.00163 -0.0000878      -0.00154   -0.00154     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.667      -0.741          NA   mgO2/hr/g      -0.741</span></span>
<span><span class="co">#&gt;  3:  32    1         50.5 -0.00162 0.802      NA 20764  20883 26603   26722 7.38   7.16 -0.00162 -0.0000895      -0.00153   -0.00153     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.661      -0.735          NA   mgO2/hr/g      -0.735</span></span>
<span><span class="co">#&gt;  4:  35    1         48.4 -0.00144 0.722      NA 22801  22920 28640   28759 7.27   7.11 -0.00144 -0.0000908      -0.00135   -0.00135     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.582      -0.647          NA   mgO2/hr/g      -0.647</span></span>
<span><span class="co">#&gt;  5:  36    1         54.4 -0.00160 0.783      NA 23373  23492 29212   29331 7.50   7.31 -0.00160 -0.0000912      -0.00151   -0.00151     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.654      -0.726          NA   mgO2/hr/g      -0.726</span></span>
<span><span class="co">#&gt;  6:  41    1         60.3 -0.00163 0.780      NA 26675  26794 32514   32633 7.36   7.25 -0.00163 -0.0000933      -0.00153   -0.00153     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.663      -0.736          NA   mgO2/hr/g      -0.736</span></span>
<span><span class="co">#&gt;  7:  42    1         55.0 -0.00144 0.727      NA 27421  27540 33260   33379 7.26   7.11 -0.00144 -0.0000938      -0.00134   -0.00134     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.580      -0.644          NA   mgO2/hr/g      -0.644</span></span>
<span><span class="co">#&gt;  8:  43    1         58.8 -0.00152 0.776      NA 28056  28175 33895   34014 7.28   7.14 -0.00152 -0.0000942      -0.00142   -0.00142     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.615      -0.684          NA   mgO2/hr/g      -0.684</span></span>
<span><span class="co">#&gt;  9:  44    1         62.7 -0.00160 0.775      NA 28667  28786 34506   34625 7.37   7.20 -0.00160 -0.0000946      -0.00151   -0.00151     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.652      -0.724          NA   mgO2/hr/g      -0.724</span></span>
<span><span class="co">#&gt; 10:  47    1         66.4 -0.00162 0.792      NA 30595  30714 36434   36553 7.54   7.32 -0.00162 -0.0000958      -0.00152   -0.00152     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.657      -0.730          NA   mgO2/hr/g      -0.730</span></span>
<span><span class="co">#&gt; 11:  54    1         74.8 -0.00164 0.766      NA 35329  35448 41168   41287 7.21   7.02 -0.00164 -0.0000988      -0.00154   -0.00154     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.666      -0.740          NA   mgO2/hr/g      -0.740</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # mean.convert_rate # -------------------</span></span>
<span><span class="co">#&gt; Mean of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean of 11 output rates:</span></span>
<span><span class="co">#&gt; [1] -0.704</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr/g"</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>We can see the summary of the final 11 selected rates, and then the
mean of these. This is our final SMR.</p>
</div>
</div>
<div class="section level2">
<h2 id="ratessumm">Summary<a class="anchor" aria-label="anchor" href="#ratessumm"></a>
</h2>
<p>Now we have our final results for each metric.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>MMR<span class="sc">:</span> <span class="sc">-</span><span class="fl">3.05</span> mg<span class="sc">/</span>h<span class="sc">/</span>g</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>RMR<span class="sc">:</span> <span class="sc">-</span><span class="fl">0.94</span> mg<span class="sc">/</span>h<span class="sc">/</span>g</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>SMR<span class="sc">:</span> <span class="sc">-</span><span class="fl">0.70</span> mg<span class="sc">/</span>h<span class="sc">/</span>g</span></code></pre></div>
<p>Typically these rates would now be reported as positive values.</p>
</div>
<div class="section level2">
<h2 id="report">Reporting<a class="anchor" aria-label="anchor" href="#report"></a>
</h2>
<p>The above is a lengthy description of an analysis, so this vignette
may not give a good impression of just how succinct a <code>respR</code>
analysis may be. This code block shows the entire analysis for SMR.</p>
<div class="section level3">
<h3 id="complete-analysis">Complete analysis<a class="anchor" aria-label="anchor" href="#complete-analysis"></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Inspect data ------------------------------------------------------------</span></span>
<span><span class="va">zeb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Background --------------------------------------------------------------</span></span>
<span><span class="va">bg_pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">4999</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bg_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb</span>, from <span class="op">=</span> <span class="fl">75140</span>, to <span class="op">=</span> <span class="fl">79251</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SMR Analysis ------------------------------------------------------------</span></span>
<span>  <span class="co"># Subset ------------------------------------------------------------------</span></span>
<span>  <span class="va">zeb</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">5840</span>, </span>
<span>              to <span class="op">=</span> <span class="fl">75139</span>,</span>
<span>              by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Extract rates -----------------------------------------------------------</span></span>
<span>  <span class="fu"><a href="../reference/auto_rate.int.html">auto_rate.int</a></span><span class="op">(</span>starts <span class="op">=</span> <span class="fl">660</span>,</span>
<span>                wait <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                measure <span class="op">=</span> <span class="fl">360</span>,</span>
<span>                method <span class="op">=</span> <span class="st">"lowest"</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">120</span>,</span>
<span>                by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span>  <span class="op">|&gt;</span></span>
<span>  <span class="co"># Adjust ------------------------------------------------------------------</span></span>
<span>  <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">bg_pre</span>, </span>
<span>              by2 <span class="op">=</span> <span class="va">bg_post</span>,</span>
<span>              method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Convert -----------------------------------------------------------------</span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,      </span>
<span>               time.unit <span class="op">=</span> <span class="st">"secs"</span>,     </span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>, </span>
<span>               volume <span class="op">=</span> <span class="fl">0.12</span>,        </span>
<span>               mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Select -----------------------------------------------------------------</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rep_omit"</span>, n <span class="op">=</span> <span class="fl">48</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest_percentile"</span>, n <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-to-report-analysis-methods">How to report analysis methods<a class="anchor" aria-label="anchor" href="#how-to-report-analysis-methods"></a>
</h3>
<p>The ultimate aim of <code>respR</code> was to enable clear reporting
and reproducible analyses. This is an example of how we might report the
above analysis in a manuscript.</p>
<p><em>“Data was analysed using the R package <code>respR</code>
(Harianto et al. 2019). The <code>auto_rate.int</code> function was used
to extract the lowest rate across a two minute window from each
replicate. Rates were adjusted for background using pre- and
post-experiment blank recordings with no specimen, assuming a linear
increase in background rate over time. Obviously anomalous rates were
excluded, and SMR was defined as the mean of the lowest 10th percentile
of remaining adjusted rates.”</em></p>
</div>
</div>
<div class="section level2">
<h2 id="alternative-approaches">Alternative approaches<a class="anchor" aria-label="anchor" href="#alternative-approaches"></a>
</h2>
<p>Previous versions of this vignette demonstrated use of different
methods, such as looping and subsetting of data, to extract individual
replicates for processing through <code>calc_rate</code> or
<code>auto_rate</code>. These approaches still work and are archived <a href="https://januarharianto.github.io/respR/articles/archive/intermittent_old.html">here</a>
in case they are of use in some cases, for example if you want to
extract rates from the same oxygen range in each replicate. However for
most analyses use of <code>calc_rate.int</code> or
<code>auto_rate.int</code> is the recommended approach.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
