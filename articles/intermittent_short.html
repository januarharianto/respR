<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intermittent-flow respirometry: Short experiment • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Intermittent-flow respirometry: Short experiment">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR in Use</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Intermittent-flow respirometry: Short
experiment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/intermittent_short.Rmd" class="external-link"><code>vignettes/intermittent_short.Rmd</code></a></small>
      <div class="hidden name"><code>intermittent_short.Rmd</code></div>

    </div>

    
    
<p>Intermittent-flow respirometry allows multiple replicates to be
conducted in an experiment by periodically flushing the respirometer
with new water or air, for example after a specific period of time or
oxygen decrease. Typically, probes are left recording during flushes,
with the resulting trace showing the oxygen returning to ambient levels.
If the data is not split into the separate replicates this results in a
dataset with oscillating levels of oxygen, and generally we want to
extract a rate from each descending section. This can prove tricky
especially when experiments are lengthy and have many replicates.</p>
<p><a href="https://januarharianto.github.io/respR/articles/release_notes.html"><code>respR v2.1</code></a>
introduced new functions to analyse intermittent-flow data:</p>
<ul>
<li><p><strong><code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code></strong> which runs
<code><a href="../reference/calc_rate.html">calc_rate()</a></code> on every replicate in an intermittent-flow
dataset to extract a rate from the same time or row region of
each</p></li>
<li><p><strong><code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code></strong> which runs
<code><a href="../reference/auto_rate.html">auto_rate()</a></code> on every replicate in an intermittent-flow
dataset to automatically extract the <em>most linear</em>,
<em>lowest</em>, or <em>highest</em> rate in each</p></li>
<li><p><strong><code><a href="../reference/select_rate.html">select_rate()</a></code></strong> which works on
<code><a href="../reference/convert_rate.html">convert_rate()</a></code> objects and allows for advanced selection of
a final rate using consistent criteria, including the results of
intermittent-flow analyses</p></li>
</ul>
<p>This vignette shows how to use both <code>calc_rate.int</code> and
<code>auto_rate.int</code> to analyse a fairly short intermittent-flow
respirometry experiment. In <code><a href="../articles/intermittent_long.html">vignette("intermittent_long")</a></code>
we show how they can be used along with <code>select_rate</code> to
analyse a much longer intermittent-flow experiment with a regular
structure and increasing background rate. However, we advise reading
this one first as it better covers the basics.</p>
<div class="section level2">
<h2 id="experiment-overview">Experiment overview<a class="anchor" aria-label="anchor" href="#experiment-overview"></a>
</h2>
<p>The example data, <code>intermittent.rd</code>, contains
intermittent-flow measurements of oxygen consumption in the sea urchin
<em>Heliocidaris erythrogramma</em>. More information about the data can
be viewed via <code><a href="../reference/intermittent.rd.html">?intermittent.rd</a></code>.</p>
<p>In this experiment the flushes were triggered manually so replicates
are not regularly spaced and are of different durations, with the third
in particular quite a bit briefer than the others. Therefore, for the
following examples we need to tell the function the locations of the
start of each replicate. In <code><a href="../articles/intermittent_long.html">vignette("intermittent_long")</a></code>
you can see an example of analysis of a regular intermittent-flow
experiment where we only need to specify the interval between them.</p>
</div>
<div class="section level2">
<h2 id="inspect">Inspect<a class="anchor" aria-label="anchor" href="#inspect"></a>
</h2>
<p>The first step in any data analysis task should be to visualise and
inspect the data. For this we use the <code><a href="../reference/inspect.html">inspect()</a></code> function.
This step is optional, however it scans the data for common issues,
plots it, and saves it to an object to pass to further stages of the
analysis. Passing all of these checks is not strictly necessary
depending on the data. See <code><a href="../articles/inspecting.html">vignette("inspecting")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urchin_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">intermittent.rd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 Time   O2</span></span>
<span><span class="co">#&gt; numeric         pass pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass pass</span></span>
<span><span class="co">#&gt; sequential      pass    -</span></span>
<span><span class="co">#&gt; duplicated      pass    -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We can see from the top plot that this dataset has three replicates,
separated by two flushes where new water was added. The bottom plot
shows rate of change (positive or negative) in oxygen over a rolling
window of 10% of the data, and flush periods obviously skew this plot.
Note how rates are plotted on a numerically reversed y-axis so that
uptake rates are higher than production rates, or oxygen input rate in
the case of the flushes (this can be changed by passing
<code>rate.rev = FALSE</code>).</p>
<p>This lower plot provides a quick visual inspection of how the rate
varies over the course of the experiment. Regions of stable and
consistent rates can be identified on the rolling rate plots as flat or
level areas. The plot here in <code>inspect</code> is for exploratory
purposes only; later functions allow rate to be calculated over specific
regions. Here, despite the flushes skewing the rate plot, specimen
uptake rates (flat regions) appear to be relatively consistent within
each experimental replicate with a value of around -0.005.</p>
<p>For a closer look, we can use <code><a href="../reference/subset_data.html">subset_data()</a></code> and
<code><a href="../reference/inspect.html">inspect()</a></code> without saving the result to check regions of the
data, which can help us decide how we are going to proceed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intermittent.rd</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">1800</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Inspecting the first replicate shows us rate is indeed fairly
consistent within the replicate, but fluctuates from around -0.0004 to
-0.0008. However, bear in mind these rate values are determined over the
default of a 10% window of the inspected data, and so are sensitive to
noise.</p>
<p><code>inspect</code> however lets us pass a different
<code>width</code> input for the purposes of the rolling rate plot.
Let’s try a wider window of 50% of the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intermittent.rd</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">1800</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Now we can see rate is much more consistent, although it decreases
slightly over the course of the replicate. But we can tell that we would
expect our extracted rates to be around -0.0006. Note the values in the
rolling rate plot are plotted against the middle of the range over which
they were calculated, which is why they are centred like this.</p>
</div>
<div class="section level2">
<h2 id="calc_rate-int">
<code>calc_rate.int</code><a class="anchor" aria-label="anchor" href="#calc_rate-int"></a>
</h2>
<p>Introduced in <a href="https://januarharianto.github.io/respR/articles/release_notes.html#version-2-1-2022-12-06"><code>respR v2.1</code></a>,
<code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code> is a dedicated function for
intermittent-flow respirometry data, in which you specify a replicate
structure and extract a rate from the same data region of each
replicate. This can be the same rows of each replicate or the same time
window.</p>
<p><code>calc_rate.int</code> uses the <code>starts</code> locations to
subset each replicate from the data in <code>x</code>. The function
assumes each replicate ends at the row preceding the start of the next.
It then extracts a rate using the <code>wait</code> and
<code>measure</code> inputs. The <code>by</code> input
(<code>"row"</code> or <code>"time"</code>) determines how these other
inputs are applied to the data.</p>
<p>Here we will run through a <code>calc_rate.int</code> analysis of the
<code>intermittent.rd</code> data. Reading
<code><a href="../articles/calc_rate.int.html">vignette("calc_rate.int")</a></code> first will be helpful in
explaining the general functionality, not all of which will be covered
here.</p>
<p>As with <code>calc_rate</code> and most functions in
<code>respR</code>, <code>calc_rate.int</code> will accept a data frame
of time against oxygen as well as <code>inspect</code> objects, however
we will use the <code>urchin_int</code> object we created above for the
remainder of this vignette.</p>
<div class="section level3">
<h3 id="complete">Rate from complete replicates<a class="anchor" aria-label="anchor" href="#complete"></a>
</h3>
<p>The row locations of the replicates in this dataset can be found in
the help file (<code><a href="../reference/intermittent.rd.html">help("intermittent.rd")</a></code>). Here is what
happens if we only specify the starting location of each using
<code>starts</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin_int</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of all replicate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq  row endrow time endtime  oxy endoxy    rate.2pt       rate</span></span>
<span><span class="co">#&gt; 1:   1    1        6.996 -0.0003710 0.480    1   2100    0    2099 7.17   7.22  0.00002382 -0.0003710</span></span>
<span><span class="co">#&gt; 2:   2    1        7.374 -0.0001736 0.118 2101   3900 2100    3899 7.22   7.17 -0.00002779 -0.0001736</span></span>
<span><span class="co">#&gt; 3:   3    1        9.621 -0.0006280 0.989 3901   4831 3900    4830 7.16   6.59 -0.00061290 -0.0006280</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>This is obviously not what we want as the flush periods for the first
two replicates are included. Therefore, we need to specify a
<code>measure</code> phase to exclude the flushes. With irregular
replicates like this we can even specify a different
<code>measure</code> phase in each, and in this case use all data except
the flush.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin_int</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span>,</span>
<span>              measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1800</span>, <span class="fl">1400</span>, <span class="fl">900</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of all replicate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq  row endrow time endtime  oxy endoxy   rate.2pt       rate</span></span>
<span><span class="co">#&gt; 1:   1    1        7.138 -0.0005821 0.995    1   1800    0    1799 7.17   6.11 -0.0005892 -0.0005821</span></span>
<span><span class="co">#&gt; 2:   2    1        8.482 -0.0005927 0.995 2101   3500 2100    3499 7.22   6.43 -0.0005647 -0.0005927</span></span>
<span><span class="co">#&gt; 3:   3    1        9.635 -0.0006313 0.988 3901   4800 3900    4799 7.16   6.60 -0.0006229 -0.0006313</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="rate-from-specific-regions">Rate from specific regions<a class="anchor" aria-label="anchor" href="#rate-from-specific-regions"></a>
</h3>
<p>However, we usually don’t want to use the entire replicate. Typically
we use a <code>wait</code> phase directly after a flush in case the
animal was disturbed or the oxygen probe has some lag in detecting the
rapid change in oxygen concentration. We can also use the
<code>measure</code> input to standardise the region from which we
extract a rate.</p>
<p>For example, <code>wait = 10, measure = 20, by = "time"</code> will
exclude the first 10 units of time used in the original data, and
calculate a rate from the following 20 time units.</p>
<p>Similarly, <code>wait = 120, measure = 360, by = "row"</code> will
exclude the first 120 rows of each replicate, and calculate a rate
across the following 360 rows.</p>
<p>For this experiment, let’s say we want to exclude the first 5 minutes
(300 rows) of each replicate to allow for the specimen to settle down
after the flush, then calculate rates over a 15 minute period (900
rows). In these data where oxygen is recorded every second this will be
<code>wait = 300, measure = 900</code>. The default <code>by</code>
method is <code>by = "row"</code> so we do not need to specify this.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin_int</span>,</span>
<span>                            starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span>,</span>
<span>                            wait <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                            measure <span class="op">=</span> <span class="fl">900</span>,</span>
<span>                            legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In this plot, the data used to calculate the rate is the yellow
points, the red shaded region is the <code>wait</code> phase, and the
green shaded region the <code>measure</code> phase (we added
<code>legend = TRUE</code> so we can see labels for this example).</p>
<p>In these data of oxygen recorded once per second the time and row
values are equivalent, so in the first replicate we can see the rate has
been determined from timepoints 300 to 900 timepoints later (i.e. 1200).
In the other replicates it is from the same equivalent time or row
window. Note the third replicate is not long enough to <em>have</em> a
timepoint of 1200. The default is to use the closest value which in this
case is the final row of the dataset, and is acceptable here because
there is no flush to worry about.</p>
<p>We can view the full results using <code>summary</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">urch_rates</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of all replicate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq  row endrow time endtime  oxy endoxy   rate.2pt       rate</span></span>
<span><span class="co">#&gt; 1:   1    1        7.134 -0.0005894 0.990  301   1200  300    1199 6.98   6.43 -0.0006118 -0.0005894</span></span>
<span><span class="co">#&gt; 2:   2    1        8.536 -0.0006122 0.991 2401   3300 2400    3299 7.05   6.52 -0.0005895 -0.0006122</span></span>
<span><span class="co">#&gt; 3:   3    1        9.564 -0.0006155 0.980 4201   4831 4200    4830 6.95   6.59 -0.0005714 -0.0006155</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>The replicate number is indicated by the <code>$rep</code> column.
The <code>$rank</code> column indicates ranking or ordering of rates
<em>within</em> each individual replicate. Since
<code>calc_rate.int</code> only returns one rate per replicate it is not
relevant here, but is useful for <code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code> results
where multiple rates per replicate may be returned.</p>
</div>
<div class="section level3">
<h3 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h3>
<p>The output object can also be plotted, and if we change the
<code>type</code> input we can see each rate in context of the whole
dataset. For larger datasets this may be of limited utility.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">urch_rates</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
<p>See <code><a href="../articles/calc_rate.int.html">vignette("calc_rate.int")</a></code> for additional plotting
options.</p>
</div>
<div class="section level3">
<h3 id="adjustcrint">Adjust<a class="anchor" aria-label="anchor" href="#adjustcrint"></a>
</h3>
<p><code>calc_rate.int</code> objects can also be passed to
<code>adjust_rate</code> for background adjustments.</p>
<p>There is no specific background data associated with the
<code>intermittent.rd</code> dataset, but we will use the
<code>background_con.rd</code> data as an example. We just need to
convert it to the same units as our urchin data.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bg_data</span> <span class="op">&lt;-</span> <span class="va">background_con.rd</span></span>
<span><span class="va">bg_data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_DO.html">convert_DO</a></span><span class="op">(</span><span class="va">bg_data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                           from <span class="op">=</span> <span class="st">"%Air"</span>,</span>
<span>                           to <span class="op">=</span> <span class="st">"mg/l"</span>,</span>
<span>                           S <span class="op">=</span> <span class="fl">30</span>, t <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p>Now we calculate a background rate.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bg_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="va">bg_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bg_rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.bg # ------------------</span></span>
<span><span class="co">#&gt; Background rate(s):</span></span>
<span><span class="co">#&gt; [1] -0.000008988</span></span>
<span><span class="co">#&gt; Mean background rate:</span></span>
<span><span class="co">#&gt; [1] -0.000008988</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>And use it to adjust our urchin rates.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rates_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rates</span>,</span>
<span>                              by <span class="op">=</span> <span class="va">bg_rate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; adjust_rate: Rate adjustments applied using "mean" method.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.adjust_rate # -----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using 'mean' method.</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq  row endrow time endtime  oxy endoxy   rate.2pt       rate   adjustment rate.adjusted</span></span>
<span><span class="co">#&gt; 1:   1    1        7.134 -0.0005894 0.990  301   1200  300    1199 6.98   6.43 -0.0006118 -0.0005894 -0.000008988    -0.0005804</span></span>
<span><span class="co">#&gt; 2:   2    1        8.536 -0.0006122 0.991 2401   3300 2400    3299 7.05   6.52 -0.0005895 -0.0006122 -0.000008988    -0.0006032</span></span>
<span><span class="co">#&gt; 3:   3    1        9.564 -0.0006155 0.980 4201   4831 4200    4830 6.95   6.59 -0.0005714 -0.0006155 -0.000008988    -0.0006066</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Note how the <code>rep</code> column is carried forward to the
results. We can see a small adjustment to the rates in the final column.
Here we are adjusting by a single value, but other adjustment methods in
<code>adjust_rate</code> can be used with <code>calc_rate.int</code>
objects. See <code><a href="../articles/adjust_rate.html">vignette("adjust_rate")</a></code> for examples, and
<code><a href="../articles/intermittent_long.html">vignette("intermittent_long")</a></code> for how a dynamic background
rate can be applied to intermittent-flow data.</p>
</div>
<div class="section level3">
<h3 id="convert_short">Convert<a class="anchor" aria-label="anchor" href="#convert_short"></a>
</h3>
<p>Lastly, we convert the rates to units.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rates_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rates_adj</span>,</span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"mg/l"</span>,</span>
<span>                                time.unit <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>                                output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,</span>
<span>                                mass <span class="op">=</span> <span class="fl">0.006955</span>,</span>
<span>                                volume <span class="op">=</span> <span class="fl">2.379</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; convert_rate: Object of class 'adjust_rate' detected. Converting all adjusted rates in '$rate.adjusted'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq density  row endrow time endtime  oxy endoxy       rate   adjustment rate.adjusted rate.input oxy.unit time.unit volume     mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:   1    1        7.134 -0.0005894 0.990      NA  301   1200  300    1199 6.98   6.43 -0.0005894 -0.000008988    -0.0005804 -0.0005804     mg/L       sec  2.379 0.006955   NA NA NA NA   -4.971     -0.7147          NA   mgO2/hr/g     -0.7147</span></span>
<span><span class="co">#&gt; 2:   2    1        8.536 -0.0006122 0.991      NA 2401   3300 2400    3299 7.05   6.52 -0.0006122 -0.000008988    -0.0006032 -0.0006032     mg/L       sec  2.379 0.006955   NA NA NA NA   -5.166     -0.7428          NA   mgO2/hr/g     -0.7428</span></span>
<span><span class="co">#&gt; 3:   3    1        9.564 -0.0006155 0.980      NA 4201   4831 4200    4830 6.95   6.59 -0.0006155 -0.000008988    -0.0006066 -0.0006066     mg/L       sec  2.379 0.006955   NA NA NA NA   -5.195     -0.7469          NA   mgO2/hr/g     -0.7469</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Again note how the <code>rep</code> column is carried forward.</p>
<p>A final rate can be determined in a number of ways and will be
specific to each experiment. As an example we can use the mean of all
three replicates.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">urch_rates_conv</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # mean.convert_rate # -------------------</span></span>
<span><span class="co">#&gt; Mean of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean of 3 output rates:</span></span>
<span><span class="co">#&gt; [1] -0.7348</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr/g"</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>See also <code><a href="../articles/select_rate.html">vignette("select_rate")</a></code> for more advanced rate
selection.</p>
</div>
</div>
<div class="section level2">
<h2 id="auto_rate-int">
<code>auto_rate.int</code><a class="anchor" aria-label="anchor" href="#auto_rate-int"></a>
</h2>
<p>Also introduced in <a href="https://januarharianto.github.io/respR/articles/release_notes.html#version-2-1-2022-12-06"><code>respR v2.1</code></a>,
<code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code> is a dedicated function for
intermittent-flow respirometry data which allows you to run the
<code><a href="../reference/auto_rate.html">auto_rate()</a></code> function on every replicate. You can use it to
extract from each replicate the most linear (i.e. most consistently
sustained) rates, the lowest or highest rates of a specific duration, or
any of the other methods supported by <code>auto_rate</code>. This
vignette - <code><a href="../articles/auto_rate.int.html">vignette("auto_rate.int")</a></code> - covers the basic
functionality.</p>
<p>Here we’ll repeat the above analysis, but this time use
<code>auto_rate.int</code> to extract the most linear (i.e. most
consistently maintained) rate from each replicate, which could be
considered a routine metabolic rate (RMR).</p>
<div class="section level3">
<h3 id="rate">Rate<a class="anchor" aria-label="anchor" href="#rate"></a>
</h3>
<p><code>auto_rate.int</code> has a few additional inputs to consider
related to the use of <code><a href="../reference/auto_rate.html">auto_rate()</a></code>. See
<code><a href="../reference/auto_rate.html">help("auto_rate")</a></code> and <code><a href="../articles/auto_rate.html">vignette("auto_rate")</a></code>
for full details, but briefly these are to specify the
<code>method</code> and <code>width</code>. The <code>by</code> input
which controls the units of <code>starts</code>, <code>wait</code> and
<code>measure</code> also applies to the <code>width</code> input.
Lastly, <code>n</code> controls how many results to return from each
replicate, the default being <code>1</code>.</p>
<p>A notable difference from <code>calc_rate.int</code> is that while
you also specify a <code>measure</code> phase the
<code>auto_rate.int</code> analysis occurs <em>within</em> this region,
and the width of the rates (i.e. duration or rows over which they occur)
may be of various lengths depending on the <code>method</code> and
<code>width</code> inputs.</p>
<p>Here, we again want to exclude the first 5 minutes (300 rows) of each
replicate to allow for the specimen to settle down after the flush. We
then calculate rates from within a different <code>measure</code> period
in each replicate to use as much of the data as possible. We specify the
<code>"linear"</code> method, and use a <code>width</code> of
<code>400</code>, which was arrived at after some testing of different
values. See <a href="https://januarharianto.github.io/respR/articles/auto_rate.html#width">here</a>
for discussion of appropriate widths to use with
<code>auto_rate</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/auto_rate.int.html">auto_rate.int</a></span><span class="op">(</span><span class="va">urchin_int</span>,</span>
<span>                            starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span>,</span>
<span>                            wait <span class="op">=</span> <span class="fl">300</span>,</span>
<span>                            measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">1100</span>, <span class="fl">600</span><span class="op">)</span>,</span>
<span>                            method <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>                            width <span class="op">=</span> <span class="fl">400</span>, </span>
<span>                            legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_short_files/figure-html/unnamed-chunk-22-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.auto_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq density  row endrow time endtime  oxy endoxy       rate</span></span>
<span><span class="co">#&gt; 1:   1    1        7.119 -0.0005736 0.988   13621  495   1291  494    1290 6.84   6.40 -0.0005736</span></span>
<span><span class="co">#&gt; 2:   2    1        8.549 -0.0006169 0.988   15364 2402   3186 2401    3185 7.06   6.60 -0.0006169</span></span>
<span><span class="co">#&gt; 3:   3    1        9.715 -0.0006501 0.956   24620 4251   4663 4250    4662 6.93   6.68 -0.0006501</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>That’s it. This is our RMR for each replicate.</p>
</div>
<div class="section level3">
<h3 id="adjust">Adjust<a class="anchor" aria-label="anchor" href="#adjust"></a>
</h3>
<p>In this example, just to show a different adjustment method, let’s
say we had a concurrent control experiment running. We’ll pretend the
same background data we used <a href="#adjustcrint">above</a> is from
this concurrent control. Assuming that the data have the same starting
timepoint, this adjustment method calculates a background rate from the
exact same region in the background data that each rate was calculated
from.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rates_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rates</span>,</span>
<span>                              by <span class="op">=</span> <span class="va">bg_rate</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"concurrent"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: adjust_rate: 'x' and 'by' inputs differ in length by more than 5%. </span></span>
<span><span class="co">#&gt; method = "concurrent" is intended for background experiments that have been run in parallel and so should be approximately the same length, and share the same 'time' data. </span></span>
<span><span class="co">#&gt; Adjustments have been attempted anyway, using shared or closest time values in the 'x' and 'by' inputs.</span></span>
<span><span class="co">#&gt; adjust_rate: Rate adjustments applied using "concurrent" method.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.adjust_rate # -----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using 'concurrent' method.</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq density  row endrow time endtime  oxy endoxy       rate   adjustment rate.adjusted</span></span>
<span><span class="co">#&gt; 1:   1    1        7.119 -0.0005736 0.988   13621  495   1291  494    1290 6.84   6.40 -0.0005736 -0.000008391    -0.0005652</span></span>
<span><span class="co">#&gt; 2:   2    1        8.549 -0.0006169 0.988   15364 2402   3186 2401    3185 7.06   6.60 -0.0006169 -0.000003028    -0.0006139</span></span>
<span><span class="co">#&gt; 3:   3    1        9.715 -0.0006501 0.956   24620 4251   4663 4250    4662 6.93   6.68 -0.0006501 -0.000001678    -0.0006484</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>We can see there has been a very small, but different, adjustment
made to each rate. See <a href="https://januarharianto.github.io/respR/articles/adjust_rate.html#example-2---intermittent-flow-respirometry">here</a>
for a better example of this adjustment method in the context of
intermittent-flow analyses.</p>
</div>
<div class="section level3">
<h3 id="convert">Convert<a class="anchor" aria-label="anchor" href="#convert"></a>
</h3>
<p>Last step is to convert.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rates_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rates_adj</span>,</span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"mg/l"</span>,</span>
<span>                                time.unit <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>                                output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,</span>
<span>                                mass <span class="op">=</span> <span class="fl">0.006955</span>,</span>
<span>                                volume <span class="op">=</span> <span class="fl">2.379</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; convert_rate: Object of class 'adjust_rate' detected. Converting all adjusted rates in '$rate.adjusted'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq density  row endrow time endtime  oxy endoxy       rate   adjustment rate.adjusted rate.input oxy.unit time.unit volume     mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:   1    1        7.119 -0.0005736 0.988   13621  495   1291  494    1290 6.84   6.40 -0.0005736 -0.000008391    -0.0005652 -0.0005652     mg/L       sec  2.379 0.006955   NA NA NA NA   -4.841     -0.6960          NA   mgO2/hr/g     -0.6960</span></span>
<span><span class="co">#&gt; 2:   2    1        8.549 -0.0006169 0.988   15364 2402   3186 2401    3185 7.06   6.60 -0.0006169 -0.000003028    -0.0006139 -0.0006139     mg/L       sec  2.379 0.006955   NA NA NA NA   -5.258     -0.7560          NA   mgO2/hr/g     -0.7560</span></span>
<span><span class="co">#&gt; 3:   3    1        9.715 -0.0006501 0.956   24620 4251   4663 4250    4662 6.93   6.68 -0.0006501 -0.000001678    -0.0006484 -0.0006484     mg/L       sec  2.379 0.006955   NA NA NA NA   -5.553     -0.7984          NA   mgO2/hr/g     -0.7984</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>This method could also be easily adapted to extract the lowest or
highest rates of a specific duration from each replicate.</p>
</div>
</div>
<div class="section level2">
<h2 id="alternative-approaches">Alternative approaches<a class="anchor" aria-label="anchor" href="#alternative-approaches"></a>
</h2>
<p>Previous versions of this vignette demonstrated use of different
methods, such as looping and subsetting of data, to extract individual
replicates for processing through <code>calc_rate</code> or
<code>auto_rate</code>. These approaches still work and are archived <a href="https://januarharianto.github.io/respR/articles/archive/intermittent_old.html">here</a>
in case they are of use in some cases. However for most analyses use of
<code>calc_rate.int</code> or <code>auto_rate.int</code> is the
recommended approach.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
