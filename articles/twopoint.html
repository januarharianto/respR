<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Two-point rate calculation • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Two-point rate calculation">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR in Use</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Two-point rate calculation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/twopoint.Rmd" class="external-link"><code>vignettes/twopoint.Rmd</code></a></small>
      <div class="hidden name"><code>twopoint.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Best practice in respirometry is usually to use linear regression on
timeseries recordings of oxygen concentrations to derive a slope and
thus rate of oxygen use.</p>
<p>Technically, an overall rate between any two timepoints can be
calculated using only two oxygen values as long as they are accurate
recordings, and in the past “<em>closed-bottle</em>” respirometry was
common, where only the initial and final oxygen concentrations were
measured. In the modern day there is little excuse for not using
continuous data recordings when it is relatively cheap and easy to do
so. Use of only initial and ending oxygen values gives no information
about how rates of use may have fluctuated, and such rates are highly
sensitive to error and inaccurate readings.</p>
<p>For some applications however, there may be valid reasons for using
only two datapoints of oxygen concentration separated by a known time
period to calculate a rate. This could be in cases of periodic and
irregular oxygen monitoring or sampling in the field, or alternatively
where the investigator is not interested in oxygen uptake or productions
rates <em>per se</em>, but rather in total oxygen flux over a time
period. An example of this is in respirometry studies of sediment
communities, where oxygen flux is correlated with transport of other
chemicals or nutrients (e.g. <a href="https://januarharianto.github.io/respR/articles/refs.html#references">Smith
Jr. 1987</a>). In such cases, even if continuous data exist, fitting a
linear regression to these data may not be appropriate, and in fact
could be grossly incorrect. This is particularly the case where oxygen
or oxygen use fluctuates significantly over the time period of the
experiment, such as with a diurnal rhythm. In such cases linear
regressions may be significantly skewed.</p>
<p><code>respR</code> includes the ability to calculate two-point rates.
While we recommend it not be used for analysis of data from laboratory
based studies looking at organismal metabolic rates, we have
incorporated the functionality for the above use-cases, and for analysis
of historical closed-bottle respirometry data.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="inspecting-data">Inspecting data<a class="anchor" aria-label="anchor" href="#inspecting-data"></a>
</h3>
<p>This dataset contain recordings of oxygen from an eutrophic lake over
a period of 40 hours starting at midnight.</p>
<pre><code><span><span class="co">#&gt;      hours oxygen</span></span>
<span><span class="co">#&gt;   1:  2.39   5.88</span></span>
<span><span class="co">#&gt;   2:  2.48   5.70</span></span>
<span><span class="co">#&gt;   3:  2.72   5.61</span></span>
<span><span class="co">#&gt;   4:  2.77   5.47</span></span>
<span><span class="co">#&gt;   5:  2.87   5.38</span></span>
<span><span class="co">#&gt;  ---             </span></span>
<span><span class="co">#&gt; 174: 40.99  12.64</span></span>
<span><span class="co">#&gt; 175: 40.99  12.87</span></span>
<span><span class="co">#&gt; 176: 41.33  12.90</span></span>
<span><span class="co">#&gt; 177: 41.33  12.90</span></span>
<span><span class="co">#&gt; 178: 41.33  12.90</span></span></code></pre>
<p>Time is in hours, and oxygen in <code>mg/L</code>. Let’s
<code><a href="../reference/inspect.html">inspect()</a></code> the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">lake</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="twopoint_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We can see the oxygen in the lake fluctuates with a diurnal rhythm,
increasing over the day and decreasing at night, and the rolling rate
similarly fluctuates. We use <code>rate.rev = FALSE</code> here to force
the rolling rate plot to plot production rates as positive values,
uptake rates as negative.</p>
</div>
<div class="section level3">
<h3 id="calculating-rate">Calculating rate<a class="anchor" aria-label="anchor" href="#calculating-rate"></a>
</h3>
<p>The researcher wants to know the overall rate of oxygen flux between
12 noon on the first day (hour 12) and 12 noon on the next (hour 36). We
will use <code>calc_rate</code> as we normally would to get the rate
between these two timepoints.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">lake_insp</span>, </span>
<span>                       from <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                       to <span class="op">=</span> <span class="fl">36</span>,</span>
<span>                       by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="twopoint_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>It is immediately clear the linear regression based rate completely
misrepresents the overall oxygen flux and instead of a small net oxygen
flux, suggests there is a large net oxygen consumption.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lake_rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq row endrow time endtime  oxy endoxy rate.2pt   rate</span></span>
<span><span class="co">#&gt; 1:  NA    1           16   -0.323 0.456  42    147 11.9      36 7.16   7.69   0.0221 -0.323</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>However, looking at the summary we can see the <code>$rate.2pt</code>
as the second from last column. This is simply the oxygen differential
between the two timepoints divided by the time difference, and shows us
there was a slight net oxygen production. In this case, this rate is
much more relevant towards the research question.</p>
</div>
<div class="section level3">
<h3 id="converting">Converting<a class="anchor" aria-label="anchor" href="#converting"></a>
</h3>
<p>This two-point rate will not be the one converted if we pass the
<code>calc_rate</code> object to <code>convert_rate</code>, however we
can enter the two-point rate as a value to convert the rate to
units.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_rate_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="fl">0.02213001</span>,</span>
<span>                               oxy.unit <span class="op">=</span> <span class="st">"mg/l"</span>,</span>
<span>                               time.unit <span class="op">=</span> <span class="st">"hrs"</span>,</span>
<span>                               output.unit <span class="op">=</span> <span class="st">"umol/h"</span>,</span>
<span>                               volume <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, extract it directly.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lake_rate_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">lake_rate</span><span class="op">$</span><span class="va">rate.2pt</span>,</span>
<span>                               oxy.unit <span class="op">=</span> <span class="st">"mg/l"</span>,</span>
<span>                               time.unit <span class="op">=</span> <span class="st">"hrs"</span>,</span>
<span>                               output.unit <span class="op">=</span> <span class="st">"umol/h"</span>,</span>
<span>                               volume <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; convert_rate: Numeric input detected. Converting all numeric rates.</span></span>
<span><span class="co"># print</span></span>
<span><span class="va">lake_rate_conv</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] 0.0221</span></span>
<span><span class="co">#&gt; [1] "mg/L" "hr"  </span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] 0.692</span></span>
<span><span class="co">#&gt; [1] "umolO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Note here the <code>volume</code> input. This is not a respirometry
experiment, so there is no “volume” as such. In this situation this
should refer to the volume used in the oxygen concentration unit (in
this case litres), so the rate is dimensionally relative to <em>any</em>
volume of this lake. This will be the case for any units of oxygen,
because internally they are all converted to mg/L before conversion to
the output units, so for use cases like the above it should always be
entered as <code>1</code>.</p>
<p>We can verify our hourly rate is correct using the <code>$oxy</code>
and <code>$endoxy</code> values from the summary table. If we convert
these to <code>umol/L</code>, then divide the difference by the time
taken (24h) then we should get the same result.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># start conc</span></span>
<span><span class="fu"><a href="../reference/convert_DO.html">convert_DO</a></span><span class="op">(</span><span class="fl">7.16</span>, from <span class="op">=</span> <span class="st">"mg/l"</span>, to <span class="op">=</span> <span class="st">"umol/L"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 223.8</span></span>
<span></span>
<span><span class="co"># end conc</span></span>
<span><span class="fu"><a href="../reference/convert_DO.html">convert_DO</a></span><span class="op">(</span><span class="fl">7.69</span>, from <span class="op">=</span> <span class="st">"mg/l"</span>, to <span class="op">=</span> <span class="st">"umol/L"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 240.3</span></span>
<span></span>
<span><span class="co"># Total in umol produced over this 24h period per L</span></span>
<span><span class="fl">240.3</span> <span class="op">-</span> <span class="fl">223.8</span></span>
<span><span class="co">#&gt; [1] 16.5</span></span>
<span></span>
<span><span class="co"># umol produced per hour per Litre of lake over 24h</span></span>
<span><span class="fl">16.5</span><span class="op">/</span><span class="fl">24</span></span>
<span><span class="co">#&gt; [1] 0.6875</span></span></code></pre></div>
<p>We can see this is very close to the same result. The difference is
simply due to the higher precision of internal values compared to what
we have entered here.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
