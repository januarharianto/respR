<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flowthrough respirometry • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Flowthrough respirometry">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Flowthrough respirometry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/flowthrough.Rmd" class="external-link"><code>vignettes/flowthrough.Rmd</code></a></small>
      <div class="hidden name"><code>flowthrough.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="ftintro">Introduction<a class="anchor" aria-label="anchor" href="#ftintro"></a>
</h2>
<p>Flowthrough respirometry differs from other methods in that rates of
oxygen change are measured from a controlled, continuous flow of water
through a respirometer rather than a known volume, typically after the
system has achieved equilibrium. In this method, two oxygen
concentrations are needed: ‘downstream’ and ‘upstream’ of the
experimental chamber, or the outflow and inflow concentrations. These
are used to calculate an oxygen delta (outflow minus inflow values), and
this is used with the flow rate to calculate oxygen consumption or
production rates.</p>
<p>An outflow recording or value, or already determined delta oxygen
values are required to calculate the rate. The inflow concentration is
typically a simultaneous recording, but an alternative is to use a known
value from a source of constant oxygen concentration such as fully
air-saturated water, or water from a header tank of controlled oxygen
concentration, and so often is not continuously monitored.
<code>respR</code> will accept any combination of available data to
allow rates to be calculated.</p>
<p><code>respR</code> contains a workflow to process flowthrough
respirometry data comprising five functions:</p>
<ul>
<li>
<code>inspect.ft</code>                 - check and visualise the
data and calculate the oxygen delta (if you haven’t already)</li>
<li>
<code>calc_rate.ft</code>            - calculate a rate from a
region (or several) of the data</li>
<li>
<code>adjust_rate.ft</code>      - adjust the rate for background
activity</li>
<li>
<code>convert_rate.ft</code>   - convert the rate to specific units,
including mass- or area-specific</li>
<li>
<code>select_rate.ft</code>      - filter rate results according to
various criteria</li>
</ul>
<p>Not all of these are necessary depending on the analysis. See
examples below.</p>
</div>
<div class="section level2">
<h2 id="exploring-flowthrough-respirometry-data">Exploring flowthrough respirometry data<a class="anchor" aria-label="anchor" href="#exploring-flowthrough-respirometry-data"></a>
</h2>
<p>Typically the first step in data analysis is inspecting and
visualising the data.</p>
<p>The <code>inspect.ft</code> function can be used to quickly examine
and visualise outflow and inflow data from a single chamber, but also a
large multi-column dataset. Using it with no inputs will inspect and
plot every column, assuming <code>time</code> is in column 1 and all
others are delta oxygen data (<code>delta.oxy</code>). Even if your data
is not delta oxygen values, you can use this without saving the result
for a quick look at the data. Note, if you do not tell it otherwise, the
function assumes data are delta oxygen and plots them on a reverse
y-axis. However, we can use the <code>rate.rev</code> input to override
this</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, rate.rev <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect.ft: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect.ft: Applying column default of all non-time column(s) as 'delta.oxy'</span></span>
<span><span class="co">#&gt; Warning: inspect.ft: Time values are not evenly-spaced (numerically).</span></span>
<span><span class="co">#&gt; inspect.ft: Data issues detected. For more information use print().</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect.ft # --------------------</span></span>
<span><span class="co">#&gt;                 num.time oxy.out.1 oxy.out.2 oxy.out.3 oxy.out.blank oxy.in.1 oxy.in.2 oxy.in.3 oxy.in.blank oxy.delta.1 oxy.delta.2 oxy.delta.3 oxy.delta.blank oxy.header temperature</span></span>
<span><span class="co">#&gt; numeric             pass      pass      pass      pass          pass     pass     pass     pass         pass        pass        pass        pass            pass       pass        pass</span></span>
<span><span class="co">#&gt; Inf/-Inf            pass      pass      pass      pass          pass     pass     pass     pass         pass        pass        pass        pass            pass       pass        pass</span></span>
<span><span class="co">#&gt; NA/NaN              pass      pass      pass      pass          pass     pass     pass     pass         pass        pass        pass        pass            pass       pass        pass</span></span>
<span><span class="co">#&gt; sequential          pass         -         -         -             -        -        -        -            -           -           -           -               -          -           -</span></span>
<span><span class="co">#&gt; duplicated          pass         -         -         -             -        -        -        -            -           -           -           -               -          -           -</span></span>
<span><span class="co">#&gt; evenly-spaced       WARN         -         -         -             -        -        -        -            -           -           -           -               -          -           -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uneven Time data locations (first 20 shown) in column: num.time </span></span>
<span><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] 0.01 0.02</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-1-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The result does not have to be saved. This functionality can be used
simply to get a quick overview of a dataset, check there are no common
issues, and make sure the columns contain the data we expect. Column 1
contains the time data. Here, we can see columns 2 to 4 contain
declining oxygen, and so as expected are the outflow oxygen data. There
is also outflow oxygen from a control experiment which does not appear
to decline very much (column 5). We can see there are no anomalies in
the inflow oxygen data (columns 6 to 9) that might affect calculated
rates. We can quickly see the existing delta oxygen columns (10,11,12)
have, when the experiment has reached equilibrium, consistent values
(around -8), and that the background delta (column 13) is also
consistent. There is also a column of oxygen recorded in a shared header
tank (column 14), and one of temperature (column 15).</p>
<p>Note, if multiple columns are inspected like this, and the object
saved, subsequent functions such as <code>calc_rate.ft</code> will use
only the first column of delta oxygen data for analysis. Best practice
is to inspect each experimental dataset or group of columns
individually. See later examples.</p>
</div>
<div class="section level2">
<h2 id="case-studies">Case Studies<a class="anchor" aria-label="anchor" href="#case-studies"></a>
</h2>
<p><code>respR</code> contains several example flowthrough datasets:
<code>flowthrough.rd</code>, <code>flowthrough_mult.rd</code>,
<code>flowthrough_sim.rd</code>.</p>
<p>We will use these here to run through some specific use cases and
example analyses of flowthrough respirometry that should cover most user
needs. If there are any not covered please <a href="https://januarharianto.github.io/respR/articles/contact.html"><strong>get
in touch</strong></a> and we will attempt to accommodate them.</p>
</div>
<div class="section level2">
<h2 id="case1">Case 1: Outflow oxygen only<a class="anchor" aria-label="anchor" href="#case1"></a>
</h2>
<p><em>“We only have an outflow oxygen recording, but we know the
concentration of the inflowing water does not vary much, because it was
from an aerated, constant temperature and salinity header tank that we
tested to be 100% air saturated frequently. We also know from pilot
trials background is negligible, so we don’t need to perform an
adjustment.”</em></p>
<p>Here, we will inspect the data, calculate a rate from a stable,
consistent region, and convert it to units</p>
<div class="section level3">
<h3 id="example-data">Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>The data <code>flowthrough.rd</code> contains measurements of oxygen
consumption in a species of chiton, (<em>Mopalia lignosa</em>). Detailed
information about the data, can be obtained with the command
<code><a href="../reference/flowthrough.rd.html">?flowthrough.rd</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">flowthrough.rd</span>, n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;     time oxy.out oxy.in oxy.delta</span></span>
<span><span class="co">#&gt;    &lt;int&gt;   &lt;num&gt;  &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     0    8.17   8.88    -0.710</span></span>
<span><span class="co">#&gt; 2:     1    8.17   8.88    -0.714</span></span>
<span><span class="co">#&gt; 3:     2    8.17   8.90    -0.731</span></span>
<span><span class="co">#&gt; 4:     3    8.17   8.88    -0.710</span></span></code></pre></div>
<p>We can see this dataset contains time values (<code>secs</code>),
both outflow and inflow oxygen concentrations (<code>mg/L</code>), and
an oxygen delta, which is simply the difference between outflow and
inflow. We will ignore these last two columns here.</p>
</div>
<div class="section level3">
<h3 id="case1oxy">Determine inflow oxygen<a class="anchor" aria-label="anchor" href="#case1oxy"></a>
</h3>
<p>Knowing the temperature and salinity of the header tank allows us to
calculate the saturated concentration (strictly speaking atmospheric
pressure is also required, but we will use the default value).
Obviously, we want the same oxygen units as the outflow recording.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/convert_DO.html">convert_DO</a></span><span class="op">(</span><span class="fl">100</span>, from <span class="op">=</span> <span class="st">"%Air"</span>, to <span class="op">=</span> <span class="st">"mg/L"</span>,</span>
<span>           t <span class="op">=</span> <span class="fl">12</span>, S <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; convert_DO: Input or output units require Atmospheric Pressure input (i.e. P = ??). </span></span>
<span><span class="co">#&gt; Default value of P = 1.013253 bar has been used.</span></span>
<span><span class="co">#&gt; [1] 8.92</span></span></code></pre></div>
<p>Therefore we know the theoretical concentration of the header tank in
these conditions and this can be used as an inflow oxygen value.</p>
</div>
<div class="section level3">
<h3 id="inspect-data">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data"></a>
</h3>
<p>The concentration of the header tank can be entered as the
<code>in.oxy.value</code> in <code>inspect.ft</code>, which will allow
it to calculate an oxygen delta. We use <code>time</code> and
<code>out.oxy</code> to specify the respective columns.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect</span></span>
<span><span class="va">insp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy.value <span class="op">=</span> <span class="fl">8.92</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect.ft # --------------------</span></span>
<span><span class="co">#&gt;                 time oxy.out</span></span>
<span><span class="co">#&gt; numeric         pass    pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass    pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass    pass</span></span>
<span><span class="co">#&gt; sequential      pass       -</span></span>
<span><span class="co">#&gt; duplicated      pass       -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass       -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The data checks show us there are no structural issues with the data,
such as missing values or gaps. The top plot shows outflow and the
entered, constant inflow oxygen against both time (bottom axis) and row
index (top axis), which are the same here because data are recorded
every second. The bottom plot shows the calculated delta oxygen values,
which is a proxy for the rate. In these plots, consistent oxygen uptake
or production rates will be represented by level or flat regions. Here
there is some fluctuation towards the end of the data, but the first 400
rows look to have stable rates.</p>
<p>To help with choosing regions of the data from which to calculate
rates, you can pass the <code>width</code> input in the main function
call or when plotting the output object. This should be a value between
0 and 1 representing a proportion of the total data length, and smooths
the delta oxygen values by performing a rolling mean.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">insp1</span>, width <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This is a visual aid and only affects plotted values. It does not
alter the delta oxygen values in the output.</p>
</div>
<div class="section level3">
<h3 id="case1plot">Calculate rate<a class="anchor" aria-label="anchor" href="#case1plot"></a>
</h3>
<p>Calculating a rate requires the <code>flowrate</code> of water
through the respirometer in a volume (<code>ul</code>, <code>ml</code>,
or <code>L</code>) per unit time (<code>sec</code>, <code>min</code>,
<code>hr</code>, or <code>day</code>). Here, only the value is required;
the actual units will be entered in a later conversion function. For
this dataset experimental data are in <code><a href="../reference/flowthrough.rd.html">?flowthrough.rd</a></code>, and
in this example the flowrate is <code>2.34 mL/min</code>. (Yes, this
flowrate is extremely low! It was controlled with a peristaltic pump,
and gives you an idea of what it takes to get a viable rate via
flowthrough respirometry from a small coldwater mollusc!).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rate</span></span>
<span><span class="va">rate1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp1</span>, from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">400</span>, by <span class="op">=</span> <span class="st">"row"</span>, flowrate <span class="op">=</span> <span class="fl">2.34</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.ft # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -1.74 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<p><code>calc_rate.ft</code> calculates the rate by averaging all delta
oxygen values within the chosen data region, and multiplying this by the
flowrate. The bottom plot shows this region in close-up. Note, the
dashed line is only there to illustrate the trend.</p>
</div>
<div class="section level3">
<h3 id="case1rate">Convert rate<a class="anchor" aria-label="anchor" href="#case1rate"></a>
</h3>
<p>New we take the unitless rate from <code>calc_rate.ft</code> and
convert it to output units. This can be an absolute rate, that is of the
whole animal or chamber, or a mass- or area-specific rate if either of
these are entered. Here we will calculate both the absolute and
mass-specific rate of this chiton.</p>
<p>Here we need to tell the function the units of oxygen of the original
data and of the flowrate, as well as the mass of the specimen in
<code>kg</code>. Lastly, we specify the output units.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># absolute rate</span></span>
<span><span class="va">rate1_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate1</span>,  </span>
<span>                             oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,  </span>
<span>                             flowrate.unit <span class="op">=</span> <span class="st">"ml/min"</span>,  </span>
<span>                             output.unit <span class="op">=</span> <span class="st">"mg/h"</span><span class="op">)</span>  </span>
<span><span class="co"># mass-specific rate  </span></span>
<span><span class="va">rate1_ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate1</span>,  </span>
<span>                            oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,  </span>
<span>                            flowrate.unit <span class="op">=</span> <span class="st">"ml/min"</span>,  </span>
<span>                            mass <span class="op">=</span> <span class="fl">0.000070</span>,  <span class="co"># mass must always be in kg</span></span>
<span>                            output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">#&gt; ########### Absolute rate ##########</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -1.74</span></span>
<span><span class="co">#&gt; [1] "mg/L"   "mL/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -0.105</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ######## Mass-specific rate ########</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -1.74</span></span>
<span><span class="co">#&gt; [1] "mg/L"   "mL/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -1.49</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr/g"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Rates can easily be extracted from the output using
<code>$rate.output</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate1_final</span> <span class="op">&lt;-</span> <span class="va">rate1_ms</span><span class="op">$</span><span class="va">rate.output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rate1_final</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1.49</span></span></code></pre></div>
<p>Or you can use <code>summary</code> and <code>export = TRUE</code> to
save the summary table as a new data frame which contains all rate
regression parameters and data locations, adjustments (if applied),
units, and more. This is a great way of exporting all the relevant data
for your final results.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate1_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rate1_ms</span>, export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate1_final</span></span>
<span><span class="co">#&gt;       rep  rank intercept_b0   slope_b1   rsq   row endrow  time endtime   oxy endoxy delta_mean flowrate  rate adjustment rate.adjusted rate.input oxy.unit flowrate.unit    mass   area      S      t     P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;    &lt;lgcl&gt; &lt;int&gt;        &lt;num&gt;      &lt;num&gt; &lt;num&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;   &lt;int&gt; &lt;num&gt;  &lt;num&gt;      &lt;num&gt;    &lt;num&gt; &lt;num&gt;     &lt;lgcl&gt;        &lt;lgcl&gt;      &lt;num&gt;   &lt;char&gt;        &lt;char&gt;   &lt;num&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;num&gt;    &lt;num&gt;       &lt;num&gt;      &lt;lgcl&gt;      &lt;char&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     NA     1       -0.742 -0.0000123 0.079     1    400     0     399 -0.75 -0.741     -0.745     2.34 -1.74         NA            NA      -1.74     mg/L        mL/min 0.00007     NA     NA     NA  1.01   -0.105       -1.49          NA   mgO2/hr/g       -1.49</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="case-2-outflow-and-inflow-oxygen">Case 2: Outflow and inflow oxygen<a class="anchor" aria-label="anchor" href="#case-2-outflow-and-inflow-oxygen"></a>
</h2>
<p><em>“We have both outflow and inflow oxygen recordings. We also know
from pilot trials background is negligible, so we don’t need to perform
an adjustment.”</em></p>
<p>This is a very similar analysis to <a href="#case1">Case 1</a> above,
but we will use the inflow oxygen recording as the <code>in.oxy</code>
input. The process is otherwise the same: <code>inspect.ft</code>,
<code>calc_rate.ft</code>, and <code>convert_rate.ft</code>.</p>
<div class="section level3">
<h3 id="inspect-data-1">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data-1"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect</span></span>
<span><span class="va">insp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect.ft # --------------------</span></span>
<span><span class="co">#&gt;                 time oxy.out oxy.in</span></span>
<span><span class="co">#&gt; numeric         pass    pass   pass</span></span>
<span><span class="co">#&gt; Inf/-Inf        pass    pass   pass</span></span>
<span><span class="co">#&gt; NA/NaN          pass    pass   pass</span></span>
<span><span class="co">#&gt; sequential      pass       -      -</span></span>
<span><span class="co">#&gt; duplicated      pass       -      -</span></span>
<span><span class="co">#&gt; evenly-spaced   pass       -      -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Compared to the <code>inspect.ft</code> plot in <a href="#case1plot">Case 1</a> the delta oxygen values are less variable,
which suggests that at least some of the variation observed in the
previous example is explained by variation in inflowing oxygen levels.
This means that in this example delta oxygen are more consistent, so we
will use the entire dataset to calculate the rate.</p>
</div>
<div class="section level3">
<h3 id="calculate-rate">Calculate rate<a class="anchor" aria-label="anchor" href="#calculate-rate"></a>
</h3>
<p>Since we are happy the rate is consistent across the whole datatset,
running <code>calc_rate.ft</code> using the default values will
calculate rate as the average of every delta oxygen value multiplied by
the flowrate.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rate</span></span>
<span><span class="va">rate2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp2</span>, flowrate <span class="op">=</span> <span class="fl">2.34</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.ft # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -1.65 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The slightly lower rate value we get here than in Case 1 (1.65 vs
1.74) suggests the header tank supply is not quite at the theoretical
maximum air saturation that we calculated in <a href="#case1oxy">Case
1</a>, and demonstrates that it is always a good idea to have a
recording of the inflow water or shared water source if it is practical
to do so.</p>
</div>
<div class="section level3">
<h3 id="convert-rate">Convert rate<a class="anchor" aria-label="anchor" href="#convert-rate"></a>
</h3>
<p>We will convert to only the mass-specific rate this time.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mass-specific rate  </span></span>
<span><span class="va">rate2_ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate2</span>,  </span>
<span>                            oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,  </span>
<span>                            flowrate.unit <span class="op">=</span> <span class="st">"ml/min"</span>,  </span>
<span>                            mass <span class="op">=</span> <span class="fl">0.000070</span>,  </span>
<span>                            output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -1.65</span></span>
<span><span class="co">#&gt; [1] "mg/L"   "mL/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -1.42</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr/g"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="case3">Case 3: Outflow and inflow oxygen plus control<a class="anchor" aria-label="anchor" href="#case3"></a>
</h2>
<p><em>“We have both outflow and inflow oxygen recordings. We have also
have a concurrent recording from a blank control chamber that we want to
use to adjust the specimen rates.”</em></p>
<p>The <code>flowthrough_mult.rd</code> dataset contains several columns
of data from a flowthrough experiment using three specimen chambers and
one control chamber: <em>paired</em> columns of outflow (cols 2,3,4,5)
and inflow (cols 6,7,8,9) oxygen recordings, delta oxygen columns (cols
10,11,12,13) calculated from these paired columns, and a recording from
a shared header tank (col 14). Other experimental parameters can be seen
with <code><a href="../reference/flowthrough_mult.rd.html">?flowthrough_mult.rd</a></code>. The units of time are minutes,
and of oxygen percent air saturation (<code>%Air</code>). We will
convert to actual units of oxygen concentration when we convert the
rate.</p>
<div class="section level3">
<h3 id="inspect-data-2">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data-2"></a>
</h3>
<p>We will use <code>inspect.ft</code> to examine the first specimen
column pair of outflow and inflow oxygen.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect</span></span>
<span><span class="va">insp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Warning: inspect.ft: Time values are not evenly-spaced (numerically).</span></span>
<span><span class="co">#&gt; inspect.ft: Data issues detected. For more information use print().</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-22-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here we see a warning about not evenly-spaced time values. This comes
from this dataset using decimalised minutes as the time values and can
be safely ignored (the full <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> command provides more
details).</p>
<p>This data is typical of flowthrough experiments, in that it takes
some time before the experiment stabilises, that is the specimen’s
respiration rate reaches equilibrium with the supply of oxygen. Here
this occurs after around 25 minutes, so we don’t want to use any data
before this. Rates after this are very stable however.</p>
</div>
<div class="section level3">
<h3 id="calculate-rate-1">Calculate rate<a class="anchor" aria-label="anchor" href="#calculate-rate-1"></a>
</h3>
<p>No inputs for <code>to</code> and <code>by</code> means the function
will calculate the rate from the <code>from</code> input to the end of
the dataset in the default units of <code>"time"</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rate</span></span>
<span><span class="va">rate3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp3</span>, from <span class="op">=</span> <span class="fl">30</span>, flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.ft # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -0.749 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-24-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="case3bg">Calculate background rate<a class="anchor" aria-label="anchor" href="#case3bg"></a>
</h3>
<p>The fourth column pair contains outflow and inflow oxygen from a
blank control chamber that we will use to determine the contribution of
microbial respiration to the oxygen used, with the assumption that this
is the same in the specimen chambers. Note, it is important that
background experiments are conducted with the same equipment, under the
same conditions, and using the same flowrate as specimen experiments,
and data are in the same units. They do not necessarily have to be run
concurrently; <code>respR</code> allows you to save a background rate to
adjust multiple different experiments.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect</span></span>
<span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">5</span>, in.oxy <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-26-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here we see there is a slight but noticeable difference in outflow
and inflow oxygen due to microbial action. Moreover, it appears to be
constant, so we can use the entire dataset to calculate a background
rate.</p>
<p>We use the same <code>calc_rate.ft</code> function to calculate and
save background rates.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rate</span></span>
<span><span class="va">bgrate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">bg</span>, flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.ft # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -0.0317 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-28-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="adjust-rate">Adjust rate<a class="anchor" aria-label="anchor" href="#adjust-rate"></a>
</h3>
<p>Now we use the saved background rate object to adjust the specimen
rate we determined earlier.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjust rate</span></span>
<span><span class="va">rate3adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span><span class="va">rate3</span>, by <span class="op">=</span> <span class="va">bgrate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -0.749</span></span>
<span><span class="co">#&gt; Adjustment    : -0.0317</span></span>
<span><span class="co">#&gt; Adjusted Rate : -0.717 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>We can see this performs a small but significant adjustment to the
specimen rate.</p>
<p>Note how <code>adjust_rate.ft</code> can accept
<code>calc_rate.ft</code> objects for both inputs. This same background
rate object can similarly be applied to the other specimen experiments
in this dataset, or indeed other datasets if they are collected under
the same conditions. However, it also accepts numeric values. This will
give the exact same result.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjust rate</span></span>
<span><span class="va">rate3adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span><span class="va">rate3</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.03174</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -0.749</span></span>
<span><span class="co">#&gt; Adjustment    : -0.0317</span></span>
<span><span class="co">#&gt; Adjusted Rate : -0.717 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>This means you can quantify a value for a background rate and apply
it to many experiments as you see fit, for example the mean rate of
several background experiments. In fact, if you enter multiple
background rates this is the default behaviour.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjust rate</span></span>
<span><span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span><span class="va">rate3</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.030</span>, <span class="op">-</span><span class="fl">0.032</span>, <span class="op">-</span><span class="fl">0.038</span>, <span class="op">-</span><span class="fl">0.040</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -0.749</span></span>
<span><span class="co">#&gt; Adjustment    : -0.035</span></span>
<span><span class="co">#&gt; Adjusted Rate : -0.714 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><strong><em>Note:</em></strong> be careful when entering rates
manually like this. In <code>respR</code> oxygen uptake rates are
negative since they represent a negative slope of oxygen against time.
Background rates are typically similarly <em>negative</em> (though not
always). If you are examining oxygen production, rates are positive, and
background rates may be either sign. To summarise: oxygen removal or use
is always negative, oxygen input or production is always positive.</p>
</div>
<div class="section level3">
<h3 id="convert-adjusted-rate">Convert adjusted rate<a class="anchor" aria-label="anchor" href="#convert-adjusted-rate"></a>
</h3>
<p>Now we convert the adjusted rate. We will convert to an absolute rate
this time, and a different output oxygen unit.</p>
<p>Because the original oxygen data were in units of percent air
saturation, we need to enter the temperature, salinity and atmospheric
pressure to convert these to actual concentration units of oxygen. These
can be found the data help file: <code><a href="../reference/flowthrough_mult.rd.html">?flowthrough_mult.rd</a></code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># absolute rate  </span></span>
<span><span class="va">rate3_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate3adj</span>,  </span>
<span>                             oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,  </span>
<span>                             flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                             output.unit <span class="op">=</span> <span class="st">"ml/h"</span>,</span>
<span>                             t <span class="op">=</span> <span class="fl">18</span>, S <span class="op">=</span> <span class="fl">0</span>, P <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.717</span></span>
<span><span class="co">#&gt; [1] "%Air"  "L/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -3.03</span></span>
<span><span class="co">#&gt; [1] "mLO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="case-4-delta-oxygen-values">Case 4: Delta oxygen values<a class="anchor" aria-label="anchor" href="#case-4-delta-oxygen-values"></a>
</h2>
<p><em>“We have already calculated a delta oxygen between outflow and
inflow oxygen concentrations.”</em></p>
<p>For cases where delta oxygen between outflow and inflow
concentrations has already been calculated, these data can be inspected
using the <code>delta.oxy</code> input and used to calculate rates.
<code>flowthrough_mult.rd</code> contains these in columns 10 to 13. We
will use the second column of these.</p>
<div class="section level3">
<h3 id="inspect-data-3">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data-3"></a>
</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect</span></span>
<span><span class="va">insp4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, delta.oxy <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-38-1.png" width="960" style="display: block; margin: auto;"></p>
<p>When delta oxygen data are inspected, only one plot is produced of
the entered delta oxygen values. Note how delta oxygen are plotted on a
reverse y-axis, so that higher uptake rates are plotted higher even
though they are lower numerically (more negative). This can be changed
by passing <code>rate.rev = FALSE</code> in the main call or when
plotting the output.</p>
<p>Again we see the experiment has not reached equilibrium until after
around 20 minutes, so we will not use any data before this.</p>
</div>
<div class="section level3">
<h3 id="calculate-rate-2">Calculate rate<a class="anchor" aria-label="anchor" href="#calculate-rate-2"></a>
</h3>
<p>This time we will calculate rates using subsetting by
<code>"row"</code> which can be see in the top red x-axis.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rate</span></span>
<span><span class="va">rate4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp4</span>, from <span class="op">=</span> <span class="fl">2000</span>, to <span class="op">=</span> <span class="fl">3000</span>, by <span class="op">=</span> <span class="st">"row"</span>, flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.ft # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -0.803 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-40-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="adjust-rate-1">Adjust rate<a class="anchor" aria-label="anchor" href="#adjust-rate-1"></a>
</h3>
<p>We already determined background rate in <a href="#case3bg">Case
3</a>, so we can use the same object here.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjust rate</span></span>
<span><span class="va">rate4adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span><span class="va">rate4</span>, by <span class="op">=</span> <span class="va">bgrate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -0.803</span></span>
<span><span class="co">#&gt; Adjustment    : -0.0317</span></span>
<span><span class="co">#&gt; Adjusted Rate : -0.771 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="convert-adjusted-rate-1">Convert adjusted rate<a class="anchor" aria-label="anchor" href="#convert-adjusted-rate-1"></a>
</h3>
<p>Now we convert the adjusted rate.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mass-specific rate  </span></span>
<span><span class="va">rate4_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate4adj</span>,  </span>
<span>                             oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,  </span>
<span>                             flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                             output.unit <span class="op">=</span> <span class="st">"ml/h"</span>,</span>
<span>                             t <span class="op">=</span> <span class="fl">18</span>, S <span class="op">=</span> <span class="fl">0</span>, P <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.771</span></span>
<span><span class="co">#&gt; [1] "%Air"  "L/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -3.26</span></span>
<span><span class="co">#&gt; [1] "mLO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="case-5-active-rates">Case 5: Active rates<a class="anchor" aria-label="anchor" href="#case-5-active-rates"></a>
</h2>
<p><em>“We imposed a treatment at a specific time to increase the
specimen’s activity and want to determine an active metabolic rate from
this region of the data.”</em></p>
<div class="section level3">
<h3 id="inspect-data-4">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data-4"></a>
</h3>
<p>Inspecting the data from the third chamber, we can see a prominent
area where the specimen’s oxygen consumption rate increased, before
slowly recovering to routine levels.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect </span></span>
<span><span class="va">insp5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">4</span>, in.oxy <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-46-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Note how delta oxygen are plotted on a reverse y-axis, so that higher
uptake rates are plotted higher even though they are lower numerically
(more negative). If you are examining oxygen <em>production</em> rates,
you can pass the <code>rate.rev = FALSE</code> input in the main call or
when plotting the output to see higher production rates plotted
higher.</p>
<p>Since we are only interested in this active region, we can use the
<code><a href="../reference/subset_data.html">subset_data()</a></code> function and pipe (<code>%&gt;%</code>) the
result to <code>inspect.ft</code> for a closer look.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset and inspect</span></span>
<span><span class="va">insp5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, from <span class="op">=</span> <span class="fl">30</span>, to <span class="op">=</span> <span class="fl">50</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-grapes.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">4</span>, in.oxy <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-48-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Note, the row index x-axis now refers to the subset not the original
data. We can see the highest active rate occurs between around 38 and 42
minutes, so we will use this region to calculate the active rate.</p>
</div>
<div class="section level3">
<h3 id="calculate-rate-3">Calculate rate<a class="anchor" aria-label="anchor" href="#calculate-rate-3"></a>
</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rate</span></span>
<span><span class="va">rate5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp5</span>, from <span class="op">=</span> <span class="fl">38</span>, to <span class="op">=</span> <span class="fl">42</span>, by <span class="op">=</span> <span class="st">"time"</span>, flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-50-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="adjust-rate-2">Adjust rate<a class="anchor" aria-label="anchor" href="#adjust-rate-2"></a>
</h3>
<p>We can also adjust this rate by the background rate we saved
earlier.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjust rate</span></span>
<span><span class="va">rate5adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span><span class="va">rate5</span>, by <span class="op">=</span> <span class="va">bgrate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -1.19</span></span>
<span><span class="co">#&gt; Adjustment    : -0.0317</span></span>
<span><span class="co">#&gt; Adjusted Rate : -1.16 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="convert-adjusted-rate-2">Convert adjusted rate<a class="anchor" aria-label="anchor" href="#convert-adjusted-rate-2"></a>
</h3>
<p>Lastly we convert the adjusted rate, this time to a mass-specific
rate, and try another different oxygen amount metric in the output
units.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># mass-specific rate  </span></span>
<span><span class="va">rate5_ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate5adj</span>,  </span>
<span>                            oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,  </span>
<span>                            flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                            output.unit <span class="op">=</span> <span class="st">"umol/h/g"</span>,</span>
<span>                            mass <span class="op">=</span> <span class="fl">0.020</span>,</span>
<span>                            t <span class="op">=</span> <span class="fl">18</span>, S <span class="op">=</span> <span class="fl">0</span>, P <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -1.16</span></span>
<span><span class="co">#&gt; [1] "%Air"  "L/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -10.2</span></span>
<span><span class="co">#&gt; [1] "umolO2/hr/g"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="case-6-non-constant-background-rates">Case 6: Non-constant background rates<a class="anchor" aria-label="anchor" href="#case-6-non-constant-background-rates"></a>
</h2>
<p><em>“We want to correct for both non-constant background activity and
any possible fluctuation in inflow oxygen concentrations using a
concurrent empty control or "blank" chamber.”</em></p>
<p>In some experiments, as well as possible fluctuations in the oxygen
content of the inflowing water, the background rate may change over the
course of the experiment. While the former will be accounted for by
having an inflow oxygen recording, they can both be accounted for
simultaneously by using the outflow recording from a blank control
chamber to adjust a specimen chamber. This can be done by using it as
the <code>in.oxy</code> input in <code>inspect.ft</code>.</p>
<p>The <code>flowthrough_sim.rd</code> dataset contains data from an
experiment where the background rate increases as the experiment
progresses. There are four columns; time, outflow oxygen from the
specimen and blank chambers, and the inflow oxygen in a header tank
supplying both.</p>
<div class="section level3">
<h3 id="inspect-data-5">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data-5"></a>
</h3>
<p>We will inspect the specimen chamber as we normally would, using the
header tank as the inflow recording.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect </span></span>
<span><span class="va">insp6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_sim.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-56-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here we see, after the initial period before the experiment has
reached equilibrium, the specimen rate apparently continues to increase.
This suggests that the background rate may not be constant.</p>
</div>
<div class="section level3">
<h3 id="inspect-background">Inspect background<a class="anchor" aria-label="anchor" href="#inspect-background"></a>
</h3>
<p>If we examine the background data in the same way:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect </span></span>
<span><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_sim.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">3</span>, in.oxy <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-58-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We can see the background rate increases as the experiment
progresses, in what looks like a constant manner. With the presumption
that this is also occurring in the specimen chamber, we only need to use
the outflow recording from the control chamber as the
<code>in.oxy</code> input to account for this.</p>
</div>
<div class="section level3">
<h3 id="account-for-background">Account for background<a class="anchor" aria-label="anchor" href="#account-for-background"></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect </span></span>
<span><span class="va">insp6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_sim.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-60-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Now we see that when the background is accounted for, the specimen
rates are consistent, and we can go ahead and calculate a rate.</p>
</div>
<div class="section level3">
<h3 id="calculate-rate-4">Calculate rate<a class="anchor" aria-label="anchor" href="#calculate-rate-4"></a>
</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rate</span></span>
<span><span class="va">rate6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp6</span>, from <span class="op">=</span> <span class="fl">2000</span>, to <span class="op">=</span> <span class="fl">3000</span>, by <span class="op">=</span> <span class="st">"row"</span>, flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-62-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The rate can now be converted as in the above examples.</p>
<p>Note, that in this case the background rate increased in a constant,
linear manner. Under other conditions, the background may vary in other
ways, such as increase exponentially, or decrease due to lower light
levels at night. Inflowing oxygen may also vary due to various reasons.
It’s important to note that the above method of accounting for
background and other fluctuations in oxygen will work for <em>all</em>
these cases, under the presumption that the same thing is occurring in
specimen chambers.</p>
</div>
</div>
<div class="section level2">
<h2 id="case-7-single-values-only">Case 7: Single values only<a class="anchor" aria-label="anchor" href="#case-7-single-values-only"></a>
</h2>
<p><em>“We do not have continuous recordings. We took spot readings of
inflow and outflow recordings, after they had stabilised (i.e. the
experiment had reached equilibrium), and we want to use these to
calculate the rate.”</em></p>
<p>Flowthrough respirometry has advantages over other respirometry
methods, in that because there is a constant supply of water (and
therefore oxygen) experiments can be run for much longer, allowing
specimens to acclimate better to the experimental conditions without
concerns about effects of hypoxia or waste build up. They can also be
more practical and a more efficient use of equipment, in that continuous
recordings of oxygen (while ideal practice) are not always necessary as
long as experiments are monitored to ensure they have reached
equilibrium. In these cases, a single oxygen probe could be used to
sample the outflow and inflow oxygen of any number of separate chambers,
and so in cases of limited equipment availability help with increasing
the amount of data collected.</p>
<p>All the functions (where possible) in <code>respR</code> accept
numeric inputs, as well as other <code>R</code> objects such as data
frames and data tables. As long as care is taken to keep units and
inputs consistent, these can be used to calculate rates. In this
example, after monitoring to ensure equilibrium has been reached, spot
readings can be used to calculate the routine respiration rate of
specimens.</p>
<div class="section level3">
<h3 id="create-dataframe">Create dataframe<a class="anchor" aria-label="anchor" href="#create-dataframe"></a>
</h3>
<p>In this example, we have a spot sample of outflow and inflow oxygen.
We just need to put these into a data frame with any <code>time</code>
value to be able to process them in <code>inspect.ft</code>.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Single spot checks of outflow and inflow</span></span>
<span><span class="co">## Create dataframe</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 outflow <span class="op">=</span> <span class="fl">7.32</span>,</span>
<span>                 inflow <span class="op">=</span> <span class="fl">8.04</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inspect-calculate-rate-convert">Inspect, calculate rate, convert<a class="anchor" aria-label="anchor" href="#inspect-calculate-rate-convert"></a>
</h3>
<p>Now all we need to do is the usual workflow: <code>inspect.ft</code>
&gt; <code>calc_rate.ft</code> &gt; <code>convert_rate.ft</code>.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">insp7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">df</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">rate7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp7</span>, flowrate <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">rate7_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate7</span>,</span>
<span>                             oxy.unit <span class="op">=</span> <span class="st">"mg/l"</span>,  </span>
<span>                             flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                             output.unit <span class="op">=</span> <span class="st">"mg/h"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.ft # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -0.18 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.18</span></span>
<span><span class="co">#&gt; [1] "mg/L"  "L/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -10.8</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="delta-oxygen-values">Delta oxygen values<a class="anchor" aria-label="anchor" href="#delta-oxygen-values"></a>
</h3>
<p>In fact, things are even simpler if spot readings are converted to
delta oxygen values, as <code>calc_rate.ft</code> can convert these
directly. We can also adjust the rate in <code>adjust_rate.ft</code>
using a rate calculated from similar spot readings from a control
chamber.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## specimen delta oxygen = outflow minus inflow</span></span>
<span><span class="va">del7</span> <span class="op">&lt;-</span> <span class="fl">7.32</span> <span class="op">-</span> <span class="fl">8.04</span></span>
<span><span class="co">## control delta oxygen</span></span>
<span><span class="va">delbg</span> <span class="op">&lt;-</span> <span class="fl">7.97</span> <span class="op">-</span> <span class="fl">8.04</span></span>
<span></span>
<span><span class="va">rate7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">del7</span>, flowrate <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">ratebg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">delbg</span>, flowrate <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rate7_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span><span class="va">rate7</span>, by <span class="op">=</span> <span class="va">ratebg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rate7_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rate7_adj</span>,</span>
<span>                             oxy.unit <span class="op">=</span> <span class="st">"mg/l"</span>,  </span>
<span>                             flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                             output.unit <span class="op">=</span> <span class="st">"mg/h"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "# del7"</span></span>
<span><span class="co">#&gt; [1] -0.72</span></span>
<span><span class="co">#&gt; [1] "# bg7"</span></span>
<span><span class="co">#&gt; [1] -0.07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.ft # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -0.18 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -0.18</span></span>
<span><span class="co">#&gt; Adjustment    : -0.0175</span></span>
<span><span class="co">#&gt; Adjusted Rate : -0.162 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.162</span></span>
<span><span class="co">#&gt; [1] "mg/L"  "L/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -9.75</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="multiple-delta-oxygen-values">Multiple delta oxygen values<a class="anchor" aria-label="anchor" href="#multiple-delta-oxygen-values"></a>
</h3>
<p>You can even use vectorised operations to convert multiple rates.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## specimen delta oxygen = outflow minus inflow</span></span>
<span><span class="va">outflows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.32</span>, <span class="fl">7.45</span>, <span class="fl">7.19</span>, <span class="fl">7.27</span><span class="op">)</span></span>
<span><span class="co">## control delta oxygen</span></span>
<span><span class="va">inflows</span> <span class="op">&lt;-</span> <span class="fl">8.04</span></span>
<span></span>
<span><span class="va">deltas</span> <span class="op">&lt;-</span> <span class="va">outflows</span> <span class="op">-</span> <span class="va">inflows</span></span>
<span><span class="va">rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">deltas</span>, flowrate <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="va">rates_abs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">rates</span>,</span>
<span>                             oxy.unit <span class="op">=</span> <span class="st">"mg/l"</span>,  </span>
<span>                             flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                             output.unit <span class="op">=</span> <span class="st">"mg/h"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 4 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.18</span></span>
<span><span class="co">#&gt; [1] "mg/L"  "L/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -10.8</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see other results use 'pos' input. </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate.ft # -------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1 rsq row endrow time endtime oxy endoxy delta_mean flowrate   rate adjustment rate.adjusted rate.input oxy.unit flowrate.unit mass area  S  t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1           NA       NA  NA  NA     NA   NA      NA  NA     NA      -0.72     0.25 -0.180         NA            NA     -0.180     mg/L         L/min   NA   NA NA NA 1.01   -10.80          NA          NA     mgO2/hr      -10.80</span></span>
<span><span class="co">#&gt; 2:  NA    2           NA       NA  NA  NA     NA   NA      NA  NA     NA      -0.59     0.25 -0.147         NA            NA     -0.147     mg/L         L/min   NA   NA NA NA 1.01    -8.85          NA          NA     mgO2/hr       -8.85</span></span>
<span><span class="co">#&gt; 3:  NA    3           NA       NA  NA  NA     NA   NA      NA  NA     NA      -0.85     0.25 -0.212         NA            NA     -0.212     mg/L         L/min   NA   NA NA NA 1.01   -12.75          NA          NA     mgO2/hr      -12.75</span></span>
<span><span class="co">#&gt; 4:  NA    4           NA       NA  NA  NA     NA   NA      NA  NA     NA      -0.77     0.25 -0.192         NA            NA     -0.192     mg/L         L/min   NA   NA NA NA 1.01   -11.55          NA          NA     mgO2/hr      -11.55</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>By default the first output is printed, but you can print others by
using the <code>pos</code> input,
e.g. <code>print(rates_abs, pos = 2)</code> or by using
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to see all results.</p>
</div>
</div>
<div class="section level2">
<h2 id="rollrate">Case 8: Rolling rate<a class="anchor" aria-label="anchor" href="#rollrate"></a>
</h2>
<p><em>“We want to calculate every rate of a fixed width across the
entire dataset and then filter the results manually. We are interested
in the routine metabolic rate and the maximum metabolic rate from
particular regions of the data.”</em></p>
<p><code>calc_rate.ft</code> can calculate a rolling rate of fixed width
in rows across the dataset. In this case there will be multiple rates in
<code>output$rate</code> and the same number of rows in
<code>output$summary</code>. The <code><a href="../reference/select_rate.html">select_rate.ft()</a></code> function
can be used to filter the results according to various criteria. See
<code><a href="../articles/select_rate.html">vignette("select_rate")</a></code> for examples with non-flowthrough
data, but which are essentially the same.</p>
<p>Note the <code>calc_rate.ft</code> summary table contains linear
regression coefficients alongside other metadata. <em>These should not
be confused with those returned by other functions</em>. In outputs of
functions such as <code>calc_rate</code>, slopes represent rates and
coefficients such as a high r-squared are important. With flowthrough
data the linear model is fit through the delta oxygen values averaged to
provide a final rate. Therefore slope generally represents the stability
of the data region, in that the closer it is to zero, the less the delta
oxygen values in that region vary, which is an indication of a region of
stable rates. They are included to enable possible future functionality
where stable regions may be automatically identified, and should
generally be ignored. However, advanced users can use these and
<code><a href="../reference/select_rate.html">select_rate.ft()</a></code> to explore and subset the results if they
wish.</p>
<p>In this example, we want to extract a routine metabolic rate (RMR)
which we will define as the most consistent rate sustained across a five
minute window, and also a maximum metabolic rate (MMR) or the highest
rate sustained across a five minute window.</p>
<div class="section level3">
<h3 id="inspect-data-6">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data-6"></a>
</h3>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## inspect</span></span>
<span><span class="va">insp8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">4</span>, in.oxy <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-72-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Here, we see it takes around 10 minutes for the the experiment to
reach equilibrium, so we want to exclude rates before this time. We then
see a region of consistent rates from which we will extract the RMR,
then a region of higher activity and therefore higher rates from which
we will get the MMR.</p>
</div>
<div class="section level3">
<h3 id="calculate-rate-across-rolling-window">Calculate rate across rolling window<a class="anchor" aria-label="anchor" href="#calculate-rate-across-rolling-window"></a>
</h3>
<p>In these data (with oxygen recorded once per second, but the time
values in decimalised minutes) a five minute window would be 300 rows.
We will calculate a rolling rate across this window, adjust and convert
the results, and in the following sections filter them to get a final
RMR and MMR.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate rolling 5-minute rate</span></span>
<span><span class="va">roll_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp8</span>, width <span class="op">=</span> <span class="fl">300</span>, by <span class="op">=</span> <span class="st">"row"</span>, flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co"># adjust rates</span></span>
<span><span class="va">roll_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span><span class="va">roll_rate</span>, by <span class="op">=</span> <span class="va">bgrate</span><span class="op">)</span></span>
<span><span class="co"># convert rates to mass-specific</span></span>
<span><span class="va">roll_rate_ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span><span class="va">roll_rate_adj</span>,  </span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,  </span>
<span>                                flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                                output.unit <span class="op">=</span> <span class="st">"umol/h/g"</span>,</span>
<span>                                mass <span class="op">=</span> <span class="fl">0.020</span>,</span>
<span>                                t <span class="op">=</span> <span class="fl">18</span>, S <span class="op">=</span> <span class="fl">0</span>, P <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate.ft # -------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       rep rank intercept_b0 slope_b1    rsq  row endrow  time endtime   oxy endoxy delta_mean flowrate   rate adjustment rate.adjusted rate.input oxy.unit flowrate.unit mass area S  t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;    1:  NA    1        -4.14  -0.5535 0.9572    1    300  0.02    5.00 -4.09  -7.04      -5.52      0.1 -0.552    -0.0317        -0.521     -0.521     %Air         L/min 0.02   NA 0 18 1.01    -92.2       -4.61          NA umolO2/hr/g       -4.61</span></span>
<span><span class="co">#&gt;    2:  NA    2        -4.14  -0.5538 0.9572    2    301  0.03    5.02 -4.04  -7.05      -5.53      0.1 -0.553    -0.0317        -0.522     -0.522     %Air         L/min 0.02   NA 0 18 1.01    -92.4       -4.62          NA umolO2/hr/g       -4.62</span></span>
<span><span class="co">#&gt;    3:  NA    3        -4.14  -0.5540 0.9572    3    302  0.05    5.03 -4.00  -7.07      -5.54      0.1 -0.554    -0.0317        -0.523     -0.523     %Air         L/min 0.02   NA 0 18 1.01    -92.5       -4.63          NA umolO2/hr/g       -4.63</span></span>
<span><span class="co">#&gt;    4:  NA    4        -4.14  -0.5540 0.9572    4    303  0.07    5.05 -3.95  -7.11      -5.55      0.1 -0.555    -0.0317        -0.524     -0.524     %Air         L/min 0.02   NA 0 18 1.01    -92.7       -4.64          NA umolO2/hr/g       -4.64</span></span>
<span><span class="co">#&gt;    5:  NA    5        -4.14  -0.5539 0.9572    5    304  0.08    5.07 -3.90  -7.14      -5.56      0.1 -0.556    -0.0317        -0.525     -0.525     %Air         L/min 0.02   NA 0 18 1.01    -92.9       -4.65          NA umolO2/hr/g       -4.65</span></span>
<span><span class="co">#&gt;   ---                                                                                                                                                                                                                                                </span></span>
<span><span class="co">#&gt; 3437:  NA 3437        -9.71   0.0198 0.0191 3437   3736 57.28   62.27 -8.74  -8.77      -8.53      0.1 -0.853    -0.0317        -0.821     -0.821     %Air         L/min 0.02   NA 0 18 1.01   -145.3       -7.27          NA umolO2/hr/g       -7.27</span></span>
<span><span class="co">#&gt; 3438:  NA 3438        -9.61   0.0181 0.0160 3438   3737 57.30   62.28 -8.71  -8.73      -8.53      0.1 -0.853    -0.0317        -0.821     -0.821     %Air         L/min 0.02   NA 0 18 1.01   -145.3       -7.27          NA umolO2/hr/g       -7.27</span></span>
<span><span class="co">#&gt; 3439:  NA 3439        -9.52   0.0166 0.0135 3439   3738 57.32   62.30 -8.68  -8.70      -8.53      0.1 -0.853    -0.0317        -0.821     -0.821     %Air         L/min 0.02   NA 0 18 1.01   -145.3       -7.27          NA umolO2/hr/g       -7.27</span></span>
<span><span class="co">#&gt; 3440:  NA 3440        -9.45   0.0154 0.0116 3440   3739 57.33   62.32 -8.66  -8.67      -8.53      0.1 -0.853    -0.0317        -0.821     -0.821     %Air         L/min 0.02   NA 0 18 1.01   -145.3       -7.27          NA umolO2/hr/g       -7.27</span></span>
<span><span class="co">#&gt; 3441:  NA 3441        -9.39   0.0144 0.0102 3441   3740 57.35   62.33 -8.64  -8.64      -8.53      0.1 -0.853    -0.0317        -0.821     -0.821     %Air         L/min 0.02   NA 0 18 1.01   -145.3       -7.27          NA umolO2/hr/g       -7.27</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>We can see there are 3441 results, which is obviously a lot of
information. As of <a href="https://januarharianto.github.io/respR/articles/release_notes.html"><code>respR v2.2</code></a>
<code>convert_rate.ft</code> objects can be plotted to help explore the
results in three different ways. See
<code><a href="../reference/convert_rate.ft.html">help("convert_rate.ft")</a></code> for full details. Here we will use
the <code>type = "rate"</code> option which plots output rates in a way
that you can see how they vary across the dataset.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot rates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roll_rate_ms</span>, type <span class="op">=</span> <span class="st">"rate"</span><span class="op">)</span></span>
<span><span class="co">#&gt; plot.convert_rate.ft: Plotting all rate(s)...</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-76-1.png" width="960" style="display: block; margin: auto;"></p>
<p>At a fixed width the rolling rate is obviously closely related to the
delta oxygen values. We can use <code>pos</code> to more closely examine
output rates from particular regions.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot rates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roll_rate_ms</span>, type <span class="op">=</span> <span class="st">"rate"</span>, pos <span class="op">=</span> <span class="fl">500</span><span class="op">:</span><span class="fl">1700</span><span class="op">)</span></span>
<span><span class="co">#&gt; plot.convert_rate.ft: Plotting rate(s) from selected 'pos' rows...</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-77-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This tells us our extracted RMR should be around 7.30 to 7.40
umol/hr/g.</p>
</div>
<div class="section level3">
<h3 id="select-results-for-rmr">Select results for RMR<a class="anchor" aria-label="anchor" href="#select-results-for-rmr"></a>
</h3>
<p>The <code>select_rate.ft</code> function allows you to apply multiple
selection criteria by either saving the result and processing it through
the function multiple times or by using pipes (<code>|&gt;</code> or
<code>%&gt;%</code>). Here, to get RMR we will only use rates from 10 to
30 minutes, then select the lowest tenth percentile of these rates, and
then take the mean of these. Please note, this is not a recommendation
that this is how you should extract an RMR from your own data; it is
simply an example of one approach and how the <code>respR</code>
functions are flexible and adaptable. An alternative approach might be
to select only the single lowest rate, for instance.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rmr</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">roll_rate_ms</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate.ft</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"time"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate.ft</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lowest_percentile"</span>, n <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; select_rate: Selecting rates which occur only between times 10 and 30...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 2539 rate(s) removed, 902 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; select_rate: Selecting lowest 10th percentile of *absolute* rate values...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 811 rate(s) removed, 91 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate.ft # -------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rep rank intercept_b0 slope_b1     rsq  row endrow time endtime   oxy endoxy delta_mean flowrate   rate adjustment rate.adjusted rate.input oxy.unit flowrate.unit mass area S  t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt;  1:  NA 1200        -8.43 -0.00685 0.00281 1200   1499 20.0    25.0 -8.74  -8.57      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt;  2:  NA 1201        -8.43 -0.00701 0.00295 1201   1500 20.0    25.0 -8.74  -8.48      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt;  3:  NA 1202        -8.43 -0.00684 0.00280 1202   1501 20.0    25.0 -8.75  -8.39      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt;  4:  NA 1203        -8.44 -0.00634 0.00239 1203   1502 20.1    25.0 -8.67  -8.30      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt;  5:  NA 1204        -8.45 -0.00578 0.00198 1204   1503 20.1    25.1 -8.60  -8.36      -8.58      0.1 -0.858    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt; ---                                                                                                                                                                                                                                                </span></span>
<span><span class="co">#&gt; 87:  NA 1494        -9.23  0.02360 0.03397 1494   1793 24.9    29.9 -8.41  -8.71      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt; 88:  NA 1495        -9.24  0.02394 0.03503 1495   1794 24.9    29.9 -8.46  -8.68      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt; 89:  NA 1499        -9.30  0.02597 0.04110 1499   1798 25.0    30.0 -8.57  -8.39      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt; 90:  NA 1500        -9.33  0.02689 0.04387 1500   1799 25.0    30.0 -8.48  -8.37      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt; 91:  NA 1501        -9.36  0.02804 0.04760 1501   1800 25.0    30.0 -8.39  -8.41      -8.59      0.1 -0.859    -0.0317        -0.827     -0.827     %Air         L/min 0.02   NA 0 18 1.01     -146       -7.32          NA umolO2/hr/g       -7.32</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # mean.convert_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; Mean of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean of 91 output rates:</span></span>
<span><span class="co">#&gt; [1] -7.32</span></span>
<span><span class="co">#&gt; [1] "umolO2/hr/g"</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Note how the <code>slope_b1</code> values are very close to zero,
that is the linear regression fit through the delta mean values averaged
to get each rate is close to a flat line. This is an indication that the
region has stable delta oxygen values and therefore stable rates.
<code>select_rate.ft</code> has a <code>slope</code> method so these
could be used to select results based on stable values.</p>
</div>
<div class="section level3">
<h3 id="select-results-for-mmr">Select results for MMR<a class="anchor" aria-label="anchor" href="#select-results-for-mmr"></a>
</h3>
<p>To get MMR we will simply extract the single highest 5-minute rate
from the region of elevated rates at around 40 minutes.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmr</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">roll_rate_ms</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate.ft</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"time"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_rate.html">select_rate.ft</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"highest"</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span>export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; select_rate: Selecting rates which occur only between times 30 and 50...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 2539 rate(s) removed, 902 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; select_rate: Selecting highest 1 *absolute* rate values...</span></span>
<span><span class="co">#&gt; ----- Selection complete. 901 rate(s) removed, 1 rate(s) remaining -----</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate.ft # -------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1    rsq  row endrow time endtime   oxy endoxy delta_mean flowrate  rate adjustment rate.adjusted rate.input oxy.unit flowrate.unit mass area S  t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA 2270        -12.8   0.0232 0.0247 2270   2569 37.8    42.8 -11.8  -11.7      -11.8      0.1 -1.18    -0.0317         -1.15      -1.15     %Air         L/min 0.02   NA 0 18 1.01     -204       -10.2          NA umolO2/hr/g       -10.2</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Here we have used the <code>export</code> option in
<code>summary</code> which saves the summary table as a data frame. This
is a great way of saving results for archiving or further analysis.</p>
<p>The <code>rank</code> column tells us which result this is and can be
used to plot this result using <code>pos</code> for a closer look using
the <code>type = "full"</code> option.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roll_rate_ms</span>, pos <span class="op">=</span> <span class="fl">2270</span>, type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span>
<span><span class="co">#&gt; plot.convert_rate.ft: Plotting rate(s) from selected 'pos' rows...</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-82-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="case-9-multiple-rates-from-the-same-dataset">Case 9: Multiple rates from the same dataset<a class="anchor" aria-label="anchor" href="#case-9-multiple-rates-from-the-same-dataset"></a>
</h2>
<p><em>“We want to extract rates from several different time periods
during an experiment.”</em></p>
<p>As can be seen in the above example, where we used a rolling window,
multiple rates can be extracted from different regions of the same
dataset, even overlapping ones. As well as using the <code>width</code>
input, this can be done by entering vectors of paired start and end
values as the <code>from</code> and <code>to</code> inputs in the
appropriate <code>by</code> units.</p>
<div class="section level3">
<h3 id="inspect-and-calculate-rates">Inspect and calculate rates<a class="anchor" aria-label="anchor" href="#inspect-and-calculate-rates"></a>
</h3>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect </span></span>
<span><span class="va">insp9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">3</span>, in.oxy <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="co"># calculate rates</span></span>
<span><span class="va">rate9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span><span class="va">insp9</span>, </span>
<span>                      from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">35</span>, <span class="fl">45</span><span class="op">)</span>, </span>
<span>                      to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span><span class="op">)</span>, </span>
<span>                      by <span class="op">=</span> <span class="st">"time"</span>, </span>
<span>                      flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="examine-output">Examine output<a class="anchor" aria-label="anchor" href="#examine-output"></a>
</h3>
<p>The different rates can be plotted using the <code>pos</code>
input.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rate9</span>, pos <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # plot.calc_rate.ft # -------------------</span></span>
<span><span class="co">#&gt; calc_rate.ft: Plotting rate from position 2 of 3 ...</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-85-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>And they can all be viewed using <code>summary</code>.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rate9</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.ft # ----------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1     rsq  row endrow time endtime   oxy endoxy delta_mean flowrate   rate</span></span>
<span><span class="co">#&gt; 1:  NA    1        -9.31  0.04164 0.08033 1500   1800   25      30 -8.24  -7.86      -8.17      0.1 -0.817</span></span>
<span><span class="co">#&gt; 2:  NA    2        -8.30  0.00565 0.00164 2100   2400   35      40 -7.78  -7.97      -8.09      0.1 -0.809</span></span>
<span><span class="co">#&gt; 3:  NA    3        -8.38  0.00922 0.00410 2700   3000   45      50 -8.03  -7.95      -7.95      0.1 -0.795</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="convert-results">Convert results<a class="anchor" aria-label="anchor" href="#convert-results"></a>
</h3>
<p>The results can be adjusted and converted as in the above examples.
Both <code>adjust_rate.ft</code> and <code>convert_rate.ft</code> accept
objects containing multiple rates and can be plotted and explored in the
same way. See <a href="#rollrate">above</a> for how multiple rate
results can be filtered using <code>select_rate.ft</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="case-10-concise-reportable-analysis-using-piping">Case 10: Concise, reportable analysis using piping<a class="anchor" aria-label="anchor" href="#case-10-concise-reportable-analysis-using-piping"></a>
</h2>
<p><em>“We want to report our analyses in a reproducible way as
concisely as possible.”</em></p>
<p>The overall aim of <code>respR</code> is to facilitate reporting of
reproducible data analyses. This example is simply to show how a
complete analysis of a flowthrough respirometry experiment can be
reported concisely.</p>
<p>We will repeat the analysis from <a href="#case3">Case 3</a>, but use
piping to feed the results of one function into the next. We will use
<code>%&gt;%</code> or <code>dplyr</code> pipes here, but the new native
<code>|&gt;</code> pipes introduced in <a href="https://www.r-bloggers.com/2021/05/new-features-in-r-4-1-0/" class="external-link">R
v4.1</a> work just as well.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## calc background rate </span></span>
<span><span class="co">## (might only need to be done once and used for multiple experiments)</span></span>
<span><span class="va">bgrate</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">5</span>, in.oxy <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-grapes.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span>flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># inspect &gt; calc rate &gt; adjust &gt; convert</span></span>
<span><span class="va">rate3_abs</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-grapes.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">30</span>, flowrate <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-grapes.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/adjust_rate.ft.html">adjust_rate.ft</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">bgrate</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-grapes.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.ft.html">convert_rate.ft</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"%Air"</span>,  </span>
<span>                  flowrate.unit <span class="op">=</span> <span class="st">"L/min"</span>,  </span>
<span>                  output.unit <span class="op">=</span> <span class="st">"ml/h"</span>,</span>
<span>                  t <span class="op">=</span> <span class="fl">18</span>, S <span class="op">=</span> <span class="fl">0</span>, P <span class="op">=</span> <span class="fl">1.013</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rate3_abs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate.ft # ---------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 result(s)</span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.717</span></span>
<span><span class="co">#&gt; [1] "%Air"  "L/min"</span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -3.03</span></span>
<span><span class="co">#&gt; [1] "mLO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<ul>
<li><p>Note, that while it is required (for <code>inspect.ft</code> at
least), <code>time</code> data are never used in calculations, only for
plotting and choosing regions. Higher resolution data will provide more
delta oxygen values to average, but in general the resolution or
recording frequency of the data is less important than other factors
such as ensuring equilibrium has been reached.</p></li>
<li><p>To repeat an important point, always keep in mind the sign of the
rate. Oxygen consumption (respiration) rates are represented by negative
values, production rates by positive values.</p></li>
<li><p>As with <code><a href="../reference/inspect.html">inspect()</a></code>, by using the
<code>add.data</code> input an additional data source (for example
temperature) can be plotted in <code>inspect.ft</code> alongside the
oxygen timeseries to help with understanding where rates may or may not
have fluctuated. This input indicates a column number in the same input
data frame sharing the same time data. This is a visual aid only to help
with selection of regions from which to extract rates.</p></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot column 15 (temperature) alongside oxygen timeseries</span></span>
<span><span class="fu"><a href="../reference/inspect.ft.html">inspect.ft</a></span><span class="op">(</span><span class="va">flowthrough_mult.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, out.oxy <span class="op">=</span> <span class="fl">2</span>, in.oxy <span class="op">=</span> <span class="fl">5</span>, </span>
<span>           add.data <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-89-1.png" width="960" style="display: block; margin: auto;"></p>
<ul>
<li>The functions in the flowthrough workflow, where appropriate,
support the generic S3 functions <code>plot</code>, <code>print</code>,
<code>summary</code>, and <code>mean</code>. These have various
additional inputs such as <code>pos</code>, <code>quiet</code>, and
<code>export</code>. See relevant function help file for additional
information. In the case of <code>mean</code>, if there are multiple
rates they return the mean value of the primary output
(<code>rate</code>, <code>rate.adjusted</code>, or
<code>rate.output</code>). This can be output as a value by passing
<code>export = TRUE</code>.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
