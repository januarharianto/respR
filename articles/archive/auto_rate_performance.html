<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>auto_rate: Performance in detecting linear regions • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="auto_rate: Performance in detecting linear regions">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>auto_rate: Performance in detecting linear
regions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/archive/auto_rate_performance.Rmd" class="external-link"><code>vignettes/archive/auto_rate_performance.Rmd</code></a></small>
      <div class="hidden name"><code>auto_rate_performance.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="note">
<strong>Note</strong><a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p><em>This page has been archived and will not be updated. This is
because it was submitted as part of the <a href="https://doi.org/10.1111/2041-210X.13162" class="external-link">publication</a> of
<code>respR</code> in Methods in Ecology and Evolution, and has been
retained unchanged for reference. Any results and code outputs shown are
from <code>respR v1.1</code> code. Subsequent updates to
<code>respR</code> should produce the same or very similar results.
</em></p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The function <code>auto_rate</code> uses rolling regression and
kernel density estimation techniques to automatically detect the
<em>most linear</em> regions in respirometry data. The dimensionless
nature of the function, however, also allows it to be applied to any
serial data.</p>
<p>To our knowledge, the methods we use here are novel, and not reported
in past publications involving linear data detection and analysis of
biological data. <a href="http://doi.org/10.1242/jeb.148775" class="external-link">Olito et
al. (2016)</a> describes a different, though robust, method to detect
and rank linear segments in data using their R package,
<code>LoLinR</code>. A comparison of <code>auto_rate</code> and
<code>LoLinR</code>’s methods are shown <a href="https://januarharianto.github.io/respR/articles/auto_rate_comp.html">here</a>.</p>
<p>The performance tests that we present here are limited but
comprehensive, and provide a starting point in generating the data
necessary for users to make informed decisions on using and further
testing <code>auto_rate</code> for their own purposes. <strong>Users
should be aware</strong> that noisy, strongly fluctuating data could
cause unpredictable, unwanted results to be returned. For example, while
we have had generally good results with our own data, intermittent flow
respirometry data where O2 is fluctuating up and down between periods of
use by the specimens and flushing the respirometry chamber are likely to
confuse the algorithms. Users should always examine the outputs of
<code>auto_rate</code> (and indeed other functions in
<code>respR</code>) to understand where returned results occur within
the data and that they are representative of the question of interest.
We have made this as easy as possible, and designed the package
specifically to not be a ‘black box’ and at every stage make the user
aware of what is going on through plotting results and their locations
in the context of the entire datasets, and in the console outputs.</p>
</div>
<div class="section level2">
<h2 id="testing-the-linear-detection-method-of-auto_rate">Testing the linear detection method of auto_rate<a class="anchor" aria-label="anchor" href="#testing-the-linear-detection-method-of-auto_rate"></a>
</h2>
<p>To ensure that <code>auto_rate</code> performs as intended, we
created two internal functions designed to test the accuracy of our KDE
techniques to detect linear data. The first function,
<code><a href="../../reference/sim_data.html">sim_data()</a></code>, generates a random dataset which contains both
linear and non-linear segments. The second function,
<code><a href="../../reference/test_lin.html">test_lin()</a></code>, specifically performs <code>auto_rate</code>
repeatedly on randomly generated data and aggregates the performance
metrics obtained to assess and visualise the accuracy of the KDE
technique. Both functions are published with the <code>respR</code>
package, thus anyone can use them – as we show below – or run them with
their own input paramters.</p>
</div>
<div class="section level2">
<h2 id="generating-simulated-data-for-tests">Generating simulated data for tests<a class="anchor" aria-label="anchor" href="#generating-simulated-data-for-tests"></a>
</h2>
<p><code><a href="../../reference/sim_data.html">sim_data()</a></code> is used to randomly generate three kinds of
data based on the <code>type</code> argument, which we briefly describe
below. It accepts inputs to customise the length of the data (no. of
samples), the type of data (described below), the degree of noise as
specified by the standard deviation of the data (default 0.05), and a
preview toggle to plot and visualise the simulated dataset.</p>
<div class="section level3">
<h3 id="default-data">“Default” data<a class="anchor" aria-label="anchor" href="#default-data"></a>
</h3>
<p><code>sim_data(type = "default")</code></p>
<p>A non-linear segment is first generated using a sine or cosine
function with a random length of
<code>floor(abs(rnorm(1, .25*len, .05*len)))</code>, where
<code>len</code> is the total number of observations in the data defined
in the function argument, and a random amplitude of
<code>rnorm(1, .8, .05)</code>. This data segment is appended to a
linear segment with a randomly-generated slope computed using
<code>rnorm(1, 0, 0.02)</code>. The shape of the dataset is designed to
mimic common respirometry data whereby the initial sections of the data
are often non-linear. Here we show 25 randomly-generated plots created
by the <code>type</code>:</p>
<p><img src="img/auto_rate_perf/arperf01.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="corrupted-data">“Corrupted” data<a class="anchor" aria-label="anchor" href="#corrupted-data"></a>
</h3>
<p><code>sim_data(type = "corrupted")</code></p>
<p>Same as <code>"default"</code>, but “corrupted” data is inserted
randomly at any point in the linear segment. The data corruption is
depicted by a sudden dip in the reading, which recovers. This event
mimics equipment interference that does not necessarily invalidate the
dataset if the corrupted section is omitted from analysis. The dip is
generated by a cosine function of fixed amplitude of 1, and the length
is randomly generated using
<code>floor(rnorm(1, .25 * len_x, .02 * len_x))</code>, where
<code>len_x</code> is the length of the linear segment.</p>
<p>Thus, to detect the valid linear segment, <code>auto_rate</code> will
need to omit the initial non-linear segment, ignore the dip, and then
pick the longer of the 2 remaining linear segments that are separated by
the dip. Here we show 25 randomly-generated plots created by the
<code>type</code>:</p>
<p><img src="img/auto_rate_perf/arperf02.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="segmented-data">“Segmented” data<a class="anchor" aria-label="anchor" href="#segmented-data"></a>
</h3>
<p><code>sim_data(type = "segmented")</code></p>
<p>Same as <code>"default"</code>, but the data is modified to contain
two linear segments. The slope of the second linear segment is randomly
chosen at approximately 0.5<span class="math inline">\(\times\)</span>
to 0.6<span class="math inline">\(\times\)</span> of the first linear
segment (i.e the slope is always a magnitude smaller than the first
linear segment).</p>
<p>Thus, to detect the correct linear segment, <code>auto_rate</code>
would need to correctly omit the initial non-linear segment, and also,
ignore the end segment of the data as it has a different slope. Here we
show 25 randomly-generated plots created by the <code>type</code>:</p>
<p><img src="img/auto_rate_perf/arperf03.png" width="288" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="test-conditions">Test conditions<a class="anchor" aria-label="anchor" href="#test-conditions"></a>
</h2>
<p>To quantify the performance and accuracy of <code>auto_rate</code>’s
linear detection technique, the function <code><a href="../../reference/test_lin.html">test_lin()</a></code> runs
the linear detection technique (<code>method = "linear"</code>)
iteratively and extracts specific output parameter for analysis. The
parameters include:</p>
<ol style="list-style-type: decimal">
<li>The length of the true segment (<span class="math inline">\(len_t\)</span>);</li>
<li>The length of the detected segment that is correctly sampled (<span class="math inline">\(len_c\)</span>). Here, we also call such data
“true”;</li>
<li>The length of the detected segment that is <em>incorrectly</em>
sampled (<span class="math inline">\(len_i\)</span>). Here, we also call
such data “other”;</li>
<li>The slope of the true segment (<span class="math inline">\(\beta_{true}\)</span>, or true rate); and</li>
<li>The slope of the detected segment (<span class="math inline">\(\beta_{detected}\)</span>, or detected rate).</li>
</ol>
<p>From the above data, we can generate four kinds of performance
metrics for visualisation:</p>
<ol style="list-style-type: decimal">
<li>A density plot of the proportion of the linear segment correctly
identified. Each data point is a measure of <span class="math inline">\({len_c}\div{len_t}\)</span>.</li>
<li>A density plot of the proportion of incorrectly-sampled data. Each
data point is a measure of <span class="math inline">\({len_i}\div{len_c}\)</span>.</li>
<li>A linear regression plot, where each data point is a measure of of
<span class="math inline">\(\beta_{detected}\)</span> (y) as a function
of <span class="math inline">\(\beta_{true}\)</span> (x);</li>
<li>An x-y plot of the deviation between <span class="math inline">\(\beta_{detected}\)</span> and <span class="math inline">\(\beta_{true}\)</span>. Each data point is a
measure of <span class="math inline">\(\beta_{true} -
\beta_{detected}\)</span>.</li>
</ol>
<p>We performed <code><a href="../../reference/test_lin.html">test_lin()</a></code> with 1,000 iterations, for all
of the three kinds of data produced by <code><a href="../../reference/sim_data.html">sim_data()</a></code>
(<code>"default", "corrupted"</code>, and <code>"segmented"</code>). To
check performance on different data lengths, we repeated the tests using
100, 200 and 500 data points. The output of our performance test is
avaliable from within the package as a data object called
<code>test_lin_data</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># NOTE: Functions take some time to run</span></span>
<span></span>
<span><span class="co"># Test on data of length 100 samples -------------------------------------------</span></span>
<span><span class="co"># This performs 1,000 iterations of auto_rate on a "default"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">default100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">100</span>, type <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This performs 1,000 iterations of auto_rate on a "corrupted"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">corrupted100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">100</span>, type <span class="op">=</span> <span class="st">"corrupted"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This performs 1,000 iterations of auto_rate on a "segmented"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">segmented100</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">100</span>, type <span class="op">=</span> <span class="st">"segmented"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test on data of length 200 samples -------------------------------------------</span></span>
<span><span class="co"># This performs 1,000 iterations of auto_rate on a "default"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">default200</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">200</span>, type <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This performs 1,000 iterations of auto_rate on a "corrupted"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">corrupted200</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">200</span>, type <span class="op">=</span> <span class="st">"corrupted"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This performs 1,000 iterations of auto_rate on a "segmented"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">segmented200</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">200</span>, type <span class="op">=</span> <span class="st">"segmented"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test on data of length 500 samples -------------------------------------------</span></span>
<span><span class="co"># This performs 1,000 iterations of auto_rate on a "default"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">default500</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">500</span>, type <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This performs 100 iterations of auto_rate on a "corrupted"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">corrupted500</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">500</span>, type <span class="op">=</span> <span class="st">"corrupted"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This performs 100 iterations of auto_rate on a "segmented"-type data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">segmented500</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, len <span class="op">=</span> <span class="fl">500</span>, type <span class="op">=</span> <span class="st">"segmented"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-do-i-know-if-the-tests-are-actually-running-and-detecting-segments">How do I know if the tests are actually running and detecting
segments?<a class="anchor" aria-label="anchor" href="#how-do-i-know-if-the-tests-are-actually-running-and-detecting-segments"></a>
</h2>
<p><code><a href="../../reference/test_lin.html">test_lin()</a></code> can perform tests in a very cool and visual
way – at the cost of speed. The argument <code>plot</code>, when set to
TRUE, can show us exactly the detected segments at every iteration. Try
it!</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Try this code below. WARNING: Will run and plot visuals 20 times.</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/test_lin.html">test_lin</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">20</span>, len <span class="op">=</span> <span class="fl">500</span>, type <span class="op">=</span> <span class="st">"segmented"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="default-data-1">“Default” data<a class="anchor" aria-label="anchor" href="#default-data-1"></a>
</h3>
<p>Results were very encouraging; when run on data with 100 samples,
<strong>(A)</strong> <code>auto_rate</code> correctly detected a large
proportion of the true segment in general, and <strong>(B)</strong>
incorrectly sampled only a small amount of other data.
<strong>(C)</strong> Comparison of <span class="math inline">\(\beta_{detected}\)</span> against <span class="math inline">\(\beta_{true}\)</span> showed very stable detection
across all slopes, even when slope values approached zero. This was
evident in <strong>(D)</strong> where roughly, the maximum <span class="math inline">\(\beta_{detected}\)</span> values had <span class="math inline">\(\pm 0.004\)</span> deviation from the <span class="math inline">\(\beta_{detected}\)</span> values across all values
of <span class="math inline">\(\pm 0.06\)</span>, even for values close
to zero:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_lin_data</span><span class="op">$</span><span class="va">default100</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_perf/arperf04.png" width="288" style="display: block; margin: auto;"></p>
<p>Tests on larger sample data sizes of 200 and 500 revealed that
<code>auto_rate</code> performed better when provided with bigger data.
When used on data with 500 samples, <code>auto_rate</code> generally
<strong>(A)</strong> detected a larger proportion of the true data and
<strong>(B)</strong> was less prone to sampling incorrect portions of
the data. <strong>(C)</strong> Linear regression had a <span class="math inline">\(R^2\)</span> of 0.999, and <strong>(D)</strong>
deviation was 10<span class="math inline">\(\times\)</span> smaller than
when sample size was at 100:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_lin_data</span><span class="op">$</span><span class="va">default500</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_perf/arperf05.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="corrupted-data-1">“Corrupted” data<a class="anchor" aria-label="anchor" href="#corrupted-data-1"></a>
</h3>
<p>In this challenging data scenario <code>auto_rate</code> had a
tendency to under-sample the linear segment. As this particular type of
data consisted of two linear segments separated by a “dip”, the function
also sometimes <strong>(A)</strong> detected the shorter segment as the
top-ranked result, resulting in the correct estimate of <span class="math inline">\(\beta_{true}\)</span>, but the wrong linear
segment detected. Thus, the function may incorrectly sample none of the
linear segment <strong>(B)</strong>, but only rarely; in most cases, it
still identified the right segment, and incorrectly sampled only a small
amount of data. <strong>(C)</strong> Comparison of <span class="math inline">\(\beta_{detected}\)</span> against <span class="math inline">\(\beta_{true}\)</span> showed stable, but
relatively noisy detection of the true rate across all slopes when
compared to its performance with “default”-type data.
<strong>(D)</strong> The deviation plot showed that performance was
genrally poorer at values close to zero.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_lin_data</span><span class="op">$</span><span class="va">corrupted100</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_perf/arperf06.png" width="288" style="display: block; margin: auto;"></p>
<p>Again, <code>auto_rate</code> performed better when provided with
bigger data. At 500 samples the same issue where the shorter linear
segment was incorrectly selected still persisted <strong>(A)</strong>,
but <strong>(B)</strong> the function sampled incorrect segments less
often, <strong>(C)</strong> linear regression of <span class="math inline">\(\beta_{detected}\)</span> against <span class="math inline">\(\beta_{true}\)</span> had a better goodness of fit
and <strong>(D)</strong> deviation values from <span class="math inline">\(\beta_{true}\)</span> were substantially smaller
with seemingly fewer poor estimates when slope values approach zero.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_lin_data</span><span class="op">$</span><span class="va">corrupted500</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_perf/arperf07.png" width="288" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="segmented-data-1">“Segmented” data<a class="anchor" aria-label="anchor" href="#segmented-data-1"></a>
</h3>
<p>This type of data is the most difficult to handle as
<code>auto_rate</code> needed to disregard the curved, but
increasingly-linear top portion of the data, and also discard the slight
degree of change in slope towards the end of the data. Thus,
<code>auto_rate</code> performed well in many cases, but poorly in
others. In the majority of cases, <strong>(A)</strong> when it managed
to sample the linear segment, it did so for a very large fraction of the
data. <strong>(B)</strong> It performed less well at avoiding incorrect
sampling, since it sometimes selected the other linear segment. However,
<strong>(C)</strong> the plot of <span class="math inline">\(\beta_{detected}\)</span> against <span class="math inline">\(\beta_{true}\)</span> showed that it still
performed surprisingly well most of the time, despite the errors, and
<strong>(D)</strong> the deviance from the true rate appeared to be
poorer when slope values are closer to zero.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_lin_data</span><span class="op">$</span><span class="va">segmented100</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_perf/arperf08.png" width="288" style="display: block; margin: auto;"></p>
<p>Again, with a larger dataset, <code>auto_rate</code>’s performance
was substantially better. With a 500-sample dataset, many of the issues
that occured in the previous test were better resolved. The function
<strong>(A)</strong> correctly sampled the right segment most of the
time, and rarely sampled other data or the other linear segment
<strong>(B)</strong>. <strong>(C)</strong> Linear regression of <span class="math inline">\(\beta_{detected}\)</span> against <span class="math inline">\(\beta_{true}\)</span> had a <span class="math inline">\(R^2\)</span> of 0.999, and <strong>(D)</strong>
deviations from <span class="math inline">\(\beta_{true}\)</span> were
much smaller in magnitude.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_lin_data</span><span class="op">$</span><span class="va">segmented500</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_perf/arperf09.png" width="288" style="display: block; margin: auto;"></p>
<p>We did not report any of the results for 200-sample size datasets,
but users are free to call the data object <code>test_lin_data</code>
and plot the results, or run their own analyses using the functions we
provide.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In this limited testing on relatively small datasets, we have shown
that on datasets of around 100 records in length <code>auto_rate</code>
performs quite well, although with some occurrences of data
mis-characterisation. However, when datasets are around 500 in length
its performance is radically improved. This pattern holds across our
three test data types characteristic of respirometry data:
<code>"default"</code> (non-linear to linear data segments),
<code>"corrupted"</code> (data with an obvious erroneous drop-out), and
<code>"segmented"</code> (non-linear to multiple linear segments). The
use of <code>auto_rate</code> on datasets larger than this is likely to
be even more accurate in identifying valid linear regions of data.</p>
<p>Despite the overall good performance, this does serve to illustrate
that users should always inspect and explore their data, and the results
of analyses for obvious errors and that the results are characteristic
and valid answers to the question they are asking of the data. We have
this made this as straightforward as possible in <code>respR</code>
through always outputting by default plots with results highlighted in
the context of the entire datasets, and useful summary output in the
console. There is also extensive support for exploring data and results
via the base R <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> and
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> functions.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Olito, C., White, C. R., Marshall, D. J., &amp; Barneche, D. R.
(2017). Estimating monotonic rates from biological data using local
linear regression. The Journal of Experimental Biology,
jeb.148775-jeb.148775. <a href="http://doi.org/10.1242/jeb.148775" class="external-link uri">http://doi.org/10.1242/jeb.148775</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
