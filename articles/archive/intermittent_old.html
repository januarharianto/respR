<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intermittent-flow respirometry: Alternative approaches • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../../favicon.ico">
<link rel="manifest" href="../../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Intermittent-flow respirometry: Alternative approaches">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Intermittent-flow respirometry: Alternative
approaches</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/archive/intermittent_old.Rmd" class="external-link"><code>vignettes/archive/intermittent_old.Rmd</code></a></small>
      <div class="hidden name"><code>intermittent_old.Rmd</code></div>

    </div>

    
    
<p>The following are alternative methods of extracting rates from
multiple replicates in intermittent-flow respirometry using
<code>calc_rate</code> or <code>auto_rate</code>. They have been mostly
superseded by <code>calc_rate.int</code> and <code>auto_rate.int</code>.
See <code><a href="../../articles/intermittent_long.html">vignette("intermittent_long")</a></code>.</p>
<p>However we have left the details here in case they are of use in
other cases. The main advantage to these are that they allow rates to be
extracted from different data regions within each replicate or allow
different methods to be used.</p>
<div class="section level2">
<h2 id="calc_rate">
<code>calc_rate</code><a class="anchor" aria-label="anchor" href="#calc_rate"></a>
</h2>
<p><code>calc_rate.int</code> allows consistent region selection
criteria to be applied to each replicate, and is usually the best way of
extracting rates from intermittent-flow data. <code>calc_rate</code>
however also allows you to extract multiple rates from a dataset in a
single command, and this can allow for rates from different regions in
each replicate. Obviously, this requires you to know the row locations
or timings of replicates.</p>
<p><code>calc_rate</code> allows data regions to be chosen by
<code>oxygen</code>, <code>time</code>, or <code>row</code> ranges. In
the case of <code>row</code> or <code>time</code>, multiple subset
regions can be specified, with the <code>from</code> and <code>to</code>
inputs acting as vectors of paired values. Using this we can extract a
rate from each replicate with one command.</p>
<div class="section level3">
<h3 id="rate-from-multiple-row-regions">Rate from multiple row regions<a class="anchor" aria-label="anchor" href="#rate-from-multiple-row-regions"></a>
</h3>
<p>We can use the same replicate start and end locations as in the
example <a href="https://januarharianto.github.io/respR/articles/intermittent_short.html">here</a>
to extract a rate from each complete replicate.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># inspect data</span></span>
<span><span class="va">urchin_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">intermittent.rd</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'time = 1'</span></span>
<span><span class="co">#&gt; inspect: Applying column default of 'oxygen = 2'</span></span>
<span><span class="co">#&gt; inspect: No issues detected while inspecting data frame.</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># calc rates</span></span>
<span><span class="va">urchin_int_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin_int</span>, </span>
<span>                              from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span>,</span>
<span>                              to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1900</span>, <span class="fl">3550</span>, <span class="fl">4831</span><span class="op">)</span>,</span>
<span>                              by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-2-2.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">urchin_int_rates</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq  row endrow time endtime  oxy endoxy   rate.2pt       rate</span></span>
<span><span class="co">#&gt; 1:  NA    1        7.135 -0.0005777 0.995    1   1900    0    1899 7.17   6.07 -0.0005793 -0.0005777</span></span>
<span><span class="co">#&gt; 2:  NA    2        8.473 -0.0005893 0.994 2101   3550 2100    3549 7.22   6.38 -0.0005797 -0.0005893</span></span>
<span><span class="co">#&gt; 3:  NA    3        9.621 -0.0006280 0.989 3901   4831 3900    4830 7.16   6.59 -0.0006129 -0.0006280</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>We can see this produces exactly the same result as in the example <a href="https://januarharianto.github.io/respR/articles/intermittent_short.html">here</a>.
Note, because <code>calc_rate.int</code> has not been used there are no
values in the <code>$rep</code> column. <code>calc_rate</code> does not
consider multiple rates as coming from separate replicates. Instead it
ranks them in order of inputs, as indicated by the <code>$rank</code>
column.</p>
</div>
<div class="section level3">
<h3 id="rate-from-multiple-time-regions">Rate from multiple time regions<a class="anchor" aria-label="anchor" href="#rate-from-multiple-time-regions"></a>
</h3>
<p>We can also extract by time values, and here we will also apply a
different time window within each replicate.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urchin_int_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin_int</span>, </span>
<span>                              from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">2300</span>, <span class="fl">4100</span><span class="op">)</span>, </span>
<span>                              to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1800</span>, <span class="fl">3000</span>, <span class="fl">4400</span><span class="op">)</span>, </span>
<span>                              by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
<p>By default, the first is shown in <code>print</code> and
<code>plot</code>, but the <code>pos</code> input can be used to view
others.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">urchin_int_rates</span>, pos <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Calling <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> will show the coefficients, locations
and values of all rates:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">urchin_int_rates</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq  row endrow time endtime  oxy endoxy   rate.2pt       rate</span></span>
<span><span class="co">#&gt; 1:  NA    1        7.127 -0.0005734 0.995  201   1801  200    1800 7.05   6.11 -0.0005875 -0.0005734</span></span>
<span><span class="co">#&gt; 2:  NA    2        8.529 -0.0006100 0.985 2301   3001 2300    3000 7.12   6.68 -0.0006286 -0.0006100</span></span>
<span><span class="co">#&gt; 3:  NA    3        9.825 -0.0006760 0.915 4101   4401 4100    4400 7.08   6.85 -0.0007667 -0.0006760</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>Using <code>calc_rate</code> like this allows you to extract rates
from <em>different</em> regions within each replicate, or even multiple
rates from each.</p>
</div>
</div>
<div class="section level2">
<h2 id="subset">
<code>subset_data</code><a class="anchor" aria-label="anchor" href="#subset"></a>
</h2>
<p>Another option for extracting replicates from a larger dataset is the
<code>subset_data</code> function. This allows you to easily subset both
data frames and <code>inspect</code> objects by time, row, or oxygen
ranges. You can then pipe (<code>|&gt;</code> or <code>%&gt;%</code>)
the subset directly to other functions such as <code>calc_rate</code> or
<code>auto_rate</code>, or alternatively save replicates as separate
objects for further analysis.</p>
<div class="section level3">
<h3 id="separate-replicates">Separate replicates<a class="anchor" aria-label="anchor" href="#separate-replicates"></a>
</h3>
<p>Here, we use the <code>inspect</code> object we saved earlier
containing the whole dataset, to create new <code>inspect</code> objects
for each replicate. These can be treated like any other
<code>inspect</code> object, including being passed to
<code>print</code> and <code>plot</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create separate replicate data frames</span></span>
<span><span class="va">u_rep1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">urchin_int</span>, from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">1900</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="va">u_rep2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">urchin_int</span>, from <span class="op">=</span> <span class="fl">2100</span>, to <span class="op">=</span> <span class="fl">3500</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span><span class="va">u_rep3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">urchin_int</span>, from <span class="op">=</span> <span class="fl">3700</span>, to <span class="op">=</span> <span class="fl">4831</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can calculate a rate from each, showing the results from the
third one here. Unlike <code>calc_rate.int</code>, using this method you
are not restricted to extracting the rate from the exact same region
within each replicate. In addition, this approach allows you to use the
<code>by = "oxygen"</code> method.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u_rate1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">u_rep1</span>, from <span class="op">=</span> <span class="fl">7.1</span>, to <span class="op">=</span> <span class="fl">6.7</span>, by <span class="op">=</span> <span class="st">"oxygen"</span><span class="op">)</span></span>
<span><span class="va">u_rate2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">u_rep2</span>, from <span class="op">=</span> <span class="fl">7.1</span>, to <span class="op">=</span> <span class="fl">6.8</span>, by <span class="op">=</span> <span class="st">"oxygen"</span><span class="op">)</span></span>
<span><span class="va">u_rate3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">u_rep3</span>, from <span class="op">=</span> <span class="fl">7.0</span>, to <span class="op">=</span> <span class="fl">6.8</span>, by <span class="op">=</span> <span class="st">"oxygen"</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="piping">Piping<a class="anchor" aria-label="anchor" href="#piping"></a>
</h3>
<p>Alternatively, pipe the result, which has the advantage of not
filling your local environment with redundant objects and overall makes
for a tidier workflow.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u_rate3</span> <span class="op">&lt;-</span> <span class="va">urchin_int</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">3700</span>, to <span class="op">=</span> <span class="fl">4831</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">7.0</span>, to <span class="op">=</span> <span class="fl">6.8</span>, by <span class="op">=</span> <span class="st">"oxygen"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">u_rate3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0   slope_b1   rsq row endrow time endtime  oxy endoxy   rate.2pt       rate</span></span>
<span><span class="co">#&gt; 1:  NA    1        9.579 -0.0006187 0.941 433    825 4132    4524 6.99    6.8 -0.0004847 -0.0006187</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="iterating-using-loops">Iterating using loops<a class="anchor" aria-label="anchor" href="#iterating-using-loops"></a>
</h2>
<p>A number of approaches could be used to iterate <code>respR</code>
functions to analyse these types of experiment; this is merely an
example to illustrate how <code>respR</code> can be easily iterated over
multiple replicates. For most purposes <code>calc_rate.int</code> or
<code>auto_rate.int</code> are better options.</p>
<p>Here we will show a simple <code>for</code> loop to subset each
replicate from the <code>zeb_intermittent.rd</code> data and run
<code>auto_rate(method = "linear")</code> on it. We use a ‘wait’ period
of 2 minutes (120s), and a ‘measure’ period of 7 minutes (420s), leaving
2 minutes of flushing excluded.</p>
<p>For actual analyses it is highly recommended you examine the plot of
each replicate, or at very least those used in determining a final rate.
Here in the interests of speed we suppress it with
<code>plot = FALSE</code>. Note also this code will create a
<code>list</code> object containing an <code>auto_rate</code> object for
every replicate, which will be quite large (several MB).</p>
<div class="section level3">
<h3 id="inspect-data">Inspect data<a class="anchor" aria-label="anchor" href="#inspect-data"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="analysis-loop">Analysis loop<a class="anchor" aria-label="anchor" href="#analysis-loop"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define wait and measure periods</span></span>
<span><span class="va">wait</span> <span class="op">&lt;-</span> <span class="fl">120</span>   <span class="co"># 2 mins wait</span></span>
<span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="fl">420</span>  <span class="co"># 7 mins measure</span></span>
<span></span>
<span><span class="co">## start rows for each rep using sequence function (from, to, by)</span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5840</span>, <span class="fl">74480</span>, <span class="fl">660</span><span class="op">)</span></span>
<span><span class="co">## data starts - apply wait</span></span>
<span><span class="va">starts</span> <span class="op">&lt;-</span> <span class="va">reps</span> <span class="op">+</span> <span class="va">wait</span></span>
<span><span class="co">## data ends - apply wait and measure period</span></span>
<span><span class="va">ends</span> <span class="op">&lt;-</span> <span class="va">reps</span> <span class="op">+</span> <span class="va">wait</span> <span class="op">+</span> <span class="va">measure</span></span>
<span></span>
<span><span class="co">## Empty list for saving results</span></span>
<span><span class="va">zeb_rmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## loop</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">105</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">st</span> <span class="op">&lt;-</span> <span class="va">starts</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="co"># start time</span></span>
<span>  <span class="va">et</span> <span class="op">&lt;-</span> <span class="va">ends</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="co"># end time</span></span>
<span></span>
<span>  <span class="co">## subset replicate and pipe the result into auto_rate</span></span>
<span>  <span class="va">zeb_rmr</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb</span>, from <span class="op">=</span> <span class="va">st</span>, to <span class="op">=</span> <span class="va">et</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"linear"</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="view-results">View results<a class="anchor" aria-label="anchor" href="#view-results"></a>
</h3>
<p>We can extract and view the top-ranked rate result from each
replicate using the <code>sapply</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## extract rates</span></span>
<span><span class="va">rmr_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">zeb_rmr</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="va">z</span><span class="op">$</span><span class="va">rate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rmr_rate</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">rmr_rate</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Note, we plot on a reverse axis so higher rates are higher on the
plot. We can see that rates are higher in the initial stages of the
experiment, then are quite consistent after they stabilise.</p>
</div>
<div class="section level3">
<h3 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h3>
<p>This saves pre- and post-experiment background rates for use in the
next step.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bg_pre</span> <span class="op">&lt;-</span> <span class="va">zeb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">4999</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bg_post</span> <span class="op">&lt;-</span> <span class="va">zeb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">75140</span>, to <span class="op">=</span> <span class="fl">79251</span>, by <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adjust-rmr">Adjust RMR<a class="anchor" aria-label="anchor" href="#adjust-rmr"></a>
</h3>
<p>Here we use <code>lapply</code> to apply the adjustment to each
element of the RMR results list of <code>auto_rate</code> objects and
return a new list of <code>adjust_rate</code> objects.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_rmr_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">zeb_rmr</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="../../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">z</span>,</span>
<span>                                                       by <span class="op">=</span> <span class="va">bg_pre</span>,</span>
<span>                                                       by2 <span class="op">=</span> <span class="va">bg_post</span>,</span>
<span>                                                       method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="convert-rmr">Convert RMR<a class="anchor" aria-label="anchor" href="#convert-rmr"></a>
</h4>
<p>Once again we will use <code>lapply</code> to loop through the SMR
list of <code>adjust_rate</code> objects and convert the rates for each
replicate.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_rmr_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">zeb_rmr_adj</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="../../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">z</span>,</span>
<span>                                                             oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,</span>
<span>                                                             time.unit <span class="op">=</span> <span class="st">"secs"</span>,</span>
<span>                                                             output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,</span>
<span>                                                             volume <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span>                                                             mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We’ll look at two examples. This is the top-ranked result from these
two replicates, though the actual object will contain more.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_rmr_conv</span><span class="op">[[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span>, pos <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of converted rates from entered 'pos' rank(s):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1 rsq density row endrow  time endtime   oxy endoxy      rate  adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1        33.62 -0.002182 0.9    1543 127    259 12026   12158 7.364  7.116 -0.002182 -0.00008027     -0.002102  -0.002102     mg/L       sec   0.12 0.0009   NA NA NA NA   -0.908      -1.009          NA   mgO2/hr/g      -1.009</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_rmr_conv</span><span class="op">[[</span><span class="fl">90</span><span class="op">]</span><span class="op">]</span>, pos <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of converted rates from entered 'pos' rank(s):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0  slope_b1   rsq density row endrow  time endtime   oxy endoxy      rate adjustment rate.adjusted rate.input oxy.unit time.unit volume   mass area  S  t  P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1        140.7 -0.002059 0.965    1255 122    397 64821   65096 7.193  6.644 -0.002059 -0.0001139     -0.001945  -0.001945     mg/L       sec   0.12 0.0009   NA NA NA NA  -0.8402     -0.9336          NA   mgO2/hr/g     -0.9336</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="final-rmr">Final RMR<a class="anchor" aria-label="anchor" href="#final-rmr"></a>
</h3>
<p>This is similar to the other operations above, in that we use an
<code>apply</code> function to extract the top ranked final converted
rate from each replicate.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_rmr_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">zeb_rmr_conv</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="va">z</span><span class="op">$</span><span class="va">rate.output</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Now we can plot them. Again, we reverse the y-axis.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_rmr_all</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">zeb_rmr_all</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="intermittent_old_files/figure-html/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;"></p>
<p>It depends on the experiment how we might want to define the final
RMR. This is the routine metabolic rate, so we want a rate that
represents routine behaviour. Here, rates are very consistent after
number 20, apart from one obvious outlier in number 89.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_rmr_all</span><span class="op">[</span><span class="fl">88</span><span class="op">:</span><span class="fl">90</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] -0.9576 -1.2966 -0.9336</span></span></code></pre></div>
<p>Therefore, we will not use this one, but take the mean of all others
from 20 onwards. This is just one approach of many we could apply. See
<a href="https://januarharianto.github.io/respR/articles/intermittent_long.html">here</a>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_rmr_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">zeb_rmr_all</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">88</span>,<span class="fl">90</span><span class="op">:</span><span class="fl">105</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">zeb_rmr_final</span></span>
<span><span class="co">#&gt; [1] -0.9547</span></span></code></pre></div>
<p>This is our final RMR: -0.96 mg/h/g.</p>
</div>
<div class="section level3">
<h3 id="complete-analysis">Complete analysis<a class="anchor" aria-label="anchor" href="#complete-analysis"></a>
</h3>
<p>Thius is the same analysis as above but using exclusively the
<code>apply</code> family of functions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import and inspect raw data ---------------------------------------------</span></span>
<span><span class="co"># Importing would normally be the first step, e.g. read.csv("path/to/file")</span></span>
<span><span class="va">zeb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">zeb_intermittent.rd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Background --------------------------------------------------------------</span></span>
<span><span class="va">bg_pre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb</span>, from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">4999</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">bg_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb</span>, from <span class="op">=</span> <span class="fl">75140</span>, to <span class="op">=</span> <span class="fl">79251</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Replicate structure -----------------------------------------------------</span></span>
<span><span class="va">wait</span> <span class="op">&lt;-</span> <span class="fl">120</span>   <span class="co"># 2 mins wait</span></span>
<span><span class="va">measure</span> <span class="op">&lt;-</span> <span class="fl">420</span>  <span class="co"># 7 mins measure</span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5840</span>, <span class="fl">74480</span>, <span class="fl">660</span><span class="op">)</span> <span class="co">## start rows</span></span>
<span><span class="va">starts</span> <span class="op">&lt;-</span> <span class="va">reps</span> <span class="op">+</span> <span class="va">wait</span> <span class="co">## data starts</span></span>
<span><span class="va">ends</span> <span class="op">&lt;-</span> <span class="va">reps</span> <span class="op">+</span> <span class="va">wait</span> <span class="op">+</span> <span class="va">measure</span> <span class="co">## data ends</span></span>
<span></span>
<span><span class="co"># Subset each replicate ---------------------------------------------------</span></span>
<span><span class="va">zeb_rmr_subsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">starts</span>,<span class="va">ends</span><span class="op">)</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="../../reference/subset_data.html">subset_data</a></span><span class="op">(</span><span class="va">zeb</span>,</span>
<span>                                                                        from <span class="op">=</span> <span class="va">z</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                                                        to <span class="op">=</span> <span class="va">z</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                                                                        by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># auto_rate on each replicate ---------------------------------------------</span></span>
<span><span class="va">zeb_rmr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">zeb_rmr_subsets</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">z</span>,</span>
<span>                                                         method <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>                                                         plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adjust ------------------------------------------------------------------</span></span>
<span><span class="va">zeb_rmr_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">zeb_rmr</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="../../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">z</span>,</span>
<span>                                                       by <span class="op">=</span> <span class="va">bg_pre</span>,</span>
<span>                                                       by2 <span class="op">=</span> <span class="va">bg_post</span>,</span>
<span>                                                       method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert -----------------------------------------------------------------</span></span>
<span><span class="va">zeb_rmr_conv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">zeb_rmr_adj</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="../../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">z</span>,</span>
<span>                                                             oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,</span>
<span>                                                             time.unit <span class="op">=</span> <span class="st">"secs"</span>,</span>
<span>                                                             output.unit <span class="op">=</span> <span class="st">"mg/h/g"</span>,</span>
<span>                                                             volume <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span>                                                             mass <span class="op">=</span> <span class="fl">0.0009</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract rates -----------------------------------------------------------</span></span>
<span><span class="va">zeb_rmr_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">zeb_rmr_conv</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="va">z</span><span class="op">$</span><span class="va">rate.output</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate final rmr -----------------------------------------------------</span></span>
<span><span class="va">zeb_rmr_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">zeb_rmr_all</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">88</span>,<span class="fl">90</span><span class="op">:</span><span class="fl">105</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] -0.9547</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
