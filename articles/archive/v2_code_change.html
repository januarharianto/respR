<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>v2.0 Code changes • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="v2.0 Code changes">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../../articles/citations.html">respR in Use</a>
    </li>
    <li>
      <a href="../../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>v2.0 Code changes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/archive/v2_code_change.Rmd" class="external-link"><code>vignettes/archive/v2_code_change.Rmd</code></a></small>
      <div class="hidden name"><code>v2_code_change.Rmd</code></div>

    </div>

    
    
<p><code>respr v2.0</code> was a huge rewrite and rethinking of the
entire package. During this process it quickly became clear we could not
update the package satisfactorily without breaking some code from v1.x.
Therefore, we took the decision to implement these and a few other
improvements in the belief that it was better to do it now and have the
package work consistently and logically well into the future even if it
meant some v1.x code may break.</p>
<p>While the majority of the package workflows are in general unchanged,
and older code <em>may</em> work, there are enough changes that we
recommend old code be used very carefully with v2. <code>respR</code>
workflows are generally concise and overall work in the same way, so any
updating of code to be compatible should be relatively
straightforward.</p>
<p>This is an incomplete summary of the major code changes in v2.0, with
some suggestions for how to update older code to allow it to work. See
<a href="https://januarharianto.github.io/respR/articles/release_notes.html"><strong>here</strong></a>
for full release notes for this version.</p>
<p>If you have completed or are in the process of submitting a
publication and <code>respR v1.x</code> code as supplementary
information, see <code><a href="../../articles/archive/v1_code.html">vignette("v1_code")</a></code> for information about
how to include a link to <code>respR v1.1</code> so that your code will
remain reproducible in the future.</p>
<p>If you come across any changes that are not documented here, and you
think should be, <a href="https://januarharianto.github.io/respR/articles/contact.html"><strong>let
us know</strong></a> and we will add it to the list.</p>
<div class="section level3">
<h3 id="deprecated-functions">Deprecated functions<a class="anchor" aria-label="anchor" href="#deprecated-functions"></a>
</h3>
<p><code>inspect_data</code> and <code>pcrit</code> were officially
deprecated some time ago, and have been completely removed in this
version. Update code to use <code><a href="../../reference/inspect.html">inspect()</a></code> and
<code><a href="../../reference/oxy_crit.html">oxy_crit()</a></code> instead.</p>
</div>
<div class="section level3">
<h3 id="pcrit-analyses">Pcrit analyses<a class="anchor" aria-label="anchor" href="#pcrit-analyses"></a>
</h3>
<p>As well as <code>pcrit</code> being removed, <code>calc_pcrit</code>
has been renamed <code><a href="../../reference/oxy_crit.html">oxy_crit()</a></code> to avoid conflicts with another
package. Any code using <code>calc_pcrit</code> can be replaced with
<code>oxy_crit</code>, and <em>may</em> work, since the defaults have
remained largely the same. Note however the new <code>method</code>
input. Previously both currently supported methods were performed, but
now only one is, selected using <code>method</code> with Broken-Stick
regression the default. Therefore, outputs may not be the same. Output
objects have been completely restructured and elements renamed, so any
code extracting results from these will not work.</p>
</div>
<div class="section level3">
<h3 id="flowthrough-respirometry-analyses">Flowthrough respirometry analyses<a class="anchor" aria-label="anchor" href="#flowthrough-respirometry-analyses"></a>
</h3>
<p>The entire workflow for analysing flowthrough respirometry data has
changed. Any previous code for analysing these types of data will likely
not work, and should be rewritten using the four new specialised
functions. See <code><a href="../../articles/flowthrough.html">vignette("flowthrough")</a></code> for more
details.</p>
</div>
<div class="section level3">
<h3 id="input-changes">Input changes<a class="anchor" aria-label="anchor" href="#input-changes"></a>
</h3>
<p>Several function inputs have been renamed to make them more
consistent.</p>
<ul>
<li><p>All primary inputs are now <code>x</code> (was previously
<code>df</code> in <code>auto_rate</code>, <code>inspect</code>, and
<code>subsample</code> among others). Any code specifically using
<code>df =</code> can be replaced with <code>x =</code>, otherwise it
will not be affected.</p></li>
<li><p>Some functions have had inputs reordered
(e.g. <code>auto_rate</code> now has <code>method</code> as second
input). Therefore, code where inputs were not explicitly named may not
work as it did previously.</p></li>
<li><p>Some input defaults have been changed. E.g. in
<code>convert_rate</code>, <code>oxy.unit = NULL</code> and
<code>time.unit = NULL</code> now stop the function instead of applying
a default unit.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="output-structural-changes">Output structural changes<a class="anchor" aria-label="anchor" href="#output-structural-changes"></a>
</h3>
<p>The majority of function outputs have been restructured and many
elements renamed. Any code that directly extracted results or parameters
from these may not now work. Updating code should be relatively
straightforward as error messages will state an element is missing or
not found, or a <code>NULL</code>will be returned. Normal
object-oriented workflows should not be affected as functions have been
updated to recognise new element names.</p>
<p>The general changes include the following:</p>
<ul>
<li><p>Data element renamed <code>$dataframe</code> instead of
<code>$df</code>, <code>$data</code>, etc.</p></li>
<li>
<p>Output rate elements have consistent naming structure starting
with <code>rate</code>, with a suffix where relevant:</p>
<ul>
<li>
<code>convert_rate</code> : <code>$output</code> changed to
<code>$rate.output</code>, <code>$absolute</code> to
<code>$rate.absolute</code>
</li>
<li>
<code>calc_rate.bg</code> : <code>$bgrate</code> changed to
<code>$rate.bg</code>, <code>$mean</code> to
<code>$rate.bg.mean</code>
</li>
<li>
<code>adjust_rate</code>  : <code>$corrected</code> changed to
<code>$rate.adjusted</code>, <code>$input.rate</code> to
<code>$rate.input</code>
</li>
</ul>
</li>
<li><p>Outputs have also been rearranged, so any referencing not using
element names may not work the same
(e.g. <code>output[[2]]</code>).</p></li>
<li><p>Summary tables (<code>$summary</code>) now have a
<code>rank</code> column in position 1, and have also in general been
rearranged, new columns added, and some columns renamed. Therefore if
column numbers or names have been used to extract results these may now
be incorrect.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="function-specific-changes">Function specific changes<a class="anchor" aria-label="anchor" href="#function-specific-changes"></a>
</h2>
<div class="section level3">
<h3 id="import_file">
<code>import_file()</code><a class="anchor" aria-label="anchor" href="#import_file"></a>
</h3>
<p>This function has been rewritten to be less aggressive about removing
empty or non-numeric columns, or those containing data which wasn’t time
or oxygen, such as temperature. Now, all columns are retained, where
possible. Column renaming has been updated to be much more robust,
ensuring unique column names, and removing problematic characters. The
result is any previous datasets imported using this function will likely
have different column structures and naming. Best option is to reimport
the data, check the structure, and edit any column references in
subsequent code.</p>
</div>
<div class="section level3">
<h3 id="format_time">
<code>format_time()</code><a class="anchor" aria-label="anchor" href="#format_time"></a>
</h3>
<p>If saving output as a data frame, the added numeric time column is
now titled <code>time.num</code> rather than <code>elapsed</code>. If
the reference <code>$elapsed</code> is used in code for some reason,
find and replace <code>$elapsed</code> with <code>$time.num</code>.</p>
</div>
<div class="section level3">
<h3 id="auto_rate">
<code>auto_rate()</code><a class="anchor" aria-label="anchor" href="#auto_rate"></a>
</h3>
<p>Primary input <code>df</code> now renamed to <code>x</code>. Any code
using <code>df =</code> can be replaced with <code>x =</code>.</p>
<p>Inputs have been reordered with <code>method</code> as second input.
Code where inputs were not explicitly named may not work as it did
previously.</p>
<p>The <code>"max"</code> and <code>"min"</code> methods have been
deprecated. These still work as before for now, so older code using
these will still work, but they will be removed in a future version.
Most users should use <code>"highest"</code> and <code>"lowest"</code>
instead. Note the new <code>"maximum"</code> and <code>"minimum"</code>
methods <strong>do not</strong> work the same as
<code>"max"/"min"</code>, as they order strictly numerically. See
<code><a href="../../reference/auto_rate.html">help(auto_rate)</a></code>.</p>
<p>The <code>width</code> input behaviour has changed slightly.
Previously if it was a value between 0 and 1 it represented a
proportional width of the whole dataset regardless of the
<code>by</code> input. This now applies only to <code>by = "row"</code>.
If <code>by = "time"</code> any value between 0 and 1 now represents (as
with values above 1) a time window in the units of the time data. Any
code with <code>by = "time"</code> and <code>width</code> between 0 and
1 will now produce different outputs. Replace <code>by = "time"</code>
with <code>by = "row"</code> and the results should match the previous
version.</p>
</div>
<div class="section level3">
<h3 id="convert_do">
<code>convert_DO()</code><a class="anchor" aria-label="anchor" href="#convert_do"></a>
</h3>
<p>By default, the function now outputs a vector of converted numeric
values as opposed to the previous output which was a <code>list</code>
object of class <code>convert_DO</code>. A new <code>simplify</code>
logical input controls this, with the default being <code>TRUE</code>.
Previous code which saved this output for later use can restore this
behaviour by adding <code>simplify = FALSE</code> to the call. Code
which used or extracted converted values by calling the
<code>$output</code> element can be used by doing a search for this and
replacing it with nothing, or deleting it.</p>
<p>The <code>"%"</code> oxygen unit has been deprecated and replaced
with <code>"%Air"</code>. In older code replace <code>"%"</code> (and
other variations such as <code>"percent"</code>) with
<code>"%Air"</code>. See <code><a href="../../reference/convert_DO.html">help("convert_DO")</a></code>. Note, the
additional unit of <code>"%Oxy"</code> has been added. These are not the
same.</p>
</div>
<div class="section level3">
<h3 id="adjust_rate">
<code>adjust_rate()</code><a class="anchor" aria-label="anchor" href="#adjust_rate"></a>
</h3>
<p>This function has been completely rewritten to incorporate several
new adjustment methods. The original inputs (<code>x</code> and
<code>by</code>) have been retained as the first two inputs, and the
default behaviour of applying the mean of all background rates in
<code>by</code> as the adjustment value is also retained. Therefore,
older code <em>should</em> work as before, but care should be taken that
the desired adjustments are applied as expected.</p>
</div>
<div class="section level3">
<h3 id="calc_rate">
<code>calc_rate()</code><a class="anchor" aria-label="anchor" href="#calc_rate"></a>
</h3>
<ul>
<li>
<code>$rate_2pt</code> element renamed to
<code>$rate.2pt</code>
</li>
<li>
<code>$summary</code> columns renamed and reordered</li>
</ul>
</div>
<div class="section level3">
<h3 id="calc_rate-and-subset_data">
<code>calc_rate()</code> and <code>subset_data()</code><a class="anchor" aria-label="anchor" href="#calc_rate-and-subset_data"></a>
</h3>
<p>A change to the code for determining <code>by = "oxygen"</code>
ranges to ensure it works with both oxygen production data as well as
oxygen uptake data, means that output results may differ from those in
v1.1. The previous behaviour was the function found the first occurrence
of the <code>from</code> value, then the first occurrence of
<code>to</code>, with rates determined between these bounds. Now, it
finds the first occurrence of <code>from</code>, then the <em>last</em>
occurrence of <code>to</code>. With most data any difference in rates as
a result of this change should be minor. Also as a result, data subsets
in <code><a href="../../reference/subset_data.html">subset_data()</a></code> using this method now tend to be
longer.</p>
</div>
<div class="section level3">
<h3 id="inspect">
<code>inspect()</code><a class="anchor" aria-label="anchor" href="#inspect"></a>
</h3>
<p>The output <code>$list</code> and <code>$list_raw</code> elements
renamed <code>$locs</code> and <code>$locs_raw</code>. Code should not
need to be updated unless these were used to extract references to fix
data issues in the relevant data frames.</p>
</div>
<div class="section level3">
<h3 id="convert_rate">
<code>convert_rate()</code><a class="anchor" aria-label="anchor" href="#convert_rate"></a>
</h3>
<p>The <code>o2.unit</code> has been renamed to <code>oxy.unit</code>.
Previous code with <code>o2.unit</code> as a named input will therefore
fail to run. To update code, simply do a ‘find-and-replace’ for the old
and new inputs.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
