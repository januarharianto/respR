<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>auto_rate: Comparisons with LoLinR • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="auto_rate: Comparisons with LoLinR">
<meta property="og:description" content="respR">
<meta property="og:image" content="https://januarharianto.github.io/respR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../../articles/citations.html">respR in Use</a>
    </li>
    <li>
      <a href="../../articles/future.html">Future Features</a>
    </li>
    <li>
      <a href="../../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>auto_rate: Comparisons with LoLinR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/archive/auto_rate_comp.Rmd" class="external-link"><code>vignettes/archive/auto_rate_comp.Rmd</code></a></small>
      <div class="hidden name"><code>auto_rate_comp.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="note">
<strong>Note</strong><a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p><em>This page has been archived and will not be updated. This is
because it was submitted as part of the <a href="https://doi.org/10.1111/2041-210X.13162" class="external-link">publication</a> of
<code>respR</code> in Methods in Ecology and Evolution, and has been
retained unchanged for reference. Any results and code outputs shown are
from <code>respR v1.1</code> code. Subsequent updates to
<code>respR</code> should produce the same or very similar results.
</em></p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>To our current knowledge, one other R package, <a href="https://colin-olito.github.io/LoLinR/vignettes/LoLinR.html" class="external-link"><code>LoLinR</code></a>
(Olito et al. 2017), performs ranking techniques on time series data.
The <code>respR</code> and <code>LoLinR</code> packages use
fundamentally different techniques to estimate linear regions of data.
We detail <code><a href="../../reference/auto_rate.html">auto_rate()</a></code>’s methods <a href="https://januarharianto.github.io/respR/articles/auto_rate.html">here</a>.
<code>LoLinR</code>’s methods can be found in their online vignette <a href="https://colin-olito.github.io/LoLinR/vignettes/LoLinR.html" class="external-link">here</a>,
and Olito et al. (JEB, 2017).</p>
<p>To summarise the main differences between the two methods:</p>
<!-- LoLinR is designed to be able to do this on any time series datasets, not just respirometry data.  -->
<!-- However, the same is true of `auto_rate()`; while `respR` has a focus as an end-to-end solution for processing and analysing respirometry experiments, `auto_rate()` can similarly be used on any data.  -->
<!-- The two methods use fundamentally different techniques to detect linear regions of data; we detail `auto_rate()` methods [here](https://januarharianto.github.io/respR/articles/auto_rate.html). `LoLinR` methods can be found in `LoLinR`'s online vignette [here](https://github.com/colin-olito/LoLinR), and Olito et al. (JEB, 2017). To summarise the main differences: -->
<ol style="list-style-type: decimal">
<li><p><code><a href="../../reference/auto_rate.html">auto_rate()</a></code> uses machine learning techniques to
detect linear segments first before running linear regressions on these
data regions. <code>LoLinR</code>, by contrast, performs all possible
linear regressions on the data first, and then implements a ranking
algorithm such that the most linear regions are top-ranked.</p></li>
<li><p><code>LoLinR</code>’s algorithms use three different metrics to
select linear data, in which at least one performs very well to detect
linear segments – even if a small amount data is provided (&lt;100
samples). In comparison, <code><a href="../../reference/auto_rate.html">auto_rate()</a></code> uses only one method
(kernel density estimation), which performs less accurately at smaller
sample sizes, but that accuracy increases greatly with more data
available.</p></li>
</ol>
<!-- 3. `auto_rate()` is several orders of magnitude faster, even as it performs hundreds to thousands of rolling regressions at a time. It is a better option for large data, while LoLinR might be the function of choice for smaller datasets since its speed decreases *exponentially* as data gets bigger.  --><ol start="3" style="list-style-type: decimal">
<li>Because <code><a href="../../reference/auto_rate.html">auto_rate()</a></code> detects linear data first before it
performs linear regressions, it is several orders of magnitude faster
than <code>LoLinR</code>. Thus <code><a href="../../reference/auto_rate.html">auto_rate()</a></code> is ideal for
large data. On the other hand, <code>LoLinR</code> is restricted to
small datasets (see below).</li>
</ol>
<p>Thus, even though both packages can perform linear metric analysis
and determine the “most linear” section of a plot, the user will observe
varying differences between the two methods used (see Comparisons
section below).</p>
</div>
<div class="section level2">
<h2 id="processing-times">Processing times<a class="anchor" aria-label="anchor" href="#processing-times"></a>
</h2>
<p>The main function in <code>LoLinR</code> is called
<code>rankLocReg()</code>. The time it takes this function to process
data follows an exponential relationship with its length, illustrated
below:</p>
<p><img src="img/auto_rate_comp/lolinr_times.png" width="700px" style="display: block; margin: auto;"></p>
<p><code>rankLocReg()</code> was run on different sized datasets (blue
dots) and the time to completion recorded. These analyses were run in
RStudio on the same dataset subset to the appropriate length, on a 2017
Macbook Pro with 3.1 GHz Intel Core i5 processor, 16GB RAM, and no other
applications running. The orange dots are estimated completion times for
larger datasets extrapolated from the results. <strong>Note the log
scale.</strong></p>
<p>As we can see, any dataset larger than around 400 to 500 in length
takes a prohibitively long time to be processed by
<code>rankLocReg()</code>. In a test under the same conditions,
<code><a href="../../reference/auto_rate.html">auto_rate()</a></code> processed a dataset of 5000 datapoints in size
in 1.25 seconds; <code>rankLocReg()</code> would take 47 days. One
dataset included in <code>respR</code> (<code>squid.rd</code>) is over
34,000 datapoints in length. <code><a href="../../reference/auto_rate.html">auto_rate()</a></code> completed analysis
of this dataset in 18.5 seconds; under the exponential relationship of
<code>rankLocReg()</code> this would take approximately <em>163
years</em> to be processed. In reality, it is likely (as we have
experienced) RAM limits will cause the <code>rankLocReg()</code> process
to crash well before these durations are reached.</p>
<!-- Therefore, it is clear `rankLocReg()` is not a practical solution for analysis of data more than a few hundred datapoints long.  -->
<p>The developers of <code>LoLinR</code> are aware of the processing
limitations of <code>rankLocReg()</code>, and in the documentaton for
the package recommend thinning (i.e. subsampling) datasets longer than
500 in length using another function that they provided,
<code>thinData()</code>.
<!-- However, thinning datasets of thousands to tens of thousands of datapoints to only a few hundred would inevitably cause loss of information and is not an acceptable solution.  -->
However, thinning datasets of thousands to tens of thousands of
datapoints to only a few hundred would inevitably cause loss of
information, which may not be desirable in certain use cases.</p>
</div>
<div class="section level2">
<h2 id="comparisons">Comparisons<a class="anchor" aria-label="anchor" href="#comparisons"></a>
</h2>
<p>We provide below comparisons of the outputs of
<code><a href="../../reference/auto_rate.html">auto_rate()</a></code> and <code>rankLocReg()</code> on simulated data
generated by the <code><a href="../../reference/sim_data.html">sim_data()</a></code> function and on real
experimental data included in both packages. Because of
<code>rankLocReg()</code>’s limitations for large data, the analysis of
all data in these comparisons is restricted to 150 data points. There
are no such restrictions in <code><a href="../../reference/auto_rate.html">auto_rate()</a></code>, so for
experimental data it was used without modifications to its length.
However for <code>rankLocReg()</code> they were, as recommended in the
<code>LoLinR</code> documentation, subsampled beforehand to 150
datapoints in length using the <code>thinData()</code> function. Because
<code>rankLocReg()</code> has three different methods (<code>z</code>,
<code>eq</code>, and <code>pc</code>) to rank the data, for the
comparisons below we selected the most accurate method that best ranked
the data in each case.</p>
<p>We show the output diagnostic plots for each function on six sample
data analyses, plus a summary of the top ranked linear section
identified showing the rate, and start and end times of the estimated
linear region.</p>
<div class="section level3">
<h3 id="simulated-data-default">Simulated data: default<a class="anchor" aria-label="anchor" href="#simulated-data-default"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">769</span><span class="op">)</span></span>
<span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sim_data.html">sim_data</a></span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_comp/arcomp01.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## respR:</span></span>
<span><span class="va">rspr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">sim1</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 7 kernel density peaks detected and ranked.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp02.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## LoLinR:</span></span>
<span><span class="va">lir1</span> <span class="op">&lt;-</span> <span class="fu">rankLocReg</span><span class="op">(</span>xall <span class="op">=</span> <span class="va">sim1</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, yall <span class="op">=</span> <span class="va">sim1</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">y</span>, <span class="fl">0.2</span>, method <span class="op">=</span> <span class="st">'pc'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lir1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; rankLocReg fitted 7260 local regressions.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp03.png" width="288" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Compare top ranked outputs</span></span></code></pre>
<pre><code><span><span class="co">#&gt; respR</span></span>
<span><span class="co">#&gt; Rate: -0.0162</span></span>
<span><span class="co">#&gt; Start Time: 35</span></span>
<span><span class="co">#&gt; End Time: 146</span></span></code></pre>
<pre><code><span><span class="co">#&gt; LoLinR</span></span>
<span><span class="co">#&gt; Rate: -0.0164</span></span>
<span><span class="co">#&gt; Start Time: 32</span></span>
<span><span class="co">#&gt; End Time: 150</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="simulated-data-corrupted">Simulated data: corrupted<a class="anchor" aria-label="anchor" href="#simulated-data-corrupted"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">112</span><span class="op">)</span></span>
<span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sim_data.html">sim_data</a></span><span class="op">(</span><span class="fl">150</span>, type <span class="op">=</span> <span class="st">"corrupted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_comp/arcomp04.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## respR:</span></span>
<span><span class="va">rspr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">sim2</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 31 kernel density peaks detected and ranked.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp05.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## LoLinR:</span></span>
<span><span class="va">lir2</span> <span class="op">&lt;-</span> <span class="fu">rankLocReg</span><span class="op">(</span>xall <span class="op">=</span> <span class="va">sim2</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, yall <span class="op">=</span> <span class="va">sim2</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">y</span>, <span class="fl">0.2</span>, <span class="st">"pc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lir2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; rankLocReg fitted 7260 local regressions.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp06.png" width="288" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Compare top ranked outputs</span></span></code></pre>
<pre><code><span><span class="co">#&gt; respR</span></span>
<span><span class="co">#&gt; Rate: -0.0227</span></span>
<span><span class="co">#&gt; Start Time: 79</span></span>
<span><span class="co">#&gt; End Time: 149</span></span></code></pre>
<pre><code><span><span class="co">#&gt; LoLinR</span></span>
<span><span class="co">#&gt; Rate: -0.0228</span></span>
<span><span class="co">#&gt; Start Time: 87</span></span>
<span><span class="co">#&gt; End Time: 130</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="simulated-data-segmented">Simulated data: segmented<a class="anchor" aria-label="anchor" href="#simulated-data-segmented"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">546</span><span class="op">)</span></span>
<span><span class="va">sim3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sim_data.html">sim_data</a></span><span class="op">(</span><span class="fl">150</span>, type <span class="op">=</span> <span class="st">"segmented"</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_comp/arcomp07.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## respR:</span></span>
<span><span class="va">rspr3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">$</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 6 kernel density peaks detected and ranked.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp08.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## LoLinR:</span></span>
<span><span class="va">lir3</span> <span class="op">&lt;-</span> <span class="fu">rankLocReg</span><span class="op">(</span>xall <span class="op">=</span> <span class="va">sim3</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, yall <span class="op">=</span> <span class="va">sim3</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">y</span>, <span class="fl">0.2</span>, <span class="st">"pc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lir3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; rankLocReg fitted 7260 local regressions.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp09.png" width="288" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Compare top ranked outputs</span></span></code></pre>
<pre><code><span><span class="co">#&gt; respR</span></span>
<span><span class="co">#&gt; Rate: -0.0402</span></span>
<span><span class="co">#&gt; Start Time: 15</span></span>
<span><span class="co">#&gt; End Time: 106</span></span></code></pre>
<pre><code><span><span class="co">#&gt; LoLinR</span></span>
<span><span class="co">#&gt; Rate: -0.0398</span></span>
<span><span class="co">#&gt; Start Time: 40</span></span>
<span><span class="co">#&gt; End Time: 118</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="experimental-data-urchindata-from-lolinr">Experimental data: UrchinData from LoLinR<a class="anchor" aria-label="anchor" href="#experimental-data-urchindata-from-lolinr"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## respR:</span></span>
<span><span class="va">Urch1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/select.html">select</a></span><span class="op">(</span><span class="va">UrchinData</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">respr_urchindata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">Urch1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 4 kernel density peaks detected and ranked.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp10.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## LoLinR:</span></span>
<span><span class="va">lolinr_urchindata</span>  <span class="op">&lt;-</span>  <span class="fu">rankLocReg</span><span class="op">(</span>xall<span class="op">=</span><span class="va">UrchinData</span><span class="op">$</span><span class="va">time</span>, yall<span class="op">=</span><span class="va">UrchinData</span><span class="op">$</span><span class="va">C</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, method<span class="op">=</span><span class="st">"z"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lolinr_urchindata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; rankLocReg fitted 8911 local regressions.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp11.png" width="288" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Compare top ranked outputs</span></span></code></pre>
<pre><code><span><span class="co">#&gt; respR</span></span>
<span><span class="co">#&gt; Rate: -0.1363</span></span>
<span><span class="co">#&gt; Start Time: 18.5</span></span>
<span><span class="co">#&gt; End Time: 69</span></span></code></pre>
<pre><code><span><span class="co">#&gt; LoLinR</span></span>
<span><span class="co">#&gt; Rate: -0.1441</span></span>
<span><span class="co">#&gt; Start Time: 47</span></span>
<span><span class="co">#&gt; End Time: 63.5</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="experimental-data-cormorantdata-from-lolinr">Experimental data: CormorantData from LoLinR<a class="anchor" aria-label="anchor" href="#experimental-data-cormorantdata-from-lolinr"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## respR:</span></span>
<span><span class="va">rcor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">CormorantData</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 43 kernel density peaks detected and ranked.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp12.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## LoLinR:</span></span>
<span><span class="va">lcor</span>  <span class="op">&lt;-</span>  <span class="fu">thinData</span><span class="op">(</span><span class="va">CormorantData</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">CormorantData</span><span class="op">)</span><span class="op">/</span><span class="fl">150</span><span class="op">)</span><span class="op">$</span><span class="va">newData1</span> <span class="co"># thin data</span></span>
<span><span class="va">lcoregs</span> <span class="op">&lt;-</span> <span class="fu">rankLocReg</span><span class="op">(</span>xall<span class="op">=</span><span class="va">lcor</span><span class="op">$</span><span class="va">Time</span>, yall<span class="op">=</span><span class="va">lcor</span><span class="op">$</span><span class="va">VO2.ml.min</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>  method<span class="op">=</span><span class="st">"eq"</span>, verbose<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">lcoregs</span>  <span class="op">&lt;-</span>  <span class="fu">reRank</span><span class="op">(</span><span class="va">lcoregs</span>, newMethod<span class="op">=</span><span class="st">'pc'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lcoregs</span><span class="op">)</span></span></code></pre></div>
<p><img src="img/auto_rate_comp/arcomp13.png" width="288" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Compare top ranked outputs</span></span></code></pre>
<pre><code><span><span class="co">#&gt; respR</span></span>
<span><span class="co">#&gt; Rate: 1.16313</span></span>
<span><span class="co">#&gt; Start Time: 2.83</span></span>
<span><span class="co">#&gt; End Time: 5.41</span></span></code></pre>
<pre><code><span><span class="co">#&gt; LoLinR</span></span>
<span><span class="co">#&gt; Rate: 0.47775</span></span>
<span><span class="co">#&gt; Start Time: 2.44</span></span>
<span><span class="co">#&gt; End Time: 4.97</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="experimental-data-squid-rd-from-respr">Experimental data: squid.rd from respR<a class="anchor" aria-label="anchor" href="#experimental-data-squid-rd-from-respr"></a>
</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## respR:</span></span>
<span><span class="va">rsquid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/auto_rate.html">auto_rate</a></span><span class="op">(</span><span class="va">squid.rd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 32 kernel density peaks detected and ranked.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp14.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## LoLinR:</span></span>
<span><span class="va">lsquid</span> <span class="op">&lt;-</span> <span class="fu">thinData</span><span class="op">(</span><span class="va">squid.rd</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">squid.rd</span><span class="op">)</span><span class="op">/</span><span class="fl">150</span><span class="op">)</span><span class="op">$</span><span class="va">newData1</span></span>
<span><span class="va">lsquidregs</span> <span class="op">&lt;-</span> <span class="fu">rankLocReg</span><span class="op">(</span>xall<span class="op">=</span><span class="va">lsquid</span><span class="op">$</span><span class="va">Time</span>, yall<span class="op">=</span><span class="va">lsquid</span><span class="op">$</span><span class="va">o2</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>  method<span class="op">=</span><span class="st">"eq"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lsquidregs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; rankLocReg fitted 7260 local regressions.</span></span></code></pre>
<p><img src="img/auto_rate_comp/arcomp15.png" width="288" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Compare top ranked outputs</span></span></code></pre>
<pre><code><span><span class="co">#&gt; respR</span></span>
<span><span class="co">#&gt; Rate: -0.00030151</span></span>
<span><span class="co">#&gt; Start Time: 3589</span></span>
<span><span class="co">#&gt; End Time: 15219</span></span></code></pre>
<pre><code><span><span class="co">#&gt; LoLinR</span></span>
<span><span class="co">#&gt; Rate: -0.00030188</span></span>
<span><span class="co">#&gt; Start Time: 4321</span></span>
<span><span class="co">#&gt; End Time: 12738</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>We can see from the above comparisons that in these examples on small
datasets, <code>auto_rate</code> and <code>rankLocReg</code> output
similar results in identifying linear regions. Rates identified are
often (within the magnitudes of the data ranges used) only marginally
different, and typically the start and end times of the linear region
identified are similar, or at least the regions widely overlap.</p>
<p>Again, we must stress that comparisons between these functions are
limited because of the need in <code>rankLocReg</code> to subsample long
data to a manageable length. It is likely that some of the minor
differences in results comes from reducing the number of datapoints
<code>rankLocReg</code> has to work with, though some is also presumably
attributable to the different analytical methodologies. These results do
suggest that this thinning does not radically alter the data, and so the
results from <code>rankLocReg</code> would be valid in these cases.
However, this is a very limited comparison: in these examples we only
had to thin two of the datasets. There may be cases where such thinning
alters the characteristics of the data such that <code>rankLocReg</code>
identifies incorrect linear segments, or identifies different linear
sections depending on the degree of thinning performed. This could
particularly be the case where the rates fluctuate rapidly, or data is
of very high resolution. The same is of course true of
<code>auto_rate</code>; the algorithms are complex but fallible, so it
may on occasion identify spurious or incorrect linear regions. So we
again remind users that they should always examine the results output by
<code>auto_rate</code> to ensure they are relevant to the question of
interest.</p>
<p>In the case of which of these methods to use with your respirometry
data, caution would suggest that all possible datapoints be used in
analyses if possible, and as we have shown here and in the <a href="https://januarharianto.github.io/respR/articles/performance.html">performance
vignette</a> <code>auto_rate</code> handles large data easily, while
<code>LoLinR</code> clearly does not.</p>
<p>Users are very much encouraged to explore both functions and compare
the outputs with their own data. However, given that
<code>auto_rate</code> and <code>rankLocReg</code> appear to perform
similarly in identifying linear regions of data, but in
<code>auto_rate</code> a reduction in data resolution is unnecessary, we
would advocate the use of <code>auto_rate</code> for your respirometry
data unless you have a particular reason to believe <code>LoLinR</code>
package will output more relevant results.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Olito, C., White, C. R., Marshall, D. J., &amp; Barneche, D. R.
(2017). Estimating monotonic rates from biological data using local
linear regression. The Journal of Experimental Biology,
jeb.148775-jeb.148775. <a href="doi:10.1242/jeb.148775" class="uri">doi:10.1242/jeb.148775</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
