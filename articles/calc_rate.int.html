<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>calc_rate.int: Manual extraction of rates in intermittent-flow respirometry â€¢ respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="calc_rate.int: Manual extraction of rates in intermittent-flow respirometry">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>calc_rate.int: Manual extraction of rates in
intermittent-flow respirometry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/calc_rate.int.Rmd" class="external-link"><code>vignettes/calc_rate.int.Rmd</code></a></small>
      <div class="hidden name"><code>calc_rate.int.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code><a href="../reference/calc_rate.int.html">calc_rate.int()</a></code> is a function for manually determining
rates across user-defined ranges of row or time in each replicate in
intermittent-flow respirometry data. This page contains descriptions and
simple examples of the functionality. See also the help file at
<code><a href="../reference/calc_rate.int.html">help("calc_rate.int")</a></code>, see
<code><a href="../articles/intermittent_short.html">vignette("intermittent_short")</a></code> for how it can be used to
analyse a relatively brief intermittent-flow respirometry experiment,
and <code><a href="../articles/intermittent_long.html">vignette("intermittent_long")</a></code> for an example of
analysing a longer experiment.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>How <code>calc_rate.int</code> works is fairly straightforward. The
function uses the <code>starts</code> locations to subset each replicate
from the data in <code>x</code>. It extracts a rate using the
<code>wait</code> and <code>measure</code> inputs in the <code>by</code>
metric.</p>
<p>A <code>calc_rate</code> object is saved for each replicate in the
output in <code>$results</code>, and the output <code>$summary</code>
table contains the results from all replicates in order with the
<code>$rep</code> column indicating the replicate number. This output
object can be passed to subsequent functions such as
<code><a href="../reference/adjust_rate.html">adjust_rate()</a></code> and <code><a href="../reference/convert_rate.html">convert_rate()</a></code> for further
processing.</p>
</div>
<div class="section level2">
<h2 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h2>
<p>There are two required inputs:</p>
<ul>
<li><p><code>x</code>: The time~oxygen data from a single
intermittent-flow experiment as either a <code>data.frame</code> or an
<code>inspect</code> object</p></li>
<li>
<p><code>starts</code>: The location of the start of each replicate.
This can be either:</p>
<ul>
<li>A numeric vector of row numbers or times indicating each replicate
start location.</li>
<li>A single numeric value representing a regular row or time interval
starting from the first row or time value in the data. This option
should only be used when replicates cycle at regular intervals. If the
first replicate does not start at row 1 of the data in <code>x</code> it
should be subset so that it does. See <code><a href="../reference/subset_data.html">subset_data()</a></code> and
examples below for how to do this.</li>
</ul>
</li>
</ul>
<div class="section level3">
<h3 id="other-inputs">Other inputs<a class="anchor" aria-label="anchor" href="#other-inputs"></a>
</h3>
<ul>
<li><p><code>wait</code>: Rows or time period to exclude at the start of
each replicate.</p></li>
<li><p><code>measure</code>: Rows or time period over which to calculate
rate in each replicate. Applied directly after <code>wait</code>
phase.</p></li>
<li><p><code>by</code>: Method by which <code>starts</code>,
<code>wait</code> and <code>measure</code> are applied. Either
<code>"row"</code> or <code>"time"</code>.</p></li>
<li><p><code>plot</code>: Controls if a plot is produced. See <a href="#plot">Plot</a> section.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="irregularly-spaced-replicates">Irregularly spaced replicates<a class="anchor" aria-label="anchor" href="#irregularly-spaced-replicates"></a>
</h2>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The <code>urchin</code> dataset used for examples below is the
included <code>intermittent.rd</code> example data with the time values
changed to minutes to better demonstrate time region selection.
Experimental data such as volume, weight, and row locations of
replicates, flushes etc. can be found in the data help file:
<code><a href="../reference/intermittent.rd.html">?intermittent.rd</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urchin</span> <span class="op">&lt;-</span> <span class="va">intermittent.rd</span></span>
<span><span class="va">urchin</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">urchin</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="fl">60</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># change time values to minutes and round them</span></span></code></pre></div>
<p>This is what the whole dataset look like. There are three replicates,
and note they are of different duration.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urchin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchin</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="rate-from-row-range-in-each-replicate">Rate from <code>row</code> range in each replicate<a class="anchor" aria-label="anchor" href="#rate-from-row-range-in-each-replicate"></a>
</h3>
<p>If no inputs other than <code>x</code> and <code>starts</code> (in
the default units of <code>by = "row"</code>) are entered, the default
behaviour is to calculate a rate across all the data in each
replicate.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; calc_rate.int: The `measure` input is NULL. Calculating rate to the end of the replicate.</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<p>This is obviously not going to produce an appropriate rate. To
exclude flush periods use the <code>measure</code> input. Here, using a
vector of the same length as <code>starts</code> we can specify a
different <code>measure</code> phase in each replicate. The default is
to specify this in row widths, that is <code>by = "row"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span>,</span>
<span>              measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1800</span>, <span class="fl">1200</span>, <span class="fl">800</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
<p>However, we usually want to use the same region within each replicate
to get a rate, and also exclude the first few minutes to allow a period
of settling or acclimation after the flush. We can enter the
<code>wait</code> and <code>measure</code> inputs as single values to
acheive this.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2101</span>, <span class="fl">3901</span><span class="op">)</span>,</span>
<span>              wait <span class="op">=</span> <span class="fl">180</span>,</span>
<span>              measure <span class="op">=</span> <span class="fl">600</span><span class="op">)</span> </span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="rate-from-time-range-in-each-replicate">Rate from <code>time</code> range in each replicate<a class="anchor" aria-label="anchor" href="#rate-from-time-range-in-each-replicate"></a>
</h3>
<p><code>starts</code>, <code>wait</code>, and <code>measure</code> can
also be specified in the time units of the original data by using
<code>by = "time"</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">35</span>,<span class="fl">64</span><span class="op">)</span>,</span>
<span>              wait <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              measure <span class="op">=</span> <span class="fl">10</span>,</span>
<span>              by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The function uses the closest matching values if the exact values do
not occur in the time data.</p>
</div>
</div>
<div class="section level2">
<h2 id="regularly-spaced-replicates">Regularly spaced replicates<a class="anchor" aria-label="anchor" href="#regularly-spaced-replicates"></a>
</h2>
<p>For intermittent-flow experiments where the replicates are regularly
spaced you do not have to specify the start location of every single one
in <code>starts</code>. You can instead enter a value specifying the
interval between each replicate starting at the first row of the input
data in either rows or time units, as specified via the <code>by</code>
input.</p>
<div class="section level3">
<h3 id="specify-regular-replicate-structure">Specify regular replicate structure<a class="anchor" aria-label="anchor" href="#specify-regular-replicate-structure"></a>
</h3>
<p>The <code>zeb_intermittent.rd</code> data is from an
intermittent-flow experiment on a zebrafish. It has a regular replicate
cycle of 11 minutes (660 rows) for most of its length, comprising 9
minutes of measuring and 2 minutes flush. See
<code><a href="../reference/zeb_intermittent.rd.html">help("zeb_intermittent.rd")</a></code> for exact locations, but
essentially after a background control and a single replicate of 14
minutes this cycle is maintained until the background recording at the
end.</p>
<p>Here we use <code><a href="../reference/subset_data.html">subset_data()</a></code> to extract only the regularly
spaced replicates, and pipe the result to <code>calc_rate.int</code>. We
specify the 660 row cycle using <code>starts</code>, exclude the first 2
minutes of each replicate using <code>wait</code>, and extract a rate
from the following 6 minutes using <code>measure</code>, leaving the
flush excluded.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_all</span> <span class="op">&lt;-</span> <span class="va">zeb_intermittent.rd</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># inspect the data</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># subset regular replicates from larger dataset</span></span>
<span>  <span class="fu"><a href="../reference/subset_data.html">subset_data</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">5840</span>,</span>
<span>              to <span class="op">=</span> <span class="fl">75139</span>,</span>
<span>              by <span class="op">=</span> <span class="st">"row"</span>,</span>
<span>              quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># calc rate in each one from row 120 to 480, plotting first 3 and last 3</span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span></span>
<span>    starts <span class="op">=</span> <span class="fl">660</span>,</span>
<span>    wait <span class="op">=</span> <span class="fl">120</span>,</span>
<span>    measure <span class="op">=</span> <span class="fl">360</span>, </span>
<span>    by <span class="op">=</span> <span class="st">"row"</span>,</span>
<span>    plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">103</span><span class="op">:</span><span class="fl">105</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We use the <code>pos</code> input which is passed to
<code>plot</code> to select the first and last three replicates for
plotting to check everything looks okay. In a full analysis however we
<strong>strongly</strong> recommend every replicate rate result be
examined visually. Up to 20 results at a time can be plotted using the
<code>pos</code> input. See <a href="#plot">Plot</a> section below for
further details.</p>
</div>
<div class="section level3">
<h3 id="view-summary">View summary<a class="anchor" aria-label="anchor" href="#view-summary"></a>
</h3>
<p>Each replicate result is saved in the <code>$summary</code> element
of the output, or we can use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of all replicate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      rep rank intercept_b0 slope_b1   rsq   row endrow  time endtime  oxy endoxy rate.2pt     rate</span></span>
<span><span class="co">#&gt;   1:   1    1         53.2 -0.00785 0.997   121    480  5960    6319 6.45   3.57 -0.00804 -0.00785</span></span>
<span><span class="co">#&gt;   2:   2    1         51.9 -0.00684 0.975   781   1140  6620    6979 6.82   4.41 -0.00672 -0.00684</span></span>
<span><span class="co">#&gt;   3:   3    1         53.6 -0.00641 0.994  1441   1800  7280    7639 6.99   4.64 -0.00654 -0.00641</span></span>
<span><span class="co">#&gt;   4:   4    1         42.1 -0.00442 0.989  2101   2460  7940    8299 7.16   5.45 -0.00478 -0.00442</span></span>
<span><span class="co">#&gt;   5:   5    1         40.0 -0.00382 0.989  2761   3120  8600    8959 7.31   5.88 -0.00397 -0.00382</span></span>
<span><span class="co">#&gt;  ---                                                                                              </span></span>
<span><span class="co">#&gt; 101: 101    1        169.3 -0.00225 0.982 66121  66480 71960   72319 7.81   6.94 -0.00241 -0.00225</span></span>
<span><span class="co">#&gt; 102: 102    1        178.1 -0.00235 0.984 66781  67140 72620   72979 7.77   6.88 -0.00250 -0.00235</span></span>
<span><span class="co">#&gt; 103: 103    1        173.6 -0.00226 0.982 67441  67800 73280   73639 7.76   6.94 -0.00229 -0.00226</span></span>
<span><span class="co">#&gt; 104: 104    1        183.5 -0.00238 0.984 68101  68460 73940   74299 7.75   6.93 -0.00229 -0.00238</span></span>
<span><span class="co">#&gt; 105: 105    1        175.9 -0.00225 0.980 68761  69120 74600   74959 7.76   6.96 -0.00224 -0.00225</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>The replicate number is indicated by the <code>$rep</code> column.
The <code>$rank</code> column indicates ranking or ordering of rates
<em>within</em> each individual replicate. Since
<code>calc_rate.int</code> only returns one rate per replicate it is not
relevant here, but is useful for <code><a href="../reference/auto_rate.int.html">auto_rate.int()</a></code> results
where multiple rates per replicate may be returned.</p>
</div>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>If <code>plot = TRUE</code>, a plot is produced of each replicate
rate result on a grid up to a total of 20. By default this is the first
20 (i.e.Â <code>pos = 1:20</code>). Others can be selected by modifying
the <code>pos</code> input, either in the main function call or when
calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on output objects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_all</span>, pos <span class="op">=</span> <span class="fl">50</span><span class="op">:</span><span class="fl">69</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<p>For all plots, the bottom blue time axis shows the time values of the
original larger dataset, whilst the upper red row axis shows the rows of
the replicate subset.</p>
<p>There are three ways in which these <code>calc_rate.int</code>
results can be plotted, selected using the <code>type</code> input in
either the main function call or when calling <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> on
output objects.</p>
<div class="section level3">
<h3 id="type-rep">
<code>type = "rep"</code><a class="anchor" aria-label="anchor" href="#type-rep"></a>
</h3>
<p>The default is <code>type = "rep"</code> in which each replicate is
plotted individually with the rate region highlighted.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">35</span>,<span class="fl">64</span><span class="op">)</span>,</span>
<span>              wait <span class="op">=</span> <span class="fl">5</span>,</span>
<span>              measure <span class="op">=</span> <span class="fl">15</span>,</span>
<span>              by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="type-full">
<code>type = "full"</code><a class="anchor" aria-label="anchor" href="#type-full"></a>
</h3>
<p>Entering <code>type = "full"</code> will show each replicate rate
highlighted in the context of the entire dataset.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.int.html">calc_rate.int</a></span><span class="op">(</span><span class="va">urchin</span>,</span>
<span>              starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">35</span>,<span class="fl">64</span><span class="op">)</span>,</span>
<span>              wait <span class="op">=</span> <span class="fl">5</span>,</span>
<span>              measure <span class="op">=</span> <span class="fl">15</span>,</span>
<span>              by <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>              type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Note this may be of limited use when the dataset is large.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_all</span>, type <span class="op">=</span> <span class="st">"full"</span>, pos <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="type-cr">
<code>type = "cr"</code><a class="anchor" aria-label="anchor" href="#type-cr"></a>
</h3>
<p>Lastly, the <code>calc_rate</code> result for each individual
replicate (as found in the <code>$results</code> element of the output)
can be plotted using <code>type = "cr"</code> and the <code>pos</code>
input. Note these are results from subsets of the initial data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">zeb_all</span>, type <span class="op">=</span> <span class="st">"cr"</span>, pos <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><img src="calc_rate.int_files/figure-html/unnamed-chunk-13-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The <code>pos</code> input here can also be of multiple replicates
but this will produce multiple individual plots that you will need to
scroll through.</p>
</div>
<div class="section level3">
<h3 id="additional-plotting-options">Additional plotting options<a class="anchor" aria-label="anchor" href="#additional-plotting-options"></a>
</h3>
<p><code>legend</code> can be used to show axis labels (default is
<code>FALSE</code>). <code>quiet</code> suppresses console output.
Additional plotting parameters can also be passed to adjust margins,
axis label rotation, etc. See <a href="https://januarharianto.github.io/respR/articles/inspecting.html#additional-plotting-options">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="s3-generic-methods">S3 generic methods<a class="anchor" aria-label="anchor" href="#s3-generic-methods"></a>
</h2>
<p>As well as <code>plot</code>, saved <code>calc_rate.int</code>
objects work with the generic S3 methods <code>print</code>,
<code>summary</code>, and <code>mean</code></p>
<div class="section level3">
<h3 id="print">
<code>print</code><a class="anchor" aria-label="anchor" href="#print"></a>
</h3>
<p>This simply prints a single replicate rate result to the console, by
default the first one. The <code>pos</code> input can be used to print
others.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">zeb_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.int # -----------------</span></span>
<span><span class="co">#&gt; Replicate 1 of 105 :</span></span>
<span><span class="co">#&gt; Rate: -0.00785 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see other replicate results use 'pos' input. </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">zeb_all</span>, pos <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.int # -----------------</span></span>
<span><span class="co">#&gt; Replicate 50 of 105 :</span></span>
<span><span class="co">#&gt; Rate: -0.00218 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see other replicate results use 'pos' input. </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summary">
<code>summary</code><a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>This prints the summary table to the console which contains linear
model coefficients and other metadata for each replicate rate. The
<code>pos</code> input can be used to select which replicates
(<code>$rep</code> column) to include.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of all replicate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      rep rank intercept_b0 slope_b1   rsq   row endrow  time endtime  oxy endoxy rate.2pt     rate</span></span>
<span><span class="co">#&gt;   1:   1    1         53.2 -0.00785 0.997   121    480  5960    6319 6.45   3.57 -0.00804 -0.00785</span></span>
<span><span class="co">#&gt;   2:   2    1         51.9 -0.00684 0.975   781   1140  6620    6979 6.82   4.41 -0.00672 -0.00684</span></span>
<span><span class="co">#&gt;   3:   3    1         53.6 -0.00641 0.994  1441   1800  7280    7639 6.99   4.64 -0.00654 -0.00641</span></span>
<span><span class="co">#&gt;   4:   4    1         42.1 -0.00442 0.989  2101   2460  7940    8299 7.16   5.45 -0.00478 -0.00442</span></span>
<span><span class="co">#&gt;   5:   5    1         40.0 -0.00382 0.989  2761   3120  8600    8959 7.31   5.88 -0.00397 -0.00382</span></span>
<span><span class="co">#&gt;  ---                                                                                              </span></span>
<span><span class="co">#&gt; 101: 101    1        169.3 -0.00225 0.982 66121  66480 71960   72319 7.81   6.94 -0.00241 -0.00225</span></span>
<span><span class="co">#&gt; 102: 102    1        178.1 -0.00235 0.984 66781  67140 72620   72979 7.77   6.88 -0.00250 -0.00235</span></span>
<span><span class="co">#&gt; 103: 103    1        173.6 -0.00226 0.982 67441  67800 73280   73639 7.76   6.94 -0.00229 -0.00226</span></span>
<span><span class="co">#&gt; 104: 104    1        183.5 -0.00238 0.984 68101  68460 73940   74299 7.75   6.93 -0.00229 -0.00238</span></span>
<span><span class="co">#&gt; 105: 105    1        175.9 -0.00225 0.980 68761  69120 74600   74959 7.76   6.96 -0.00224 -0.00225</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_all</span>, pos <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate.int # ---------------</span></span>
<span><span class="co">#&gt; Summary of results from entered 'pos' replicate(s):</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq  row endrow time endtime  oxy endoxy rate.2pt     rate</span></span>
<span><span class="co">#&gt; 1:   1    1         53.2 -0.00785 0.997  121    480 5960    6319 6.45   3.57 -0.00804 -0.00785</span></span>
<span><span class="co">#&gt; 2:   2    1         51.9 -0.00684 0.975  781   1140 6620    6979 6.82   4.41 -0.00672 -0.00684</span></span>
<span><span class="co">#&gt; 3:   3    1         53.6 -0.00641 0.994 1441   1800 7280    7639 6.99   4.64 -0.00654 -0.00641</span></span>
<span><span class="co">#&gt; 4:   4    1         42.1 -0.00442 0.989 2101   2460 7940    8299 7.16   5.45 -0.00478 -0.00442</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p><code>export = TRUE</code> can be used to export the summary table as
a data frame, or those rows selected using <code>pos</code></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">zeb_all</span>, </span>
<span>                   pos <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, </span>
<span>                   export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_exp</span></span>
<span><span class="co">#&gt;      rep  rank intercept_b0 slope_b1   rsq   row endrow  time endtime   oxy endoxy rate.2pt     rate</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;int&gt;        &lt;num&gt;    &lt;num&gt; &lt;num&gt; &lt;num&gt;  &lt;num&gt; &lt;num&gt;   &lt;num&gt; &lt;num&gt;  &lt;num&gt;    &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     1     1         53.2 -0.00785 0.997   121    480  5960    6319  6.45   3.57 -0.00804 -0.00785</span></span>
<span><span class="co">#&gt; 2:     2     1         51.9 -0.00684 0.975   781   1140  6620    6979  6.82   4.41 -0.00672 -0.00684</span></span>
<span><span class="co">#&gt; 3:     3     1         53.6 -0.00641 0.994  1441   1800  7280    7639  6.99   4.64 -0.00654 -0.00641</span></span>
<span><span class="co">#&gt; 4:     4     1         42.1 -0.00442 0.989  2101   2460  7940    8299  7.16   5.45 -0.00478 -0.00442</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mean">
<code>mean</code><a class="anchor" aria-label="anchor" href="#mean"></a>
</h3>
<p>This averages all replicate rates in the <code>$rate</code> column,
or those selected using <code>pos</code>. The result can be saved as a
value by using <code>export = TRUE</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zeb_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">zeb_all</span>, pos <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # mean.calc_rate.int # ------------------</span></span>
<span><span class="co">#&gt; Mean of rate results from entered 'pos' replicates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean of 4 replicate rates:</span></span>
<span><span class="co">#&gt; [1] -0.00638</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span><span class="va">zeb_mean</span></span>
<span><span class="co">#&gt; [1] -0.00638</span></span></code></pre></div>
<p>This could be passed as a numeric value to later functions such as
<code><a href="../reference/convert_rate.html">convert_rate()</a></code>, although it is usually better to do this
kind of result filtering after conversion.</p>
</div>
</div>
<div class="section level2">
<h2 id="notes-and-tips">Notes and tips<a class="anchor" aria-label="anchor" href="#notes-and-tips"></a>
</h2>
<ul>
<li><p>Internally <code>calc_rate.int</code> uses
<code><a href="../reference/calc_rate.html">calc_rate()</a></code> to extract rates, which explains why each
replicate result in <code>$results</code> is a <code>calc_rate</code>
object. The <code>wait</code> and <code>measure</code> inputs are simply
converted to the <code>from</code> and <code>to</code> inputs of
<code>calc_rate</code>. Essentially <code>from</code> is equivalent to
<code>wait</code>, and <code>to</code> equivalent to
<code>wait + measure</code>. If you want to use the
<code>by = "oxygen"</code> method of <code>calc_rate</code> you will
have to look into looping the function. See <a href="https://januarharianto.github.io/respR/articles/archive/intermittent_old.html">here</a>.</p></li>
<li><p>Note the default behaviour of <code>calc_rate</code> if values
are outside the range present within each replicate is used. For example
if the entered <code>measure</code> phase is longer than the actual
replicate, the last row or time value in the replicate will be used
instead. Similarly, if <code>wait</code> or <code>measure</code> inputs
do not match exactly to a value within the data the closest matching
value is used instead. See <code><a href="../reference/calc_rate.html">calc_rate()</a></code> for full
details.</p></li>
<li><p>The examples above assume flushes occur at the end of each
replicate. If your data is subset or processed so that flushes are at
the start instead this is easy to deal with. Simply use
<code>wait</code> to exclude the flush at the start plus whatever
subsequent wait phase you want to use before the <code>measure</code>
phase. See example <a href="https://januarharianto.github.io/respR/articles/adjust_rate.html#example-2---intermittent-flow-respirometry">here</a>.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
