<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Closed-chamber respirometry • respR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Closed-chamber respirometry">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">---- Complete Workflows ----</li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent_short.html">Intermittent-flow respirometry: Short experiment</a>
    </li>
    <li>
      <a href="../articles/intermittent_long.html">Intermittent-flow respirometry: Long experiment</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/oxycrit.html">Critical oxygen values (PCrit)</a>
    </li>
    <li>
      <a href="../articles/oxy_production.html">Oxygen production respirometry</a>
    </li>
    <li class="dropdown-header">---- Function Guides ----</li>
    <li>
      <a href="../articles/inspecting.html">inspect: Inspecting data</a>
    </li>
    <li>
      <a href="../articles/subset_data.html">subset_data: Subset data by time, row, or oxygen ranges</a>
    </li>
    <li>
      <a href="../articles/calc_rate.html">calc_rate: Manually select and calculate rates</a>
    </li>
    <li>
      <a href="../articles/calc_rate.int.html">calc_rate.int: Manual extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/auto_rate.int.html">auto_rate.int: Automatic extraction of rates in intermittent-flow respirometry</a>
    </li>
    <li>
      <a href="../articles/adjust_rate.html">adjust_rate: Adjusting rates for background</a>
    </li>
    <li>
      <a href="../articles/select_rate.html">select_rate: Exploring and filtering results</a>
    </li>
    <li>
      <a href="../articles/format_time.html">format_time: Convert date-time data to numeric time</a>
    </li>
    <li>
      <a href="../articles/convert_DO.html">convert_DO: Convert between units of dissolved oxygen</a>
    </li>
    <li class="dropdown-header">---- Miscellaneous ----</li>
    <li>
      <a href="../articles/importing.html">Importing files from oxygen probe systems</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point rate calculation</a>
    </li>
    <li>
      <a href="../articles/subsample.html">Thin larger datasets</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">Reporting reproducibile analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    More

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/contact.html">Contact</a>
    </li>
    <li>
      <a href="../articles/release_notes.html">Release Notes</a>
    </li>
    <li>
      <a href="../articles/citations.html">respR Citations</a>
    </li>
    <li>
      <a href="../articles/refs.html">References</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Archived</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/archive/intermittent_old.html">Intermittent-flow respirometry: Alternative approaches</a>
        </li>
        <li>
          <a href="../articles/archive/v2_code_change.html">v2.0: Code changes</a>
        </li>
        <li>
          <a href="../articles/archive/v1_code.html">v1.1: How to install and run older code</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_performance.html">auto_rate: Performance</a>
        </li>
        <li>
          <a href="../articles/archive/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_comp.html">oxy_crit: Comparisons with other packages</a>
        </li>
        <li>
          <a href="../articles/archive/oxy_crit_disc.html">oxy_crit: Discussion of Pcrit estimation methods</a>
        </li>
        <li>
          <a href="../articles/archive/packages_comp.html">respR: Comparisons with other R packages</a>
        </li>
        <li>
          <a href="../articles/archive/usage.html">respR: When to use respR</a>
        </li>
      </ul>
</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Closed-chamber respirometry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/HEAD/vignettes/closed.Rmd" class="external-link"><code>vignettes/closed.Rmd</code></a></small>
      <div class="hidden name"><code>closed.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Here we describe a typical workflow for a closed-chamber respirometry
experiment. Whether or not this is the type of experiment you are
conducting, this is a good starting point to understand the general
<code>respR</code> workflow, functions and how they work together.</p>
<p>The example data used here is <code>urchins.rd</code>, where the
first column of the data frame is time data in <em>minutes</em>, while
the remaining 18 columns are dissolved oxygen data in <em>mg/L</em>.
Columns 18 and 19 (<code>b1</code> and <code>b2</code>) contain
background recordings (i.e. from empty or “blank” control chambers).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">urchins.rd</span><span class="op">)</span></span>
<span><span class="co">#&gt;    time.min     a     b     c     d     e     f     g     h     i     j     k     l     m     n     o     p    b1    b2</span></span>
<span><span class="co">#&gt;       &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      0.0  7.86  7.86  7.64  7.65  7.87  7.74  7.62  7.65  7.96  7.75  7.72  7.71  7.87  7.61  6.96  7.04  7.90  7.70</span></span>
<span><span class="co">#&gt; 2:      0.2  7.87  7.79  7.60  7.71  7.87  7.72  7.61  7.66  7.97  7.72  7.71  7.71  7.89  7.61  6.96  7.01  7.89  7.70</span></span>
<span><span class="co">#&gt; 3:      0.3  7.89  7.70  7.60  7.70  7.90  7.72  7.61  7.63  7.98  7.72  7.69  7.77  7.89  7.65  6.97  7.05  7.90  7.69</span></span>
<span><span class="co">#&gt; 4:      0.5  7.90  7.68  7.60  7.72  7.92  7.74  7.62  7.66  7.97  7.72  7.70  7.77  7.89  7.67  6.96  7.09  7.89  7.69</span></span>
<span><span class="co">#&gt; 5:      0.7  7.87  7.64  7.60  7.67  7.90  7.73  7.59  7.65  7.95  7.71  7.66  7.76  7.86  7.62  6.95  7.00  7.90  7.68</span></span>
<span><span class="co">#&gt; 6:      0.8  7.82  7.69  7.61  7.61  7.88  7.70  7.60  7.65  7.94  7.70  7.63  7.72  7.86  7.61  6.94  6.99  7.90  7.67</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-typical-respr-workflow">A typical respR workflow<a class="anchor" aria-label="anchor" href="#a-typical-respr-workflow"></a>
</h2>
<p>The typical workflow in <code>respR</code> is to process a data frame
containing paired values of numeric time and oxygen through several
functions, saving the output object each time and inputting it into the
next function. Much of this is optional; most <code>respR</code>
functions also accept numeric values, vectors and
<code>data.frame</code> objects, depending on the input or function.
However, the <em><a href="https://en.wikipedia.org/wiki/Object-oriented_programming" class="external-link">object-oriented</a></em>
approach allows for several benefits, such as data integrity checks and
reducing the need for additional inputs, and we would strongly recommend
using it whenever possible.</p>
<p>A typical workflow involves some or all of the following
functions:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<tbody>
<tr class="odd">
<td><code><a href="../reference/inspect.html">inspect()</a></code></td>
<td>Visualise the data and check it for common issues</td>
</tr>
<tr class="even">
<td>
<code><a href="../reference/calc_rate.html">calc_rate()</a></code> or <code><a href="../reference/auto_rate.html">auto_rate()</a></code>
</td>
<td>Extract rates from the entire dataset or regions of it, manually or
automatically</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/adjust_rate.html">adjust_rate()</a></code></td>
<td>Adjust the rate values for background oxygen consumption or
production</td>
</tr>
<tr class="even">
<td><code><a href="../reference/convert_rate.html">convert_rate()</a></code></td>
<td>Convert the adjusted rate(s) to any common units of oxygen
consumption or production</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/select_rate.html">select_rate()</a></code></td>
<td>If there are multiple rates, select according to various criteria
which to report or how to arrive at a final rate</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="importing-and-preparing-data">Importing and preparing data<a class="anchor" aria-label="anchor" href="#importing-and-preparing-data"></a>
</h3>
<p><code>respR</code> has a very simple structural data requirement:
data must be in the form of paired values of numeric time and oxygen
amount in a <code>data.frame</code>. To our knowledge, all oxygen
sensing equipment or probe systems output to formats
(e.g. <code>.csv</code>, <code>.txt</code>) that can be imported into
this structure in <code>R</code> using generic functions such as
<code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>.</p>
<p>See <code><a href="../articles/importing.html">vignette("importing")</a></code> for a guide to importing and
preparing data to this form.</p>
</div>
<div class="section level3">
<h3 id="inspect---visualise-and-check-for-errors">
<code>inspect</code> - visualise and check for errors<a class="anchor" aria-label="anchor" href="#inspect---visualise-and-check-for-errors"></a>
</h3>
<p>Once data is in the form of a <code>data.frame</code> of paired time
and oxygen values, we use <code><a href="../reference/inspect.html">inspect()</a></code> to visualise the data
and to check for common issues:</p>
<ul>
<li><p>Time and oxygen columns are <em>numeric</em></p></li>
<li><p>Time and oxygen data contain <em>infinite</em> (<code>Inf</code>)
values</p></li>
<li><p>Time and oxygen have <em>missing</em>
(<code>NA</code>/<code>NaN</code>) values</p></li>
<li><p>Time data are <em>sequential</em></p></li>
<li><p>Time data contains <em>duplicates</em></p></li>
<li><p>Time data are numerically <em>evenly-spaced</em></p></li>
</ul>
<p>See <code><a href="../articles/inspecting.html">vignette("inspecting")</a></code> for a full description and
examples of what these checks entail, the implications of them failing
or producing warnings, and other inputs in the function.</p>
<div class="section level4">
<h4 id="inspect-entire-dataset">Inspect entire dataset<a class="anchor" aria-label="anchor" href="#inspect-entire-dataset"></a>
</h4>
<p>By default, <code>inspect</code> assumes the first column of the data
frame is <code>time</code>, while the second column is
<code>oxygen</code>. However, we can use the <code>time</code> and
<code>oxygen</code> inputs to select different columns, including
multiple columns. You can use either numbers or the names of the
columns. Here, we inspect all columns without <code>&lt;-</code>
assigning (i.e. saving) the result.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span></span>
<span><span class="co">#&gt; inspect: Multiple 'oxygen' columns selected. Note that subsequent functions in respR will by default use first oxygen column only.</span></span>
<span><span class="co">#&gt; Warning: inspect: Time values are not evenly-spaced (numerically).</span></span>
<span><span class="co">#&gt; inspect: Data issues detected. For more information use print().</span></span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 time.min    a    b    c    d    e    f    g    h    i    j    k    l    m    n    o    p   b1   b2</span></span>
<span><span class="co">#&gt; numeric             pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass</span></span>
<span><span class="co">#&gt; Inf/-Inf            pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass</span></span>
<span><span class="co">#&gt; NA/NaN              pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass pass</span></span>
<span><span class="co">#&gt; sequential          pass    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -</span></span>
<span><span class="co">#&gt; duplicated          pass    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -</span></span>
<span><span class="co">#&gt; evenly-spaced       WARN    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uneven Time data locations (first 20 shown) in column: time.min </span></span>
<span><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] 0.1 0.2</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>This is chiefly exploratory functionality to allow for a quick
overview of a dataset. Here the plot lets us see which are the specimen
columns, which might have data anomalies, and which are controls.</p>
<p>The data checks tell us all the columns pass the various checks,
except one. There is a warning that the time data are not evenly spaced.
This is a common warning, and in this case can be safely ignored. It
results from using decimalised minutes as the time metric, which happen
to be numerically unevenly spaced, but are perfectly usable as the time
metric in <code>respR</code>.</p>
<p>Rather than make assumptions that rows represent evenly spaced
datapoints, the functions in <code>respR</code> use actual time values
for analyses and rate calculations, and so even irregularly spaced data
are analysed correctly. Such warnings are for informative purposes: to
make the user aware of unusual data gaps, and also to remind users that
if they use row numbers for manual operations such as subsetting, the
same row width in different parts of the data may not necessarily
represent the same time period.</p>
</div>
<div class="section level4">
<h4 id="inspect-individual-columns">Inspect individual columns<a class="anchor" aria-label="anchor" href="#inspect-individual-columns"></a>
</h4>
<p>To extract rates, it is best to assign each time-oxygen column pair
individually as a separate <code>inspect</code> object. Using the
<code>time</code> and <code>oxygen</code> inputs we can select
particular columns either by the column number or, as shown here, by
name.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urchin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span>  <span class="st">"time.min"</span>, oxygen <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-4-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.inspect # -----------------------</span></span>
<span><span class="co">#&gt;                 time.min    n</span></span>
<span><span class="co">#&gt; numeric             pass pass</span></span>
<span><span class="co">#&gt; Inf/-Inf            pass pass</span></span>
<span><span class="co">#&gt; NA/NaN              pass pass</span></span>
<span><span class="co">#&gt; sequential          pass    -</span></span>
<span><span class="co">#&gt; duplicated          pass    -</span></span>
<span><span class="co">#&gt; evenly-spaced       WARN    -</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Uneven Time data locations (first 20 shown) in column: time.min </span></span>
<span><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span></span>
<span><span class="co">#&gt; Minimum and Maximum intervals in uneven Time data: </span></span>
<span><span class="co">#&gt; [1] 0.1 0.2</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Note how the data is plotted against both time (bottom blue axis) and
row index (top red axis). From this plot, we can see irregularities in
these data near the end of the timeseries (in this case the specimen had
interfered with the oxygen sensor). A linear regression across the
entire data series would therefore not be a representative estimate of
the true routine respiration rate. However, the bottom plot, a rolling
rate across a moving window of 10% of the data, shows that over the
initial stages of the experiment oxygen uptake rate is consistent at
around -0.02. In this experiment this region would be therefore be
suitable for extracting rates, and we would not want to use any data
after approximately the 29 minutes timepoint.</p>
<p>For now, the data is saved as an object, <code>urchin</code> which
contains the original data columns we selected coerced into a new data
frame, and various other metadata.</p>
<p>Again, note that using <code><a href="../reference/inspect.html">inspect()</a></code> is optional. Functions
in <code>respR</code> will generally accept regular <code>R</code> data
structures (e.g. data frames, tibbles, vectors, etc.).
<code><a href="../reference/inspect.html">inspect()</a></code> is a quality control and exploratory step that
helps highlight potential issues about the data before analysis. We use
this particular example with an obvious anomaly to illustrate the point
that you should <em>always visualise and explore your data before
analysis</em>. <code>respR</code> has been designed to make this
straightforward.</p>
</div>
</div>
<div class="section level3">
<h3 id="calc_rate---calculate-oxygen-uptake-rate">
<code>calc_rate</code> - calculate oxygen uptake rate<a class="anchor" aria-label="anchor" href="#calc_rate---calculate-oxygen-uptake-rate"></a>
</h3>
<div class="section level4">
<h4 id="defaults">Defaults<a class="anchor" aria-label="anchor" href="#defaults"></a>
</h4>
<p>Using the <code>inspect</code> object <code>urchin</code> that we
just created in <code><a href="../reference/calc_rate.html">calc_rate()</a></code> with no additional inputs, will
prompt the function to perform a linear regression on the entire data
series.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin</span><span class="op">)</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate # ---------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -0.0175 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Note how the function recognises the <code><a href="../reference/inspect.html">inspect()</a></code> object,
with no other inputs necessary. Alternatively, you can input a
<code>data.frame</code> object containing raw data, in which case the
function will automatically consider the first column as time data, and
the second column as oxygen data (if they are not in the first two
columns, they should be processed via <code><a href="../reference/inspect.html">inspect()</a></code> or
otherwise put into this structure).</p>
</div>
<div class="section level4">
<h4 id="other-options">Other options<a class="anchor" aria-label="anchor" href="#other-options"></a>
</h4>
<p>In many cases, we want to select the region over which the rate is
determined. For example, we may want to exclude initial stages of
instability at the start of an experiment, determine the rate over an
exact time duration, or within a threshold of oxygen concentrations.
Equipment interference or other factors may cause irregularities in the
data we want to exclude. <code>calc_rate</code> allows us to specify
exact data regions and allow us to work around such issues.</p>
<p>Using the <code>from</code>, <code>to</code>, and <code>by</code>
inputs, a user may use <code><a href="../reference/calc_rate.html">calc_rate()</a></code> to specify data ranges
in several ways:</p>
<ul>
<li>
<strong>Time:</strong>
<ul>
<li><em>“What is the rate over a specific 25 minute period?”</em></li>
<li><code>from = 4, to = 29, by = "time"</code></li>
</ul>
</li>
<li>
<strong>Oxygen:</strong>
<ul>
<li><em>“What is the rate between oxygen concentrations of 7.5 to 7.0
mg/L?”</em></li>
<li><code>from = 7.5, to = 7.0, by = "oxygen"</code></li>
</ul>
</li>
<li>
<strong>Row:</strong>
<ul>
<li><em>“What is the rate between rows 11 and 273.”</em></li>
<li><code>from = 11, to = 273, by = "row"</code></li>
</ul>
</li>
</ul>
<p>These inputs do not need to be overly precise; for
<code>oxygen</code> and <code>time</code> if input values do not match
exactly to a value in the data, the function will identify the closest
matching values and use these for calculations. Similarly, if
<code>from</code> or <code>to</code> values are beyond the maximum or
minimum values in the data, the function will use the maximum or minimum
value instead. For example, the above experiment is 45 minutes long. If
we used <code>to = 60</code> as the upper time range, the function would
simply apply a <code>to</code> value of 45 instead.</p>
</div>
<div class="section level4">
<h4 id="calculate-urchin-rate">Calculate urchin rate<a class="anchor" aria-label="anchor" href="#calculate-urchin-rate"></a>
</h4>
<p>Here, to calculate our rate we’ll select a 25 minute period before
the interference occurred.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin</span>, from <span class="op">=</span> <span class="fl">4</span>, to <span class="op">=</span> <span class="fl">29</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the output provides a series of diagnostic plots of the data
subset that was analysed.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">urch_rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # plot.calc_rate # ----------------------</span></span>
<span><span class="co">#&gt; plot.calc_rate: Plotting rate from position 1 of 1 ...</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;"></p>
<p>The saved object can also be explored using generic <code>S3</code> R
methods.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">urch_rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate # ---------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; Rate: -0.0218 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">urch_rate</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.calc_rate # -------------------</span></span>
<span><span class="co">#&gt; Summary of all rate results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq row endrow time endtime  oxy endoxy rate.2pt    rate</span></span>
<span><span class="co">#&gt; 1:  NA    1         7.64  -0.0218 0.987  25    175    4      29 7.58   6.98   -0.024 -0.0218</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
<p>The rate, which at this stage is unitless, can be seen as the final
column, and other summary data and model coefficients are saved in the
object. In this case the <code>rsq</code> is 0.99, so this appears to be
a very good estimate of this urchin’s routine respiration rate.</p>
<p>Note how the rate value is <em>negative</em>. In <code>respR</code>
oxygen uptake rates are represented by negative values because they
represent a negative slope of oxygen against time. By contrast, oxygen
production rates would be <em>positive</em>. These uptake rates will
typically be reported as positive values when you come to write-up the
results.</p>
</div>
<div class="section level4">
<h4 id="two-point-rate">Two-point rate<a class="anchor" aria-label="anchor" href="#two-point-rate"></a>
</h4>
<p>The output also includes a <code>rate.2pt</code>. This is the rate
determined by simple two-point calculation of difference in oxygen
divided by difference in time. For almost all analyses, the
<code>$rate</code> should be used. See <code><a href="../articles/twopoint.html">vignette("twopoint")</a></code>
for an explanation of this output and when it might be useful.</p>
</div>
</div>
<div class="section level3">
<h3 id="calc_rate-bg---calculate-background-oxygen">
<code>calc_rate.bg</code> - calculate background oxygen<a class="anchor" aria-label="anchor" href="#calc_rate-bg---calculate-background-oxygen"></a>
</h3>
<p>The presence of micro-organisms and their oxygen use may be a
potential source of experimental bias, and we usually want to account
for background respiration rates during experiments by conducting empty
or “blank” control experiments with no specimens to quantify it.</p>
<p>These control experiments are routinely conducted alongside, or
before and after specimen experiments, or at an entirely different time.
Whenever they are conducted, it is always important they are done under
the exact same conditions using the same or equivalent equipment.
Essentially these should be identical to regular experiments, except for
the absence of the specimen you are interested in.</p>
<p>Since the oxygen signal from blank experiments can be noisy and
trends easily influenced by outliers, often the background rates from
several controls are averaged to obtain a more accurate estimate of the
background rate. Once a background rate is determined, specimen rates
are then adjusted by it. See <code><a href="../articles/adjust_rate.html">vignette("adjust_rate")</a></code> for
detailed examples of the many types of adjustments that can be performed
using <code>respR</code>.</p>
<p>The function <code><a href="../reference/calc_rate.bg.html">calc_rate.bg()</a></code> is used to extract
background rates from control recordings. These must share the
<strong>same units of time and oxygen</strong> as the experimental rates
they will be used to adjust. It can also process multiple background
oxygen recordings, so that an average background rate will be applied in
the <code>adjust_rate</code> function, or other adjustments requiring
multiple recordings can be performed. In the <code>urchins.rd</code>
data, background respiration was recorded and saved in columns 18 and
19.</p>
<p>We will determine background rates using <code><a href="../reference/calc_rate.bg.html">calc_rate.bg()</a></code>.
Unlike <code>calc_rate</code>, which can calculate rates from
<em>multiple</em> regions of a <em>single</em> oxygen column, this
function can calculate rates across <em>single</em> region of
<em>multiple</em> columns.</p>
<p>Here, we <code>inspect</code> the two data columns, and because they
have no anomalies use the entire data to calculate a background rate (if
we wanted to only use part of it we could pass it through
<code><a href="../reference/subset_data.html">subset_data()</a></code> first). We save the output as a separate
object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bg_insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">bg_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="va">bg_insp</span><span class="op">)</span></span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-9-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.calc_rate.bg # ------------------</span></span>
<span><span class="co">#&gt; Background rate(s):</span></span>
<span><span class="co">#&gt; [1] -0.000765 -0.000902</span></span>
<span><span class="co">#&gt; Mean background rate:</span></span>
<span><span class="co">#&gt; [1] -0.000833</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>The <code>bg_rate</code> object contains both individual background
rates for each data column (<code>$rate.bg</code>), and an averaged rate
(<code>$rate.bg.mean</code>). We will determine how these are applied as
an adjustment to the specimen rate in <code><a href="../reference/adjust_rate.html">adjust_rate()</a></code>.</p>
</div>
<div class="section level3">
<h3 id="adjust_rate---adjust-for-background-respiration">
<code>adjust_rate</code> - adjust for background respiration<a class="anchor" aria-label="anchor" href="#adjust_rate---adjust-for-background-respiration"></a>
</h3>
<p>See <code><a href="../articles/adjust_rate.html">vignette("adjust_rate")</a></code> for detailed examples of the
types of adjustments that can be performed using
<code>adjust_rate</code>. Here the adjustment is relatively
straightforward. We will adjust the <code>urch_rate</code> using the
<code>bg_rate</code> object we saved in the previous section.</p>
<p>The rate input to be adjusted can be an object of class
<code>calc_rate</code> or <code>auto_rate</code>, or any numeric value
(or multiple values). The <code>by</code> adjustment value can be a
<code>calc_rate.bg</code> object, <code>calc_rate</code> object, or
numeric value or vector. <code>adjust_rate</code> has several methods
determining how the <code>by</code> is applied, but the default one is
<code>"mean"</code>, which is the one we want here, since we want to
apply the average of the two background rates we just calculated.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rate</span>, by <span class="op">=</span> <span class="va">bg_rate</span>, method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate # -------------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using the 'mean' method.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -0.0218</span></span>
<span><span class="co">#&gt; Adjustment    : -0.000833</span></span>
<span><span class="co">#&gt; Adjusted Rate : -0.0209 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>The urchin rate has been adjusted to a slightly lower uptake rate
because, as we found by looking at the controls, some of this uptake was
due to respiration by micro-organisms.</p>
<p>Background adjustments can also be entered manually. Care should be
taken to include the correct <em>sign</em>. In <code>respR</code> oxygen
uptake rates are negative since they represent a negative slope of
oxygen against time. Background rates are usually (though not always)
also negative. In this case, the default <code>"mean"</code> method will
not alter the <code>by</code> value.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rate_adj_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0218</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">0.000833</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.adjust_rate # -------------------</span></span>
<span><span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjustment was applied using the 'mean' method.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span></span>
<span><span class="co">#&gt; Rate          : -0.0218</span></span>
<span><span class="co">#&gt; Adjustment    : -0.000833</span></span>
<span><span class="co">#&gt; Adjusted Rate : -0.021 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>We can see this is essentially the same result as above. The small
mismatch in values is simply due to the lower precision of entered
values compared to internal ones (the number of decimal places printed
in the console depends on your own R options setting).</p>
</div>
<div class="section level3">
<h3 id="convert_rate---convert-the-results">
<code>convert_rate</code> - convert the results<a class="anchor" aria-label="anchor" href="#convert_rate---convert-the-results"></a>
</h3>
<p>Note, that until this point <code>respR</code> has <em>not required
units of time or oxygen to be specified</em>. Now we convert calculated,
unitless rates to specified output units.</p>
<p><code><a href="../reference/convert_rate.html">convert_rate()</a></code> can be used to convert the unitless rate
values we have dealt with up to now to these reportable metrics:</p>
<ul>
<li>
<strong>Absolute metabolic rate</strong>
<ul>
<li>Oxygen consumption or production per unit time. This is the whole
specimen, whole chamber or whole group metabolic rate</li>
</ul>
</li>
<li>
<strong>Mass-specific metabolic rate</strong>
<ul>
<li>Oxygen consumption or production per unit time per unit
<em>mass</em> of the specimen</li>
</ul>
</li>
<li>
<strong>Area-specific metabolic rate</strong>
<ul>
<li>Oxygen consumption or production per unit time per unit
<em>area</em> of the specimen</li>
</ul>
</li>
</ul>
<p>Conversion requires the units of the original raw data
(<code>time.unit</code>, <code>oxy.unit</code>), and the
<code>volume</code> of fluid in the respirometer in Litres
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math>).
Mass-specific rates require the <code>mass</code> of the specimen in
kilograms
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">kg</annotation></semantics></math>),
and area-specific rates require the <code>area</code> of the specimen in
metres squared
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mn>2</mn></msup><annotation encoding="application/x-tex">m^2</annotation></semantics></math>).
Lastly, an <code>output.unit</code> appropriate to the inputs should be
specified. This should be in the correct order: “oxygen/time” or
“oxygen/time/mass” or “oxygen/time/area”.</p>
<p><em>Note</em>: the <code>volume</code> is volume of fluid in the
respirometer or respirometer loop, <strong>not the volume of the
respirometer</strong>. That is, it represents the <em>effective
volume</em>. A specimen occupies space in the respirometer, and so
displaces some proportion of the water volume, which depending on its
size might be significant. Therefore the volume of water entered here
should equal the total volume of the respirometer <em>minus the volume
of the specimen</em>. There are several approaches to determine the
effective volume; calculating the specimen volume geometrically or via
water displacement in a separate vessel, or calculated from the mass and
density (e.g. for fish it is often assumed they have an equal density as
water, that is ~1000 kg/m^3). Water volume could also be determined
directly by pouring out the water at the end of the experiment, or by
weighing the respirometer after the specimen has been removed. See the
<strong><a href="https://github.com/nicholascarey/respfun" class="external-link"><code>respfun</code></a></strong>
respirometry utilities package for several functions to assist with
determining the effective volume.</p>
</div>
<div class="section level3">
<h3 id="convert-adjusted-urchin-rate">Convert adjusted urchin rate<a class="anchor" aria-label="anchor" href="#convert-adjusted-urchin-rate"></a>
</h3>
<p>For an example of absolute oxygen uptake rate, we can convert the
output of <code><a href="../reference/adjust_rate.html">adjust_rate()</a></code> to oxygen consumed by the whole
urchin in <em>mg per hour</em>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rate_adj</span>,         <span class="co"># urchin rate adjusted for background</span></span>
<span>             oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>,     <span class="co"># oxygen units of the original raw data</span></span>
<span>             time.unit <span class="op">=</span> <span class="st">"min"</span>,     <span class="co"># time units of the original raw data</span></span>
<span>             output.unit <span class="op">=</span> <span class="st">"mg/h"</span>,  <span class="co"># output unit</span></span>
<span>             volume <span class="op">=</span> <span class="fl">1.09</span><span class="op">)</span>         <span class="co"># effective volume of the respirometer</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; convert_rate: Object of class 'adjust_rate' detected. Converting all adjusted rates in '$rate.adjusted'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.0209</span></span>
<span><span class="co">#&gt; [1] "mg/L" "min" </span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -1.37</span></span>
<span><span class="co">#&gt; [1] "mgO2/hr"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>We can also convert to a mass-specific rate by adding a specimen
<code>mass</code> and specifying a mass-specific
<code>output.unit</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rate_adj</span>, </span>
<span>             oxy.unit <span class="op">=</span> <span class="st">"mg l-1"</span>, </span>
<span>             time.unit <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>             output.unit <span class="op">=</span> <span class="st">"mg/s/kg"</span>,</span>
<span>             volume <span class="op">=</span> <span class="fl">1.09</span>, </span>
<span>             mass <span class="op">=</span> <span class="fl">0.19</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; convert_rate: Object of class 'adjust_rate' detected. Converting all adjusted rates in '$rate.adjusted'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.0209</span></span>
<span><span class="co">#&gt; [1] "mg/L" "min" </span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -0.002</span></span>
<span><span class="co">#&gt; [1] "mgO2/sec/kg"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Note how we have changed the format of the time and oxygen units. A
“fuzzy” string matching algorithm automatically recognises such
variations, allowing natural, intuitive input. For example,
<code>"ml/l"</code>, <code>"mL/L"</code>, “<code>ml L-1</code>”,
<code>"milliliter/liter"</code>, and <code>"millilitre/litre"</code> are
all recognised as <code>ml/L</code>. Unit delimiters can be any
combination of a space, dot (<code>.</code>), forward-slash
(<code>/</code>), or the “per” unit (<code>-1</code>). Thus,
<code>"ml/kg"</code>, <code>"mL / kg"</code>,
<code>"mL /kilogram"</code>, <code>"ml kg-1"</code> or
<code>"ml.kg-1"</code> are equally recognised as <code>mL/kg</code>. To
see what units are available to use in various functions, see
<code><a href="../reference/unit_args.html">unit_args()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/unit_args.html">unit_args</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: A string-matching algorithm is used to identify units. </span></span>
<span><span class="co">#&gt; Example 1: These are recognised as the same: 'mg/L', 'mg/l', 'mg L-1', 'mg per litre', 'mg.L-1'</span></span>
<span><span class="co">#&gt; Example 2: These are recognised as the same: 'Hour', 'hr', 'h'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Input Units # --------------------------------------</span></span>
<span><span class="co">#&gt; Oxygen concentration units should use SI units (`L` or `kg`) for the denominator.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Oxygen Concentration or Pressure Units - Do not require t, S and P</span></span>
<span><span class="co">#&gt; [1] "mg/L"   "ug/L"   "mol/L"  "mmol/L" "umol/L" "nmol/L" "pmol/L"</span></span>
<span><span class="co">#&gt; Oxygen Concentration or Pressure Units - Require t, S and P</span></span>
<span><span class="co">#&gt;  [1] "uL/L"    "mL/L"    "mm3/L"   "cm3/L"   "cc/L"    "mg/kg"   "ug/kg"   "ppm"     "mol/kg"  "mmol/kg" "umol/kg" "nmol/kg" "pmol/kg" "uL/kg"   "mL/kg"   "%Air"    "%Oxy"    "Torr"    "hPa"     "kPa"     "mmHg"    "inHg"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Volume units for use in flow rates in calc_rate.ft and convert_rate.ft</span></span>
<span><span class="co">#&gt; (e.g. as in 'ml/min', 'L/s', etc.)</span></span>
<span><span class="co">#&gt; [1] "uL" "mL" "L" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Time units (for 'time.unit' or as part of 'flowrate.unit')</span></span>
<span><span class="co">#&gt; [1] "sec"  "min"  "hour" "day" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mass units</span></span>
<span><span class="co">#&gt; [1] "ug" "mg" "g"  "kg"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Area units</span></span>
<span><span class="co">#&gt; [1] "mm2" "cm2" "m2"  "km2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Metabolic Rate Units # -----------------------------</span></span>
<span><span class="co">#&gt; For use in 'convert_rate', 'convert_rate.ft', 'convert_MR'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Must be in correct order:</span></span>
<span><span class="co">#&gt; Absolute rates:        Oxygen/Time       e.g. 'mg/sec',     'umol/min',     'mL/h'</span></span>
<span><span class="co">#&gt; Mass-specific rates:   Oxygen/Time/Mass  e.g. 'mg/sec/ug',  'umol/min/g',   'mL/h/kg'</span></span>
<span><span class="co">#&gt; Area-specific rates:   Oxygen/Time/Area  e.g. 'mg/sec/mm2', 'umol/min/cm2', 'mL/h/m2'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output Oxygen amount units</span></span>
<span><span class="co">#&gt;  [1] "ug"   "mg"   "pmol" "nmol" "umol" "mmol" "mol"  "uL"   "mL"   "mm3"  "cm3" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output Time units</span></span>
<span><span class="co">#&gt; [1] "sec"  "min"  "hour" "day" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output Mass units for mass-specific rates</span></span>
<span><span class="co">#&gt; [1] "ug" "mg" "g"  "kg"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Output Area units for surface area-specific rates</span></span>
<span><span class="co">#&gt; [1] "mm2" "cm2" "m2"  "km2"</span></span></code></pre></div>
<p>Note that some units of oxygen require temperature, salinity and
atmospheric pressure to perform the conversion. One handy tip: you may
want to enter these even if they are not required for conversions
because they are saved in the <code>$summary</code> table, and this can
help in keeping track of results across different experiments.</p>
<p>This time we will save (i.e. assign) the result to an object.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rate_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rate_adj</span>, </span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"mg/L"</span>, </span>
<span>                                time.unit <span class="op">=</span> <span class="st">"mins"</span>, </span>
<span>                                output.unit <span class="op">=</span> <span class="st">"ml/h/kg"</span>,</span>
<span>                                volume <span class="op">=</span> <span class="fl">1.09</span>, </span>
<span>                                mass <span class="op">=</span> <span class="fl">0.19</span>,</span>
<span>                                t <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                S <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                                P <span class="op">=</span> <span class="fl">1.01</span><span class="op">)</span></span>
<span><span class="co">#&gt; convert_rate: Object of class 'adjust_rate' detected. Converting all adjusted rates in '$rate.adjusted'.</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">urch_rate_final</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_rate # ------------------</span></span>
<span><span class="co">#&gt; Rank 1 of 1 rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input:</span></span>
<span><span class="co">#&gt; [1] -0.0209</span></span>
<span><span class="co">#&gt; [1] "mg/L" "min" </span></span>
<span><span class="co">#&gt; Converted:</span></span>
<span><span class="co">#&gt; [1] -5.43</span></span>
<span><span class="co">#&gt; [1] "mLO2/hr/kg"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see full results use summary().</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">urch_rate_final</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # summary.convert_rate # ----------------</span></span>
<span><span class="co">#&gt; Summary of all converted rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    rep rank intercept_b0 slope_b1   rsq density row endrow time endtime  oxy endoxy    rate adjustment rate.adjusted rate.input oxy.unit time.unit volume mass area  S  t    P rate.abs rate.m.spec rate.a.spec output.unit rate.output</span></span>
<span><span class="co">#&gt; 1:  NA    1         7.64  -0.0218 0.987      NA  25    175    4      29 7.58   6.98 -0.0218  -0.000833       -0.0209    -0.0209     mg/L       min   1.09 0.19   NA 30 20 1.01    -1.03       -5.43          NA  mLO2/hr/kg       -5.43</span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="final-rate">Final rate<a class="anchor" aria-label="anchor" href="#final-rate"></a>
</h3>
<p>The final rate can be seen above in these console outputs. It can be
extracted for further use from the saved object where it is
<code>$rate.output</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rate_final</span><span class="op">$</span><span class="va">rate.output</span></span>
<span><span class="co">#&gt; [1] -5.43</span></span></code></pre></div>
<p>Alternatively, use the <code>summary</code> function with
<code>export = TRUE</code> to save the summary table as a separate data
frame which contains all rate regression parameters and data locations,
adjustments (if applied), units, and more. This is a great way of
exporting all the relevant data for your final results.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rate_final_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">urch_rate_final</span>, export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-the-result">Check the result<a class="anchor" aria-label="anchor" href="#check-the-result"></a>
</h3>
<p>A final and important step in respirometry analyses, particularly
after the first rate from a new set of experiments or specimens has been
calculated, is to check the result against rates from the same or
similar species of the same size in as close as possible to the same
conditions. This could be from previous analyses by the same user or
group, or rates from one or more published studies.</p>
<p>Dealing with so many different units and conversions it is very easy
to introduce a small conversion or transcription error that will have a
huge effect on the final calculated rate. These types of error
occasionally make it into published papers. This is why we would also
recommend you check the result against more than one independent
publication.</p>
<p>In the present example, at the time the experiments were done there
were no published respirometry studies on this particular species of sea
urchin. However, a quick Google Scholar search led to other papers from
which rates of other species of sea urchin at around the same size and
temperature could be found. In Moulin et al. (<a href="https://januarharianto.github.io/respR/articles/refs.html#references">2015</a>).
<em>E. mathaei</em> has a respiration rate of around <em>0.2 to 0.5
umol/h/g</em> at 25°C, and in Kurihara et al. (<a href="https://januarharianto.github.io/respR/articles/refs.html#references">2013</a>)
<em>H. pulcherrimus</em> it is around <em>0.6 umol/h/g</em> at 22°C.</p>
<p>New in <a href=""><code>respR v2.3</code></a> is the
<code><a href="../reference/convert_MR.html">convert_MR()</a></code> function which converts between different
units of oxygen uptake. This works on numeric values but also
<code>convert_rate</code> objects, in which case we simply need to
specify a different output unit via <code>to</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/convert_MR.html">convert_MR</a></span><span class="op">(</span><span class="va">urch_rate_final</span>, </span>
<span>           to <span class="op">=</span> <span class="st">"umol/h/g"</span>,</span>
<span>           t <span class="op">=</span> <span class="fl">20</span>,</span>
<span>           S <span class="op">=</span> <span class="fl">30</span>,</span>
<span>           P <span class="op">=</span> <span class="fl">1.01</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # print.convert_MR # --------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Converting rates from 'convert_rate' input...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input: "mLO2/hr/kg"</span></span>
<span><span class="co">#&gt; [1] -5.43</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Converted: "umolO2/hr/g"</span></span>
<span><span class="co">#&gt; [1] -0.225</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -----------------------------------------</span></span></code></pre>
<p>Generally speaking, if there is a order of magnitude difference or
more it is a good indication that there may be a problem. Here, we can
see our rate value of <code>-0.225 umol/hr/g</code> is broadly
consistent with these reported rates from the literature of <em>0.2 to
0.5</em> at 25°C, and <em>0.6</em> at 22°C. The difference is within
what might be expected given natural variation between species and
difference in temperatures. Therefore, we can be fairly confident that
our urchin rate is in the right ballpark and we have not made a
conversion error.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This is an example of a fairly straightforward analysis of a
closed-chamber respirometry experiment. This entire analysis can be
documented and shared in only a few lines of code, making it easily
reproducible if the original data file is included:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import and inspect</span></span>
<span><span class="va">urchin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Background</span></span>
<span><span class="va">bg_insp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span></span>
<span><span class="va">bg_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="va">bg_insp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Specimen rate</span></span>
<span><span class="va">urch_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin</span>, from <span class="op">=</span> <span class="fl">4</span>, to <span class="op">=</span> <span class="fl">29</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adjust rate</span></span>
<span><span class="va">urch_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rate</span>, <span class="va">bg_rate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to final rate units</span></span>
<span><span class="va">urch_rate_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rate_adj</span>,</span>
<span>                                oxy.unit <span class="op">=</span> <span class="st">"mgl-1"</span>, </span>
<span>                                time.unit <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>                                output.unit <span class="op">=</span> <span class="st">"mg/s/kg"</span>, </span>
<span>                                volume <span class="op">=</span> <span class="fl">1.09</span>, </span>
<span>                                mass <span class="op">=</span> <span class="fl">0.19</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract full results for archiving or further analysis</span></span>
<span><span class="va">urch_rate_final_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">urch_rate_final</span>, export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Using pipes, either the new native <code>|&gt;</code> pipes
introduced in <a href="https://www.r-bloggers.com/2021/05/new-features-in-r-4-1-0/" class="external-link">R
v4.1</a> or <code>%&gt;%</code> <a href="https://dplyr.tidyverse.org" class="external-link"><code>dplyr</code></a> pipes, can
condense this even further:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urch_rate</span> <span class="op">&lt;-</span> <span class="va">urchins.rd</span> <span class="op">|&gt;</span>                                   <span class="co"># Using the urchins data,</span></span>
<span>  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span> <span class="op">|&gt;</span>                                          <span class="co"># inspect, then</span></span>
<span>  <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4</span>, to <span class="op">=</span> <span class="fl">29</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">|&gt;</span>               <span class="co"># calculate rate, then</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                                                 <span class="co"># print for quick look,</span></span>
<span>  <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span>  </span>
<span>    <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>,                       <span class="co"># calculate the background,</span></span>
<span>                 oxygen <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>                         <span class="co"># adjust the rate, then</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span>                                                 <span class="co"># print for another check,</span></span>
<span>  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>oxy.unit <span class="op">=</span> <span class="st">"mgl-1"</span>, time.unit <span class="op">=</span> <span class="st">"m"</span>,     </span>
<span>               output.unit <span class="op">=</span> <span class="st">"mg/s/kg"</span>, volume <span class="op">=</span> <span class="fl">1.09</span>, </span>
<span>               mass <span class="op">=</span> <span class="fl">0.19</span><span class="op">)</span> <span class="op">|&gt;</span>                               <span class="co"># then convert,</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span>export <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>                                     <span class="co"># and finally save</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicholas Carey, Januar Harianto.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
